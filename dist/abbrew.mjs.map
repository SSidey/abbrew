{"version":3,"file":"abbrew.mjs","sources":["../module/helpers/operators.mjs","../module/helpers/utils.mjs","../module/helpers/skill.mjs","../module/helpers/combat.mjs","../module/helpers/effects.mjs","../node_modules/@yaireo/tagify/dist/tagify.min.js","../module/sheets/actor-sheet.mjs","../module/sheets/item-sheet.mjs","../module/helpers/templates.mjs","../module/helpers/config.mjs","../module/data/actor-base.mjs","../module/data/character.mjs","../module/data/npc.mjs","../module/data/item-base.mjs","../module/data/item.mjs","../module/data/item-physical.mjs","../module/data/feature.mjs","../module/data/spell.mjs","../module/data/skill.mjs","../module/data/revealedItem.mjs","../module/data/armour.mjs","../module/data/anatomy.mjs","../module/data/attack-base.mjs","../module/data/weapon.mjs","../module/data/wound.mjs","../module/data/skill/skill-deck.mjs","../module/data/skill/utilities/attribute-increase-skill.mjs","../module/data/skill/background.mjs","../module/data/creature-form.mjs","../module/helpers/trainedSkills.mjs","../module/static/finishers.mjs","../module/documents/actor.mjs","../module/documents/item.mjs","../module/settings.mjs","../module/sheets/items/item-creature-form-sheet.mjs","../module/sheets/items/item-skill-deck-sheet.mjs","../module/sheets/items/item-anatomy-sheet.mjs","../module/sheets/items/item-skill-sheet.mjs","../module/abbrew.mjs"],"sourcesContent":["export function applyOperator(base, value, operator) {\r\n    switch (operator) {\r\n        case 'add':\r\n            return base += value;\r\n        case 'equal':\r\n            return value;\r\n        case 'minus':\r\n            return base -= value;\r\n        default:\r\n            return base;\r\n    }\r\n}","/* -------------------------------------------- */\r\n/*  IDs                                         */\r\n/* -------------------------------------------- */\r\n\r\n/**\r\n * Create an ID from the input truncating or padding the value to make it reach 16 characters.\r\n * @param {string} id\r\n * @returns {string}\r\n */\r\nexport function staticID(id) {\r\n    if (id.length >= 16) return id.substring(0, 16);\r\n    return id.padEnd(16, \"0\");\r\n}\r\n\r\n/* -------------------------------------------- */\r\n\r\nexport function doesNestedFieldExist(obj, props) {\r\n    var splited = props.split('.');\r\n    var temp = obj;\r\n    for (var index in splited) {\r\n        if (typeof temp[splited[index]] === 'undefined') return false;\r\n        temp = temp[splited[index]]\r\n    }\r\n    return true\r\n}\r\n\r\n/* -------------------------------------------- */\r\n\r\nexport function arrayDifference(a, b) {\r\n    return [...b.reduce((acc, v) => acc.set(v, (acc.get(v) || 0) - 1),\r\n        a.reduce((acc, v) => acc.set(v, (acc.get(v) || 0) + 1), new Map())\r\n    )].reduce((acc, [v, count]) => acc.concat(Array(Math.abs(count)).fill(v)), []);\r\n}\r\n\r\n/* -------------------------------------------- */\r\n\r\nexport function getObjectValueByStringPath(entity, path) {\r\n    return path.split('.').reduce(function (o, k) {\r\n        return o && o[k];\r\n    }, entity);\r\n}\r\n\r\n/* -------------------------------------------- */\r\n\r\nexport function getNumericParts(value) {\r\n    return parseInt(value.replace(/\\D/g, \"\")) ?? 0\r\n}\r\n\r\n/* -------------------------------------------- */\r\n\r\nexport function getSafeJson(json, defaultValue) {\r\n    if (!json || json === \"\") {\r\n        return defaultValue;\r\n    }\r\n\r\n    return JSON.parse(json);\r\n}\r\n\r\n/* -------------------------------------------- */\r\n\r\nexport function intersection(a, b) {\r\n    const setA = new Set(a);\r\n    const foo = b.filter(value => setA.has(value));\r\n    return foo;\r\n}\r\n\r\n/* -------------------------------------------- */\r\n\r\nexport async function renderSheetForTaggedData(event, actor) {\r\n    const inspectionClass = \"tagify__tag\";\r\n    const element = _checkThroughParentsForClass(event.target, inspectionClass, 2);\r\n    const itemId = element.__tagifyTagData.id;\r\n    const sourceId = element.__tagifyTagData.sourceId;\r\n    if (itemId) {\r\n        const item = actor.items.find(i => i._id === itemId);\r\n        if (item) {\r\n            item.sheet.render(true);\r\n        }\r\n    } else if (sourceId) {\r\n        const source = fromUuidSync(sourceId);\r\n        const compendiumPackName = source.pack;\r\n        const id = source._id;\r\n        if (!compendiumPackName && source && id) {\r\n            source.sheet.render(true);\r\n        } else {\r\n            const pack = game.packs.get(compendiumPackName);\r\n            await pack.getIndex();\r\n            await pack.getDocument(id).then(item => item.sheet.render(true));\r\n        }\r\n    }\r\n}\r\n\r\nexport async function renderSheetForStoredItem(event, actor) {\r\n    const inspectionClass = \"skill-deck-skill\";\r\n    const element = _checkThroughParentsForClass(event.target, inspectionClass, 3);\r\n    const itemId = element.dataset.itemId;\r\n    const sourceId = element.dataset.sourceId\r\n    if (itemId && !sourceId) {\r\n        const item = actor.items.find(i => i._id === itemId);\r\n        if (item) {\r\n            item.sheet.render(true);\r\n        }\r\n    } else if (sourceId) {\r\n        const source = fromUuidSync(sourceId);\r\n        const compendiumPackName = source.pack;\r\n        const id = source._id;\r\n        if (!compendiumPackName && source && id) {\r\n            source.sheet.render(true);\r\n        } else {\r\n            const pack = game.packs.get(compendiumPackName);\r\n            await pack.getIndex();\r\n            await pack.getDocument(id).then(item => item.sheet.render(true));\r\n        }\r\n    }\r\n}\r\n\r\nfunction _checkThroughParentsForClass(element, inspectionClass, depth) {\r\n    let returnElement = _elementClassListContainsClass(element, inspectionClass);\r\n    if (!returnElement && depth > 0) {\r\n        returnElement = _checkThroughParentsForClass(element.parentElement, inspectionClass, depth - 1);\r\n    }\r\n\r\n    if (returnElement) {\r\n        return returnElement;\r\n    }\r\n\r\n    return null;\r\n}\r\n\r\nfunction _elementClassListContainsClass(element, inspectionClass) {\r\n    return Object.values(element.classList).includes(inspectionClass) ? element : null;\r\n}","import { applyOperator } from \"./operators.mjs\";\r\nimport { getObjectValueByStringPath, getSafeJson, intersection } from \"../helpers/utils.mjs\"\r\nimport { mergeWoundsWithOperator } from \"./combat.mjs\";\r\n\r\nexport async function handleSkillActivate(actor, skill) {\r\n    if (!skill.system.isActivatable) {\r\n        ui.notifications.info(`${skill.name} can not be activated`);\r\n        return false;\r\n    }\r\n\r\n    if (isSkillBlocked(actor, skill)) {\r\n        ui.notifications.info(`You are blocked from using ${skill.name}`);\r\n        return false;\r\n    }\r\n\r\n    if (skill.system.action.charges.hasCharges && skill.system.action.charges.value > 0) {\r\n        await applySkillEffects(actor, skill);\r\n        return true;\r\n    }\r\n\r\n    if (skill.system.action.uses.hasUses && !skill.system.action.uses.value > 0) {\r\n        ui.info(`You don't have any more uses of ${skill.name}.`);\r\n        return false;\r\n    }\r\n\r\n    if (!await actor.canActorUseActions(getModifiedSkillActionCost(actor, skill))) {\r\n        return false;\r\n    }\r\n\r\n    if (skill.system.action.activationType === \"stackRemoval\") {\r\n        removeStackFromSkill(skill);\r\n        return true;\r\n    }\r\n\r\n    await rechargeSkill(actor, skill);\r\n    return await activateSkill(actor, skill);\r\n}\r\n\r\nexport async function removeStackFromSkill(skill) {\r\n    const stacks = skill.system.action.uses.value - 1;\r\n    if (stacks > 0) {\r\n        await skill.update({ \"system.action.uses.value\": stacks })\r\n        return;\r\n    }\r\n\r\n    await skill.delete();\r\n}\r\n\r\nasync function activateSkill(actor, skill) {\r\n    if (skill.system.action.activationType === \"synergy\") {\r\n        await trackSkillDuration(actor, skill);\r\n        await addSkillToQueuedSkills(actor, skill);\r\n        return true;\r\n    }\r\n\r\n    if (await trackSkillDuration(actor, skill)) {\r\n        await addSkillToActiveSkills(actor, skill);\r\n    }\r\n    await applySkillEffects(actor, skill);\r\n    return true;\r\n}\r\n\r\nexport function getModifiedSkillActionCost(actor, skill) {\r\n    const minActions = parseInt(skill.system.action.actionCost) === 0 ? 0 : 1;\r\n    return Math.max(minActions, getModifierSkills(actor, skill).filter(s => s.system.action.modifiers.actionCost.operator).map(s => s.system.action.modifiers.actionCost).reduce((result, actionCost) => { result = applyOperator(result, actionCost.value, actionCost.operator); return result; }, skill.system.action.actionCost));\r\n}\r\n\r\nfunction getModifierSkills(actor, skill) {\r\n    // Get all queued synergy skills\r\n    const queuedSkills = actor.items.toObject().filter(i => actor.system.queuedSkills.includes(i._id));\r\n    // Get all synergies that apply to the main skill\r\n    const queuedSynergies = queuedSkills.filter(s => s.system.skillModifiers.synergy).map(s => ({ skill: s, synergy: getSafeJson(s.system.skillModifiers.synergy, []).map(s => s.id) })).filter(s => s.synergy.includes(skill._id)).map(s => s.skill)\r\n    // Get all passives\r\n    const passiveSkills = actor.items.toObject().filter(i => i.system.isActivatable === false);\r\n    // Get passives that have synergy with the main skill\r\n    const passiveSynergies = passiveSkills.filter(s => s.system.skillModifiers.synergy).map(s => ({ skill: s, synergy: getSafeJson(s.system.skillModifiers.synergy, []).map(s => s.id) })).filter(s => s.synergy.includes(skill._id)).map(s => s.skill)\r\n    // Combine all relevant skills, filtering for those that are out of charges    \r\n    return [...passiveSynergies, ...queuedSynergies];\r\n}\r\n\r\nexport async function applySkillEffects(actor, skill) {\r\n    if (isSkillBlocked(actor, skill)) {\r\n        ui.notifications.info(`You are blocked from using ${skill.name}`);\r\n        return;\r\n    }\r\n\r\n    let updates = {};\r\n\r\n    const modifierSkills = getModifierSkills(actor, skill);\r\n    const allSkills = [...modifierSkills, skill].filter(s => !s.system.action.charges.hasCharges || (s.system.action.charges.value > 0));\r\n    const allSummaries = allSkills.map(s => ({ name: s.name, description: s.system.description }));\r\n    // Explicitly get any skills with charges for later use\r\n    const usesSkills = allSkills.filter(s => s.system.action.uses.hasUses).filter(s => s._id !== skill._id);\r\n    const chargedSkills = allSkills.filter(s => s.system.action.charges.hasCharges);\r\n\r\n    mergeGuardSelfModifiers(updates, allSkills, actor);\r\n    mergeWoundSelfModifiers(updates, allSkills, actor);\r\n\r\n\r\n    await actor.update(updates);\r\n    for (const index in usesSkills) {\r\n        const skill = usesSkills[index];\r\n        let currentCharges = skill.system.action.charges.value;\r\n        if (currentCharges > 0) {\r\n            continue;\r\n        }\r\n        let currentUses = skill.system.action.uses.value\r\n        const item = actor.items.find(i => i._id === skill._id);\r\n        await item.update({ \"system.action.uses.value\": currentUses -= 1 });\r\n    }\r\n    for (const index in chargedSkills) {\r\n        const skill = chargedSkills[index];\r\n        let currentCharges = skill.system.action.charges.value;\r\n        const item = actor.items.find(i => i._id === skill._id);\r\n        await item.update({ \"system.action.charges.value\": currentCharges -= 1 });\r\n    }\r\n    for (const index in modifierSkills) {\r\n        const skill = modifierSkills[index];\r\n        if (skill.system.action.duration.precision === \"0\") {\r\n            const effect = actor.effects.find(e => e.flags.abbrew.skill.trackDuration === skill._id);\r\n            await effect.delete();\r\n        }\r\n    }\r\n\r\n    let templateData = { allSummaries: allSummaries };\r\n    let data = {};\r\n    if (skill.system.action.attackProfile) {\r\n        const baseAttackProfile = skill.system.action.attackProfile;\r\n        const fortune = mergeFortune(allSkills);\r\n        const attackProfile = mergeAttackProfiles(baseAttackProfile, modifierSkills);\r\n        const rollFormula = getRollFormula(actor.system.meta.tier.value, attackProfile, fortune);\r\n        const roll = new Roll(rollFormula, skill.system.actor);\r\n        const result = await roll.evaluate();\r\n        const token = actor.token;\r\n        const attackMode = attackProfile.attackMode;\r\n        const attributeMultiplier = getAttributeModifier(attackMode, attackProfile);\r\n        const damage = attackProfile.damage.map(d => {\r\n            let attributeModifier = 0;\r\n            if (d.attributeModifier) {\r\n                attributeModifier = Math.floor(attributeMultiplier * actor.system.attributes[d.attributeModifier].value);\r\n            }\r\n\r\n            const finalDamage = attributeModifier + d.value;\r\n\r\n            return { damageType: d.type, value: finalDamage };\r\n        });\r\n\r\n        const resultDice = result.dice[0].results.map(die => {\r\n            let baseClasses = \"roll die d10\";\r\n            if (die.success) {\r\n                baseClasses = baseClasses.concat(' ', 'success')\r\n            }\r\n\r\n            if (die.exploded) {\r\n                baseClasses = baseClasses.concat(' ', 'exploded');\r\n            }\r\n\r\n            return { result: die.result, classes: baseClasses };\r\n        });\r\n\r\n        const totalSuccesses = result.dice[0].results.reduce((total, r) => {\r\n            if (r.success) {\r\n                total += 1;\r\n            }\r\n            return total;\r\n        }, 0) + attackProfile.lethal;\r\n\r\n\r\n        const showAttack = ['attack', 'feint', 'finisher'].includes(attackMode);\r\n        const isFeint = attackMode === 'feint';\r\n        // TODO: Remove\r\n        const showParry = true;\r\n        const isStrongAttack = attackMode === 'overpower';\r\n        const showFinisher = attackMode === 'finisher' || totalSuccesses > 0;\r\n        const isFinisher = attackMode === 'finisher';\r\n        // TODO: Get all of the descriptions together into an array\r\n        // TODO: Update the chat card to display the descriptions\r\n        templateData = {\r\n            ...templateData,\r\n            attackProfile,\r\n            totalSuccesses,\r\n            resultDice,\r\n            damage,\r\n            actor: actor,\r\n            tokenId: token?.uuid || null,\r\n            showAttack,\r\n            showFinisher,\r\n            isStrongAttack,\r\n            isFinisher,\r\n            showParry,\r\n            actionCost: skill.system.action.actionCost\r\n        };\r\n        data = { ...data, totalSuccesses, damage, isFeint, isStrongAttack, attackProfile, attackingActor: actor, actionCost: skill.system.action.actionCost, attackerSkillTraining: actor.system.skillTraining };\r\n    }\r\n\r\n    // TODO: Move this out of item and into a weapon.mjs / skill-card.mjs\r\n    const html = await renderTemplate(\"systems/abbrew/templates/chat/skill-card.hbs\", templateData);\r\n\r\n    // Initialize chat data.\r\n    const speaker = ChatMessage.getSpeaker({ actor: actor });\r\n    const rollMode = game.settings.get('core', 'rollMode');\r\n    const label = `[${skill.system.skillType}] ${skill.name}`;\r\n    ChatMessage.create({\r\n        speaker: speaker,\r\n        rollMode: rollMode,\r\n        flavor: label,\r\n        content: html,\r\n        flags: { data: data }\r\n    });\r\n    return {};\r\n}\r\n\r\nfunction mergeGuardSelfModifiers(updates, allSkills, actor) {\r\n    const guardModifiers = allSkills.filter(s => s.system.action.modifiers.guard.self.operator).map(s => ({ value: getSkillValueForPath(s.system.action.modifiers.guard.self.value, actor), operator: s.system.action.modifiers.guard.self.operator }));\r\n    if (guardModifiers) {\r\n        const currentGuard = actor.system.defense.guard.value;\r\n        updates[\"system.defense.guard.value\"] = mergeModifiers(guardModifiers, currentGuard);\r\n    }\r\n}\r\n\r\nfunction mergeWoundSelfModifiers(updates, allSkills, actor) {\r\n    const woundModifiers = allSkills.filter(s => s.system.action.modifiers.wounds.self.length > 0).flatMap(s => s.system.action.modifiers.wounds.self.filter(w => w.type && w.value != null && w.operator).map(w => ({ ...w, index: getOrderForOperator(w.operator) }))).sort(compareModifierIndices);\r\n    if (woundModifiers.length > 0) {\r\n        let updateWounds = actor.system.wounds;\r\n        updateWounds = woundModifiers.reduce((result, w) => result = mergeWoundsWithOperator(result, [{ type: w.type, value: w.value }], w.operator), updateWounds)\r\n        updates[\"system.wounds\"] = updateWounds;\r\n    }\r\n}\r\n\r\nfunction mergeFortune(allSkills) {\r\n    return allSkills.reduce((result, s) => result += s.system.action.modifiers.fortune, 0);\r\n}\r\n\r\nfunction mergeAttackProfiles(attackProfile, allSkills) {\r\n    return allSkills.reduce((result, s) => mergeAttackProfile(result, s.system.action.modifiers.attackProfile), attackProfile)\r\n}\r\n\r\nfunction mergeAttackProfile(base, attackProfile) {\r\n    let baseAttackProfile = base;\r\n    if (attackProfile.attackType) {\r\n        baseAttackProfile.attackProfile = attackProfile.attackType;\r\n    }\r\n    if (attackProfile.attackMode) {\r\n        baseAttackProfile.attackMode = attackProfile.attackMode;\r\n    }\r\n    if (attackProfile.handsSupplied) {\r\n        baseAttackProfile.handsSupplied = attackProfile.handsSupplied;\r\n    }\r\n\r\n    if (attackProfile.finisherLimit.value != null && attackProfile.finisherLimit.operator) {\r\n        baseAttackProfile.finisherLimit.value = applyOperator(baseAttackProfile.finisherLimit.value, attackProfile.finisherLimit.value, attackProfile.finisherLimit.operator)\r\n    }\r\n    if (attackProfile.critical.value != null && attackProfile.critical.operator) {\r\n        baseAttackProfile.critical.value = applyOperator(baseAttackProfile.critical.value, attackProfile.critical.value, attackProfile.critical.operator)\r\n    }\r\n    if (attackProfile.lethal.value != null && attackProfile.lethal.operator) {\r\n        baseAttackProfile.lethal.value = applyOperator(baseAttackProfile.lethal.value, attackProfile.lethal.value, attackProfile.lethal.operator)\r\n    }\r\n\r\n    const baseDamageList = base.damage;\r\n    const modifyDamageList = attackProfile.damage.some(d => d.modify === \"all\") ? new Array(baseDamageList.damage.length).fill(attackProfile.damage.find(d => d.modify === \"all\")[0]) : attackProfile.damage.filter(d => d.modify);\r\n    const last = Math.max(baseDamageList.length, modifyDamageList.length);\r\n    const updatedDamage = [];\r\n    for (let index = 0; index < last; index++) {\r\n        const baseElement = baseDamageList[index] ?? null;\r\n        const modifyElement = modifyDamageList[index] ?? null;\r\n\r\n        if (baseElement && (!modifyElement || (modifyElement && modifyElement.modify === \"skip\"))) {\r\n            updatedDamage.push(baseElement);\r\n        } else if (baseElement && modifyElement && (modifyElement.modify === \"one\" || modifyElement.modify === \"all\")) {\r\n            updatedDamage.push(applyModifierToDamageProfile(baseElement, modifyElement));\r\n        } else if (modifyElement && modifyElement.modify === \"add\") {\r\n            updatedDamage.push(baseElement);\r\n            const newDamage = damageProfileFromModifier(modifyElement);\r\n            if (newDamage) {\r\n                updatedDamage.push(newDamage);\r\n            }\r\n        }\r\n    }\r\n\r\n    baseAttackProfile.damage = updatedDamage;\r\n\r\n    return baseAttackProfile;\r\n}\r\n\r\nfunction applyModifierToDamageProfile(baseElement, modifyElement) {\r\n    const type = modifyElement.type ?? baseElement.type;\r\n    const damage = modifyElement.value ?? baseElement.value;\r\n    const attribute = modifyElement.attributeModifier.length ? modifyElement.attributeModifier.length : baseElement.attributeModifier;\r\n    return ({\r\n        type: type,\r\n        value: damage,\r\n        attributeModifier: attribute,\r\n        attributeMultiplier: modifyElement.attributeMultiplier,\r\n        damageMultiplier: modifyElement.damageMultiplier,\r\n        overallMultiplier: modifyElement.overallMultiplier\r\n    });\r\n}\r\n\r\nfunction damageProfileFromModifier(modifyElement) {\r\n    if (!modifyElement.type) {\r\n        return null;\r\n    }\r\n\r\n    return ({\r\n        type: modifyElement.type,\r\n        value: modifyElement.value ?? 0,\r\n        attributeModifier: modifyElement.attributeModifier,\r\n        attributeMultiplier: modifyElement.attributeMultiplier ?? 1,\r\n        damageMultiplier: modifyElement.damageMultiplier ?? 1,\r\n        overallMultiplier: modifyElement.overallMultiplier ?? 1\r\n    });\r\n}\r\n\r\nfunction getAttributeModifier(attackMode, attackProfile) {\r\n    switch (attackMode) {\r\n        case \"overpower\":\r\n            return Math.max(1, attackProfile.handsSupplied);\r\n        case \"attack\":\r\n        case \"feint\":\r\n            return 0.5 + (Math.max(1, attackProfile.handsSupplied) / 2);\r\n        default:\r\n            return 1;\r\n    }\r\n}\r\n\r\nfunction getRollFormula(tier, attackProfile, fortune) {\r\n    // 1d10x10cs10\r\n    const diceCount = tier + fortune;\r\n    const explodesOn = attackProfile.critical;\r\n    const successOn = attackProfile.critical;\r\n    return `${diceCount}d10x${explodesOn}cs${successOn}`;\r\n}\r\n\r\nfunction mergeModifiers(modifiers, value) {\r\n    const sortedModifiers = modifiers.map(m => ({ ...m, order: getOrderForOperator(m.operator) })).sort(compareModifierIndices);\r\n    return sortedModifiers.reduce((result, modifier) => applyOperator(result, modifier.value, modifier.operator), value)\r\n}\r\n\r\nfunction getOrderForOperator(operator) {\r\n    switch (operator) {\r\n        case \"equal\":\r\n            return 0;\r\n        case \"add\":\r\n            return 1;\r\n        case \"minus\":\r\n            return 2;\r\n        default:\r\n            return -1;\r\n    }\r\n}\r\n\r\nfunction compareModifierIndices(modifier1, modifier2) {\r\n    if (modifier1.order < modifier2.order) {\r\n        return -1;\r\n    } else if (modifier1.order > modifier2.order) {\r\n        return 1;\r\n    }\r\n\r\n    return 0;\r\n}\r\n\r\nfunction getSkillValueForPath(rawValue, actor) {\r\n    return isNumeric(rawValue) ? parseInt(rawValue) : parsePath(rawValue, actor);\r\n}\r\n\r\nexport async function trackSkillDuration(actor, skill) {\r\n    const duration = getSkillDuration(skill);\r\n    if (duration && !(skill.system.action.activationType === \"standalone\" && skill.system.action.duration.precision === \"0\")) {\r\n        await createDurationActiveEffect(actor, skill, duration);\r\n        return true;\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\nasync function addSkillToActiveSkills(actor, skill) {\r\n    const skills = actor.system.activeSkills;\r\n    const updateSkills = [...skills, skill._id];\r\n    await actor.update({ \"system.activeSkills\": updateSkills });\r\n}\r\n\r\nasync function addSkillToQueuedSkills(actor, skill) {\r\n    const skills = actor.system.queuedSkills;\r\n    const updateSkills = [...skills, skill._id];\r\n    await actor.update({ \"system.queuedSkills\": updateSkills });\r\n}\r\n\r\nfunction getSkillDuration(skill) {\r\n    const precision = skill.system.action.duration.precision;\r\n    const duration = {};\r\n    if (precision === \"-1\") {\r\n        return duration;\r\n    }\r\n\r\n    // TODO: remove on next standalone.\r\n    // Return 1 Turn Duration for Instants, remove on next standalone.\r\n    if (precision === \"0\") {\r\n        duration[\"turns\"] = 1;\r\n        duration[\"startRound\"] = game.combat?.round ?? 0;\r\n        duration[\"startTurn\"] = game.combat?.turn ?? 0;\r\n        duration[\"type\"] = \"turns\";\r\n        duration[\"duration\"] = 0.01;\r\n        return duration;\r\n    }\r\n\r\n    const value = Math.max(1, skill.system.action.duration.value);\r\n    duration[\"startTime\"] = game.time.worldTime;\r\n\r\n    if (precision === \"6\") {\r\n        duration[\"rounds\"] = value;\r\n        duration[\"startRound\"] = game.combat?.round ?? 0;\r\n        duration[\"startTurn\"] = game.combat?.turn ?? 0;\r\n        duration[\"type\"] = \"rounds\";\r\n        duration[\"duration\"] = value;\r\n        return duration;\r\n    }\r\n\r\n    if (precision === \"0.01\") {\r\n        duration[\"turns\"] = value;\r\n        duration[\"startRound\"] = game.combat?.round ?? 0;\r\n        duration[\"startTurn\"] = game.combat?.turn ?? 0;\r\n        duration[\"type\"] = \"turns\";\r\n        duration[\"duration\"] = (value / 100).toFixed(2);\r\n        return duration;\r\n    }\r\n\r\n    const seconds = precision * value;\r\n    duration[\"duration\"] = seconds;\r\n    duration[\"seconds\"] = seconds;\r\n    duration[\"type\"] = \"seconds\"\r\n    return duration;\r\n}\r\n\r\nasync function createDurationActiveEffect(actor, skill, duration) {\r\n    const conditionEffectData = {\r\n        _id: actor._id,\r\n        name: game.i18n.localize(skill.name),\r\n        img: skill.img,\r\n        changes: [],\r\n        disabled: false,\r\n        duration: duration,\r\n        description: game.i18n.localize(skill.description),\r\n        origin: `Actor.${actor._id}`,\r\n        tint: '',\r\n        transfer: false,\r\n        statuses: [],\r\n        flags: { abbrew: { skill: { type: skill.system.action.activationType, trackDuration: skill._id } } }\r\n    };\r\n\r\n    await actor.createEmbeddedDocuments('ActiveEffect', [conditionEffectData]);\r\n}\r\n\r\nexport async function rechargeSkill(actor, skill) {\r\n    const item = actor.items.find(i => i._id === skill._id);\r\n    if (!item) {\r\n        return;\r\n    }\r\n\r\n    let updates = {};\r\n    if (skill.system.action.charges.hasCharges) {\r\n        const maxCharges = skill.system.action.charges.max;\r\n        updates[\"system.action.charges.value\"] = maxCharges;\r\n    }\r\n    if (skill.system.action.uses.hasUses) {\r\n        let currentUses = skill.system.action.uses.value\r\n        updates[\"system.action.uses.value\"] = currentUses -= 1;\r\n    }\r\n\r\n    await item.update(updates);\r\n}\r\n\r\nfunction isNumeric(str) {\r\n    if (typeof str != \"string\") return false // we only process strings!  \r\n    return !isNaN(str) && // use type coercion to parse the _entirety_ of the string (`parseFloat` alone does not do this)...\r\n        !isNaN(parseFloat(str)) // ...and ensure strings of whitespace fail\r\n}\r\n\r\nfunction parsePath(rawValue, actor) {\r\n    const entityType = rawValue.split('.').slice(0, 1).shift();\r\n    const entity = (function () {\r\n        switch (entityType) {\r\n            case 'actor':\r\n                return actor;\r\n            case 'item':\r\n                const id = rawValue.split('.').slice(1, 2).shift();\r\n                return id ? actor.items.filter(i => i._id === id).shift() : actor;\r\n        }\r\n    })();\r\n    const path = (function () {\r\n        switch (entityType) {\r\n            case 'actor':\r\n                return rawValue.split('.').slice(1).join('.');\r\n            case 'item':\r\n                return rawValue.split('.').slice(2).join('.');\r\n        }\r\n    })();\r\n    if (getObjectValueByStringPath(entity, path) != null) {\r\n        return getObjectValueByStringPath(entity, path);\r\n    }\r\n}\r\n\r\nexport function isSkillBlocked(actor, skill) {\r\n    // TODO: May Require Refinement for durations.\r\n    const skillDiscord = actor.items.filter(i => i.type === \"skill\").filter(s => s.system.skillModifiers.discord).flatMap(s => getSafeJson(s.system.skillModifiers.discord, []).map(s => s.id));\r\n    const skillId = skill._id;\r\n    return skillDiscord.includes(skillId);\r\n}\r\n\r\nexport function getAttackSkillWithActions(id, name, actionCost, image, attackProfile, attackMode, handsSupplied) {\r\n    return ({\r\n        _id: id,\r\n        name: name,\r\n        system: {\r\n            isActivatable: true,\r\n            skillTraits: [],\r\n            skillType: \"basic\",\r\n            attributeIncrease: \"\",\r\n            attributeIncreaseLong: \"\",\r\n            attributeRankIncrease: \"\",\r\n            action: {\r\n                activationType: \"standalone\",\r\n                actionCost: actionCost,\r\n                actionImage: image,\r\n                duration: {\r\n                    precision: \"0\",\r\n                    value: 0\r\n                },\r\n                uses: {\r\n                    hasUses: false,\r\n                    value: 0,\r\n                    max: 0,\r\n                    period: \"\"\r\n                },\r\n                charges: {\r\n                    hasCharges: false,\r\n                    value: 0,\r\n                    max: 0\r\n                },\r\n                isActive: false,\r\n                attackProfile: { ...attackProfile, attackMode: attackMode, handsSupplied: handsSupplied, critical: 11 - handsSupplied },\r\n                modifiers: {\r\n                    fortune: 0,\r\n                    attackProfile: {},\r\n                    damage: {\r\n                        self: []\r\n                    },\r\n                    guard: {\r\n                        self: {\r\n                            value: 0,\r\n                            operator: \"\"\r\n                        },\r\n                        target: {\r\n                            value: 0,\r\n                            operator: \"\"\r\n                        }\r\n                    },\r\n                    risk: {\r\n                        self: {\r\n                            value: 0,\r\n                            operator: \"\"\r\n                        },\r\n                        target: {\r\n                            value: 0,\r\n                            operator: \"\"\r\n                        }\r\n                    },\r\n                    wounds: {\r\n                        self: [],\r\n                        target: []\r\n                    },\r\n                    resolve: {\r\n                        self: {\r\n                            value: 0,\r\n                            operator: \"\"\r\n                        },\r\n                        target: {\r\n                            value: 0,\r\n                            operator: \"\"\r\n                        }\r\n                    },\r\n                    resources: {\r\n                        self: [],\r\n                        target: []\r\n                    },\r\n                    conceepts: {\r\n                        self: [],\r\n                        target: []\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    });\r\n}\r\n\r\nexport function getParrySkillWithActions(actor, actionCost) {\r\n    const id = actor.system.proxiedSkills[\"parry\"];\r\n    const skill = actor.items.filter(i => i.type === \"skill\").find(s => s._id === id);\r\n\r\n    return ({\r\n        _id: id,\r\n        name: \"Parry\",\r\n        system: {\r\n            isActivatable: true,\r\n            skillTraits: [],\r\n            skillType: \"basic\",\r\n            attributeIncrease: \"\",\r\n            attributeIncreaseLong: \"\",\r\n            attributeRankIncrease: \"\",\r\n            action: {\r\n                activationType: \"standalone\",\r\n                actionCost: actionCost,\r\n                actionImage: skill.img,\r\n                duration: {\r\n                    precision: \"0\",\r\n                    value: 0\r\n                },\r\n                uses: {\r\n                    hasUses: false,\r\n                    value: 0,\r\n                    max: 0,\r\n                    period: \"\"\r\n                },\r\n                charges: {\r\n                    hasCharges: false,\r\n                    value: 0,\r\n                    max: 0\r\n                },\r\n                isActive: false,\r\n                attackProfile: {},\r\n                modifiers: {\r\n                    fortune: 0,\r\n                    attackProfile: {},\r\n                    damage: {\r\n                        self: []\r\n                    },\r\n                    guard: {\r\n                        self: {\r\n                            value: 0,\r\n                            operator: \"\"\r\n                        },\r\n                        target: {\r\n                            value: 0,\r\n                            operator: \"\"\r\n                        }\r\n                    },\r\n                    risk: {\r\n                        self: {\r\n                            value: 0,\r\n                            operator: \"\"\r\n                        },\r\n                        target: {\r\n                            value: 0,\r\n                            operator: \"\"\r\n                        }\r\n                    },\r\n                    wounds: {\r\n                        self: [],\r\n                        target: []\r\n                    },\r\n                    resolve: {\r\n                        self: {\r\n                            value: 0,\r\n                            operator: \"\"\r\n                        },\r\n                        target: {\r\n                            value: 0,\r\n                            operator: \"\"\r\n                        }\r\n                    },\r\n                    resources: {\r\n                        self: [],\r\n                        target: []\r\n                    },\r\n                    conceepts: {\r\n                        self: [],\r\n                        target: []\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    });\r\n}","import { applyOperator } from \"./operators.mjs\";\r\nimport { applySkillEffects } from \"./skill.mjs\";\r\n\r\nexport async function handleCombatStart(actors) {\r\n    for (const index in actors) {\r\n        const actor = actors[index];\r\n        await actor.update({ \"system.actions\": 5 });\r\n    }\r\n}\r\n\r\nexport async function handleTurnChange(prior, current, priorActor, currentActor) {\r\n    if (current.round < prior.round || (prior.round == current.round && current.turn < prior.turn)) {\r\n        return;\r\n    }\r\n    if (priorActor) {\r\n        await turnEnd(priorActor);\r\n    }\r\n    await turnStart(currentActor);\r\n}\r\n\r\nexport function mergeActorWounds(actor, incomingWounds) {\r\n    // const wounds = actor.system.wounds;\r\n    // const result = [...wounds, ...incomingWounds].reduce((a, { type, value }) => ({ ...a, [type]: a[type] ? { type, value: a[type].value + value } : { type, value } }), {});\r\n    // return Object.values(result).filter(v => v.value > 0);\r\n    return mergeActorWoundsWithOperator(actor, incomingWounds, 'add');\r\n}\r\n\r\nexport function mergeActorWoundsWithOperator(actor, incomingWounds, operator) {\r\n    const wounds = actor.system.wounds;\r\n    // const result = [...wounds, ...incomingWounds].reduce((a, { type, value }) => ({ ...a, [type]: a[type] ? { type, value: applyOperator(a[type].value, value, operator) } : { type, value } }), {});\r\n    // return Object.values(result).filter(v => v.value > 0);\r\n    return mergeWoundsWithOperator(wounds, incomingWounds, operator);\r\n}\r\n\r\nexport function mergeWoundsWithOperator(wounds, incomingWounds, operator) {\r\n    const result = [...wounds, ...incomingWounds].reduce((a, { type, value }) => ({ ...a, [type]: a[type] ? { type, value: applyOperator(a[type].value, value, operator) } : { type, value } }), {});\r\n    return Object.values(result).filter(v => v.value > 0);\r\n}\r\n\r\nexport async function updateActorWounds(actor, updateWounds) {\r\n    await actor.update({ \"system.wounds\": updateWounds });\r\n}\r\n\r\nexport async function checkActorFatalWounds(actor) {\r\n    if (actor.system.defense.fatalWounds) {\r\n        const fatalWounds = JSON.parse(actor.system.defense.fatalWounds).map(w => w.value.toLowerCase());\r\n        const activeFatalWounds = actor.system.wounds.filter(w => fatalWounds.includes(w.type));\r\n        // PLAYTEST: This was the original, if you exceed your max resolve in a specific fatal wound, instead of sum of fatal wounds\r\n        // const exceededFatalWounds = activeFatalWounds.filter(w => w.value >= actor.system.defense.resolve.max);\r\n        // if (exceededFatalWounds && exceededFatalWounds.length > 0) {\r\n        //     await setActorToDead(actor);\r\n        // }\r\n        const totalActiveFatalWounds = activeFatalWounds.reduce((result, wound) => result += wound.value, 0)\r\n        if (totalActiveFatalWounds >= actor.system.defense.resolve.max) {\r\n            await setActorToDead(actor);\r\n        }\r\n    }\r\n}\r\n\r\nexport async function handleActorGuardConditions(actor) {\r\n    if (actor.system.defense.guard.value <= 0) {\r\n        await setActorToGuardBreak(actor);\r\n    } else if (actor.effects.toObject().find(e => e.name === 'Guard Break')) {\r\n        const id = actor.effects.toObject().find(e => e.name === 'Guard Break')._id;\r\n        await actor.deleteEmbeddedDocuments('ActiveEffect', [id]);\r\n    }\r\n}\r\n\r\nexport async function handleActorWoundConditions(actor) {\r\n    const updatedWoundTotal = actor.system.wounds.reduce((total, wound) => total += wound.value, 0);\r\n    if (actor.system.defense.resolve.value <= updatedWoundTotal) {\r\n        await renderLostResolveCard(actor);\r\n    }\r\n\r\n    await checkActorFatalWounds(actor);\r\n}\r\n\r\nasync function renderLostResolveCard(actor) {\r\n    if (actor.statuses.has('defeated')) {\r\n        return;\r\n    }\r\n\r\n    const templateData = {\r\n        actor: actor\r\n    };\r\n\r\n    await setActorToDefeated(actor);\r\n\r\n    const html = await renderTemplate(\"systems/abbrew/templates/chat/lost-resolve-card.hbs\", templateData);\r\n\r\n    // Initialize chat data.\r\n    const speaker = ChatMessage.getSpeaker({ actor: actor });\r\n    // const rollMode = game.settings.get('core', 'rollMode');\r\n    ChatMessage.create({\r\n        speaker: speaker,\r\n        content: html\r\n    });\r\n}\r\n\r\nasync function setActorCondition(actor, conditionName) {\r\n    const condition = CONFIG.ABBREW.conditions[conditionName];\r\n    const statusSet = new Set(condition.statuses);\r\n\r\n    if (statusSet.difference(actor.statuses).size) {\r\n        const conditionEffectData = {\r\n            _id: actor._id,\r\n            name: game.i18n.localize(condition.name),\r\n            img: condition.img,\r\n            changes: [],\r\n            disabled: false,\r\n            duration: {},\r\n            description: game.i18n.localize(condition.description),\r\n            origin: actor._id,\r\n            tint: '',\r\n            transfer: false,\r\n            statuses: statusSet,\r\n            flags: {}\r\n        };\r\n\r\n        await actor.createEmbeddedDocuments('ActiveEffect', [conditionEffectData]);\r\n        console.log(`${actor.name} gained ${conditionName}`);\r\n    }\r\n}\r\n\r\nasync function setActorToDefeated(actor) {\r\n    setActorCondition(actor, 'defeated');\r\n}\r\n\r\nasync function setActorToDead(actor) {\r\n    setActorCondition(actor, 'dead');\r\n}\r\n\r\nasync function setActorToGuardBreak(actor) {\r\n    setActorCondition(actor, 'guardBreak');\r\n}\r\n\r\nasync function setActorToOffGuard(actor) {\r\n    setActorCondition(actor, 'offGuard');\r\n}\r\n\r\nasync function turnEnd(actor) {\r\n    // TODO: Conditions could modify this?\r\n    await actor.update({ \"system.actions\": 5 });\r\n}\r\n\r\nasync function turnStart(actor) {\r\n    if (game.settings.get(\"abbrew\", \"announceTurnStart\")) {\r\n        ChatMessage.create({ content: `${actor.name} starts their turn`, speaker: ChatMessage.getSpeaker({ actor: actor }) });\r\n    }\r\n\r\n    await updateTurnStartWounds(actor);\r\n\r\n    await applyActiveSkills(actor);\r\n}\r\n\r\nasync function updateTurnStartWounds(actor) {\r\n    const lingeringWoundTypes = foundry.utils.deepClone(CONFIG.ABBREW.lingeringWoundTypes);\r\n    const woundToLingeringWounds = foundry.utils.deepClone(CONFIG.ABBREW.woundToLingeringWounds);\r\n    const lingeringWoundImmunities = actor.system.traitsData.filter(t => t.feature === \"wound\" && t.subFeature === \"lingeringWound\" && t.effect === \"immunity\").map(t => t.data);\r\n    const activeLingeringWounds = actor.system.wounds.filter(w => lingeringWoundTypes.some(lw => w.type === lw)).filter(w => !lingeringWoundImmunities.includes(w.type));\r\n    if (activeLingeringWounds.length > 0) {\r\n        const appliedLingeringWounds = {};\r\n        activeLingeringWounds.flatMap(lw => woundToLingeringWounds[lw.type].map(lwt => ({ type: lwt, value: lw.value }))).reduce((appliedLingeringWounds, wound) => {\r\n            if (wound.type in appliedLingeringWounds) {\r\n                appliedLingeringWounds[wound.type] += wound.value;\r\n            } else {\r\n                appliedLingeringWounds[wound.type] = wound.value;\r\n            }\r\n\r\n            return appliedLingeringWounds;\r\n        }, appliedLingeringWounds);\r\n        const acuteWounUpdate = Object.entries(appliedLingeringWounds).map(alw => ({ type: alw[0], value: alw[1] }));\r\n        const lingeringWoundUpdate = activeLingeringWounds.flatMap(lw => actor.system.wounds.filter(w => w.type === lw.type).map(w => ({ type: w.type, value: getLingeringWoundValueUpdate(w.value) })));\r\n        const fullWoundUpdate = [...acuteWounUpdate, ...lingeringWoundUpdate];\r\n        if (fullWoundUpdate.length > 0) {\r\n            await updateActorWounds(actor, mergeActorWounds(actor, fullWoundUpdate));\r\n        }\r\n    }\r\n}\r\n\r\nasync function applyActiveSkills(actor) {\r\n    const activeSkills = actor.system.activeSkills.flatMap(s => actor.items.filter(i => i._id === s));\r\n    for (const index in activeSkills) {\r\n        await applySkillEffects(actor, activeSkills[index]);\r\n    }\r\n}\r\n\r\nfunction getLingeringWoundValueUpdate(woundValue) {\r\n    return woundValue > 1 ? -1 : 0;\r\n}\r\n","/**\r\n * Manage Active Effect instances through an Actor or Item Sheet via effect control buttons.\r\n * @param {MouseEvent} event      The left-click event on the effect control\r\n * @param {Actor|Item} owner      The owning document which manages this effect\r\n */\r\nexport function onManageActiveEffect(event, owner) {\r\n  event.preventDefault();\r\n  const a = event.currentTarget;\r\n  const li = a.closest('li');\r\n  const effect = li.dataset.effectId\r\n    ? owner.effects.get(li.dataset.effectId)\r\n    : null;\r\n  switch (a.dataset.action) {\r\n    case 'create':\r\n      return owner.createEmbeddedDocuments('ActiveEffect', [\r\n        {\r\n          name: game.i18n.format('DOCUMENT.New', {\r\n            type: game.i18n.localize('DOCUMENT.ActiveEffect'),\r\n          }),\r\n          img: 'icons/svg/aura.svg',\r\n          origin: owner.uuid,\r\n          'duration.rounds':\r\n            li.dataset.effectType === 'temporary' ? 1 : undefined,\r\n          disabled: li.dataset.effectType === 'inactive',\r\n        },\r\n      ]);\r\n    case 'edit':\r\n      return effect.sheet.render(true);\r\n    case 'delete':\r\n      return effect.delete();\r\n    case 'toggle':\r\n      return effect.update({ disabled: !effect.disabled });\r\n  }\r\n}\r\n\r\n/**\r\n * Prepare the data structure for Active Effects which are currently embedded in an Actor or Item.\r\n * @param {ActiveEffect[]} effects    A collection or generator of Active Effect documents to prepare sheet data for\r\n * @return {object}                   Data for rendering\r\n */\r\nexport function prepareActiveEffectCategories(effects) {\r\n  // Define effect header categories\r\n  const categories = {\r\n    temporary: {\r\n      type: 'temporary',\r\n      label: game.i18n.localize('ABBREW.Effect.Temporary'),\r\n      effects: [],\r\n    },\r\n    passive: {\r\n      type: 'passive',\r\n      label: game.i18n.localize('ABBREW.Effect.Passive'),\r\n      effects: [],\r\n    },\r\n    inactive: {\r\n      type: 'inactive',\r\n      label: game.i18n.localize('ABBREW.Effect.Inactive'),\r\n      effects: [],\r\n    },\r\n  };\r\n\r\n  // Iterate over active effects, classifying them into categories\r\n  for (let e of effects) {\r\n    if (e.disabled) categories.inactive.effects.push(e);\r\n    else if (e.isTemporary) categories.temporary.effects.push(e);\r\n    else categories.passive.effects.push(e);\r\n  }\r\n  return categories;\r\n}\r\n","/*\nTagify v4.24.0 - tags input component\nBy: Yair Even-Or <vsync.design@gmail.com>\nhttps://github.com/yairEO/tagify\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\nThis Software may not be rebranded and sold as a library under any other name\r\nother than \"Tagify\" (by owner) or as part of another library.\n*/\n\n!function(t,e){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=e():\"function\"==typeof define&&define.amd?define(e):(t=\"undefined\"!=typeof globalThis?globalThis:t||self).Tagify=e()}(this,(function(){\"use strict\";var t=\"&#8203;\";function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function i(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(t){if(\"undefined\"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t[\"@@iterator\"])return Array.from(t)}(t)||function(t,i){if(!t)return;if(\"string\"==typeof t)return e(t,i);var n=Object.prototype.toString.call(t).slice(8,-1);\"Object\"===n&&t.constructor&&(n=t.constructor.name);if(\"Map\"===n||\"Set\"===n)return Array.from(n);if(\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return e(t,i)}(t)||function(){throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}()}var n={isEnabled:function(){var t;return null===(t=window.TAGIFY_DEBUG)||void 0===t||t},log:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var s;this.isEnabled()&&(s=console).log.apply(s,[\"[Tagify]:\"].concat(i(e)))},warn:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var s;this.isEnabled()&&(s=console).warn.apply(s,[\"[Tagify]:\"].concat(i(e)))}},s=function(t,e,i,n){return t=\"\"+t,e=\"\"+e,n&&(t=t.trim(),e=e.trim()),i?t==e:t.toLowerCase()==e.toLowerCase()},a=function(t,e){return t&&Array.isArray(t)&&t.map((function(t){return o(t,e)}))};function o(t,e){var i,n={};for(i in t)e.indexOf(i)<0&&(n[i]=t[i]);return n}function r(t){var e=document.createElement(\"div\");return t.replace(/\\&#?[0-9a-z]+;/gi,(function(t){return e.innerHTML=t,e.innerText}))}function l(t){return(new DOMParser).parseFromString(t.trim(),\"text/html\").body.firstElementChild}function d(t,e){for(e=e||\"previous\";t=t[e+\"Sibling\"];)if(3==t.nodeType)return t}function c(t){return\"string\"==typeof t?t.replace(/&/g,\"&amp;\").replace(/</g,\"&lt;\").replace(/>/g,\"&gt;\").replace(/\"/g,\"&quot;\").replace(/`|'/g,\"&#039;\"):t}function u(t){var e=Object.prototype.toString.call(t).split(\" \")[1].slice(0,-1);return t===Object(t)&&\"Array\"!=e&&\"Function\"!=e&&\"RegExp\"!=e&&\"HTMLUnknownElement\"!=e}function g(t,e,i){var n,s;function a(t,e){for(var i in e)if(e.hasOwnProperty(i)){if(u(e[i])){u(t[i])?a(t[i],e[i]):t[i]=Object.assign({},e[i]);continue}if(Array.isArray(e[i])){t[i]=Object.assign([],e[i]);continue}t[i]=e[i]}}return n=t,(null!=(s=Object)&&\"undefined\"!=typeof Symbol&&s[Symbol.hasInstance]?s[Symbol.hasInstance](n):n instanceof s)||(t={}),a(t,e),i&&a(t,i),t}function h(){var t=[],e={},i=!0,n=!1,s=void 0;try{for(var a,o=arguments[Symbol.iterator]();!(i=(a=o.next()).done);i=!0){var r=a.value,l=!0,d=!1,c=void 0;try{for(var g,h=r[Symbol.iterator]();!(l=(g=h.next()).done);l=!0){var p=g.value;u(p)?e[p.value]||(t.push(p),e[p.value]=1):t.includes(p)||t.push(p)}}catch(t){d=!0,c=t}finally{try{l||null==h.return||h.return()}finally{if(d)throw c}}}}catch(t){n=!0,s=t}finally{try{i||null==o.return||o.return()}finally{if(n)throw s}}return t}function p(t){return String.prototype.normalize?\"string\"==typeof t?t.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g,\"\"):void 0:t}var f=function(){return/(?=.*chrome)(?=.*android)/i.test(navigator.userAgent)};function m(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(t){return(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)}))}function v(t){return t&&t.classList&&t.classList.contains(this.settings.classNames.tag)}function b(t){return t&&t.closest(this.settings.classNames.tagSelector)}function y(t,e){var i=window.getSelection();return e=e||i.getRangeAt(0),\"string\"==typeof t&&(t=document.createTextNode(t)),e&&(e.deleteContents(),e.insertNode(t)),t}function w(t,e,i){return t?(e&&(t.__tagifyTagData=i?e:g({},t.__tagifyTagData||{},e)),t.__tagifyTagData):(n.warn(\"tag element doesn't exist\",{tagElm:t,data:e}),e)}function T(t){if(t&&t.parentNode){var e=t,i=window.getSelection(),n=i.getRangeAt(0);i.rangeCount&&(n.setStartAfter(e),n.collapse(!0),i.removeAllRanges(),i.addRange(n))}}function O(t,e){t.forEach((function(t){if(w(t.previousSibling)||!t.previousSibling){var i=document.createTextNode(\"\");t.before(i),e&&T(i)}}))}var x={delimiters:\",\",pattern:null,tagTextProp:\"value\",maxTags:1/0,callbacks:{},addTagOnBlur:!0,addTagOn:[\"blur\",\"tab\",\"enter\"],onChangeAfterBlur:!0,duplicates:!1,whitelist:[],blacklist:[],enforceWhitelist:!1,userInput:!0,focusable:!0,keepInvalidTags:!1,createInvalidTags:!0,mixTagsAllowedAfter:/,|\\.|\\:|\\s/,mixTagsInterpolator:[\"[[\",\"]]\"],backspace:!0,skipInvalid:!1,pasteAsTags:!0,editTags:{clicks:2,keepInvalid:!0},transformTag:function(){},trim:!0,a11y:{focusableTags:!1},mixMode:{insertAfterTag:\"\"},autoComplete:{enabled:!0,rightKey:!1,tabKey:!1},classNames:{namespace:\"tagify\",mixMode:\"tagify--mix\",selectMode:\"tagify--select\",input:\"tagify__input\",focus:\"tagify--focus\",tagNoAnimation:\"tagify--noAnim\",tagInvalid:\"tagify--invalid\",tagNotAllowed:\"tagify--notAllowed\",scopeLoading:\"tagify--loading\",hasMaxTags:\"tagify--hasMaxTags\",hasNoTags:\"tagify--noTags\",empty:\"tagify--empty\",inputInvalid:\"tagify__input--invalid\",dropdown:\"tagify__dropdown\",dropdownWrapper:\"tagify__dropdown__wrapper\",dropdownHeader:\"tagify__dropdown__header\",dropdownFooter:\"tagify__dropdown__footer\",dropdownItem:\"tagify__dropdown__item\",dropdownItemActive:\"tagify__dropdown__item--active\",dropdownItemHidden:\"tagify__dropdown__item--hidden\",dropdownInital:\"tagify__dropdown--initial\",tag:\"tagify__tag\",tagText:\"tagify__tag-text\",tagX:\"tagify__tag__removeBtn\",tagLoading:\"tagify__tag--loading\",tagEditing:\"tagify__tag--editable\",tagFlash:\"tagify__tag--flash\",tagHide:\"tagify__tag--hide\"},dropdown:{classname:\"\",enabled:2,maxItems:10,searchKeys:[\"value\",\"searchBy\"],fuzzySearch:!0,caseSensitive:!1,accentedSearch:!0,includeSelectedTags:!1,escapeHTML:!0,highlightFirst:!0,closeOnSelect:!0,clearOnSelect:!0,position:\"all\",appendTarget:null},hooks:{beforeRemoveTag:function(){return Promise.resolve()},beforePaste:function(){return Promise.resolve()},suggestionClick:function(){return Promise.resolve()},beforeKeyDown:function(){return Promise.resolve()}}};function D(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function S(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);\"function\"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter((function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable})))),n.forEach((function(e){D(t,e,i[e])}))}return t}function I(t,e){return e=null!=e?e:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):function(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}(Object(e)).forEach((function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(e,i))})),t}var M={events:{binding:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=this.dropdown.events.callbacks,i=this.listeners.dropdown=this.listeners.dropdown||{position:this.dropdown.position.bind(this,null),onKeyDown:e.onKeyDown.bind(this),onMouseOver:e.onMouseOver.bind(this),onMouseLeave:e.onMouseLeave.bind(this),onClick:e.onClick.bind(this),onScroll:e.onScroll.bind(this)},n=t?\"addEventListener\":\"removeEventListener\";\"manual\"!=this.settings.dropdown.position&&(document[n](\"scroll\",i.position,!0),window[n](\"resize\",i.position),window[n](\"keydown\",i.onKeyDown)),this.DOM.dropdown[n](\"mouseover\",i.onMouseOver),this.DOM.dropdown[n](\"mouseleave\",i.onMouseLeave),this.DOM.dropdown[n](\"mousedown\",i.onClick),this.DOM.dropdown.content[n](\"scroll\",i.onScroll)},callbacks:{onKeyDown:function(t){var e=this;if(this.state.hasFocus&&!this.state.composing){var i=this.settings,s=this.DOM.dropdown.querySelector(i.classNames.dropdownItemActiveSelector),a=this.dropdown.getSuggestionDataByNode(s),o=\"mix\"==i.mode,r=\"select\"==i.mode;i.hooks.beforeKeyDown(t,{tagify:this}).then((function(l){switch(t.key){case\"ArrowDown\":case\"ArrowUp\":case\"Down\":case\"Up\":t.preventDefault();var d=e.dropdown.getAllSuggestionsRefs(),c=\"ArrowUp\"==t.key||\"Up\"==t.key;s&&(s=e.dropdown.getNextOrPrevOption(s,!c)),s&&s.matches(i.classNames.dropdownItemSelector)||(s=d[c?d.length-1:0]),e.dropdown.highlightOption(s,!0);break;case\"Escape\":case\"Esc\":e.dropdown.hide();break;case\"ArrowRight\":if(e.state.actions.ArrowLeft)return;case\"Tab\":var u=!i.autoComplete.rightKey||!i.autoComplete.tabKey;if(!o&&!r&&s&&u&&!e.state.editing){t.preventDefault();var g=e.dropdown.getMappedValue(a);return e.input.autocomplete.set.call(e,g),!1}return!0;case\"Enter\":t.preventDefault(),i.hooks.suggestionClick(t,{tagify:e,tagData:a,suggestionElm:s}).then((function(){if(s)return e.dropdown.selectOption(s),s=e.dropdown.getNextOrPrevOption(s,!c),void e.dropdown.highlightOption(s);e.dropdown.hide(),o||e.addTags(e.state.inputText.trim(),!0)})).catch((function(t){return n.warn(t)}));break;case\"Backspace\":if(o||e.state.editing.scope)return;var h=e.input.raw.call(e);\"\"!=h&&8203!=h.charCodeAt(0)||(!0===i.backspace?e.removeTags():\"edit\"==i.backspace&&setTimeout(e.editTag.bind(e),0))}}))}},onMouseOver:function(t){var e=t.target.closest(this.settings.classNames.dropdownItemSelector);this.dropdown.highlightOption(e)},onMouseLeave:function(t){this.dropdown.highlightOption()},onClick:function(t){var e=this;if(0==t.button&&t.target!=this.DOM.dropdown&&t.target!=this.DOM.dropdown.content){var i=t.target.closest(this.settings.classNames.dropdownItemSelector),s=this.dropdown.getSuggestionDataByNode(i);this.state.actions.selectOption=!0,setTimeout((function(){return e.state.actions.selectOption=!1}),50),this.settings.hooks.suggestionClick(t,{tagify:this,tagData:s,suggestionElm:i}).then((function(){i?e.dropdown.selectOption(i,t):e.dropdown.hide()})).catch((function(t){return n.warn(t)}))}},onScroll:function(t){var e=t.target,i=e.scrollTop/(e.scrollHeight-e.parentNode.clientHeight)*100;this.trigger(\"dropdown:scroll\",{percentage:Math.round(i)})}}},refilter:function(t){t=t||this.state.dropdown.query||\"\",this.suggestedListItems=this.dropdown.filterListItems(t),this.dropdown.fill(),this.suggestedListItems.length||this.dropdown.hide(),this.trigger(\"dropdown:updated\",this.DOM.dropdown)},getSuggestionDataByNode:function(t){var e=t&&t.getAttribute(\"value\");return this.suggestedListItems.find((function(t){return t.value==e}))||null},getNextOrPrevOption:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.dropdown.getAllSuggestionsRefs(),n=i.findIndex((function(e){return e===t}));return e?i[n+1]:i[n-1]},highlightOption:function(t,e){var i,n=this.settings.classNames.dropdownItemActive;if(this.state.ddItemElm&&(this.state.ddItemElm.classList.remove(n),this.state.ddItemElm.removeAttribute(\"aria-selected\")),!t)return this.state.ddItemData=null,this.state.ddItemElm=null,void this.input.autocomplete.suggest.call(this);i=this.dropdown.getSuggestionDataByNode(t),this.state.ddItemData=i,this.state.ddItemElm=t,t.classList.add(n),t.setAttribute(\"aria-selected\",!0),e&&(t.parentNode.scrollTop=t.clientHeight+t.offsetTop-t.parentNode.clientHeight),this.settings.autoComplete&&(this.input.autocomplete.suggest.call(this,i),this.dropdown.position())},selectOption:function(t,e){var i=this,n=this.settings,s=n.dropdown,a=s.clearOnSelect,o=s.closeOnSelect;if(!t)return this.addTags(this.state.inputText,!0),void(o&&this.dropdown.hide());e=e||{};var r=t.getAttribute(\"value\"),l=\"noMatch\"==r,d=\"mix\"==n.mode,c=this.suggestedListItems.find((function(t){var e;return(null!==(e=t.value)&&void 0!==e?e:t)==r}));if(this.trigger(\"dropdown:select\",{data:c,elm:t,event:e}),r&&(c||l)){if(this.state.editing){var u=this.normalizeTags([c])[0];c=n.transformTag.call(this,u)||u,this.onEditTagDone(null,g({__isValid:!0},c))}else this[d?\"addMixTags\":\"addTags\"]([c||this.input.raw.call(this)],a);(d||this.DOM.input.parentNode)&&(setTimeout((function(){i.DOM.input.focus(),i.toggleFocusClass(!0)})),o&&setTimeout(this.dropdown.hide.bind(this)),t.addEventListener(\"transitionend\",(function(){i.dropdown.fillHeaderFooter(),setTimeout((function(){return t.remove()}),100)}),{once:!0}),t.classList.add(this.settings.classNames.dropdownItemHidden))}else o&&setTimeout(this.dropdown.hide.bind(this))},selectAll:function(t){this.suggestedListItems.length=0,this.dropdown.hide(),this.dropdown.filterListItems(\"\");var e=this.dropdown.filterListItems(\"\");return t||(e=this.state.dropdown.suggestions),this.addTags(e,!0),this},filterListItems:function(t,e){var i,n,s,a,o,r,l=function(){var t,l,d=void 0,c=void 0;t=m[y],n=(null!=(l=Object)&&\"undefined\"!=typeof Symbol&&l[Symbol.hasInstance]?l[Symbol.hasInstance](t):t instanceof l)?m[y]:{value:m[y]};var v,w=!Object.keys(n).some((function(t){return b.includes(t)}))?[\"value\"]:b;g.fuzzySearch&&!e.exact?(a=w.reduce((function(t,e){return t+\" \"+(n[e]||\"\")}),\"\").toLowerCase().trim(),g.accentedSearch&&(a=p(a),r=p(r)),d=0==a.indexOf(r),c=a===r,v=a,s=r.toLowerCase().split(\" \").every((function(t){return v.includes(t.toLowerCase())}))):(d=!0,s=w.some((function(t){var i=\"\"+(n[t]||\"\");return g.accentedSearch&&(i=p(i),r=p(r)),g.caseSensitive||(i=i.toLowerCase()),c=i===r,e.exact?i===r:0==i.indexOf(r)}))),o=!g.includeSelectedTags&&i.isTagDuplicate(u(n)?n.value:n),s&&!o&&(c&&d?f.push(n):\"startsWith\"==g.sortby&&d?h.unshift(n):h.push(n))},d=this,c=this.settings,g=c.dropdown,h=(e=e||{},[]),f=[],m=c.whitelist,v=g.maxItems>=0?g.maxItems:1/0,b=g.searchKeys,y=0;if(!(t=\"select\"==c.mode&&this.value.length&&this.value[0][c.tagTextProp]==t?\"\":t)||!b.length)return h=g.includeSelectedTags?m:m.filter((function(t){return!d.isTagDuplicate(u(t)?t.value:t)})),this.state.dropdown.suggestions=h,h.slice(0,v);for(r=g.caseSensitive?\"\"+t:(\"\"+t).toLowerCase();y<m.length;y++)i=this,l();return this.state.dropdown.suggestions=f.concat(h),\"function\"==typeof g.sortby?g.sortby(f.concat(h),r):f.concat(h).slice(0,v)},getMappedValue:function(t){var e=this.settings.dropdown.mapValueTo;return e?\"function\"==typeof e?e(t):t[e]||t.value:t.value},createListHTML:function(t){var e=this;return g([],t).map((function(t,i){\"string\"!=typeof t&&\"number\"!=typeof t||(t={value:t});var n=e.dropdown.getMappedValue(t);return n=\"string\"==typeof n&&e.settings.dropdown.escapeHTML?c(n):n,e.settings.templates.dropdownItem.apply(e,[I(S({},t),{mappedValue:n}),e])})).join(\"\")}};function E(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function N(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function _(t){return function(t){if(Array.isArray(t))return E(t)}(t)||function(t){if(\"undefined\"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t[\"@@iterator\"])return Array.from(t)}(t)||function(t,e){if(!t)return;if(\"string\"==typeof t)return E(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);\"Object\"===i&&t.constructor&&(i=t.constructor.name);if(\"Map\"===i||\"Set\"===i)return Array.from(i);if(\"Arguments\"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return E(t,e)}(t)||function(){throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}()}function A(){for(var t in this.dropdown={},this._dropdown)this.dropdown[t]=\"function\"==typeof this._dropdown[t]?this._dropdown[t].bind(this):this._dropdown[t];this.dropdown.refs()}var C,k,L,P=(C=function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);\"function\"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter((function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable})))),n.forEach((function(e){N(t,e,i[e])}))}return t}({},M),k=null!=(k={refs:function(){this.DOM.dropdown=this.parseTemplate(\"dropdown\",[this.settings]),this.DOM.dropdown.content=this.DOM.dropdown.querySelector(\"[data-selector='tagify-suggestions-wrapper']\")},getHeaderRef:function(){return this.DOM.dropdown.querySelector(\"[data-selector='tagify-suggestions-header']\")},getFooterRef:function(){return this.DOM.dropdown.querySelector(\"[data-selector='tagify-suggestions-footer']\")},getAllSuggestionsRefs:function(){return _(this.DOM.dropdown.content.querySelectorAll(this.settings.classNames.dropdownItemSelector))},show:function(t){var e,i,n,a=this,o=this.settings,r=\"mix\"==o.mode&&!o.enforceWhitelist,l=!o.whitelist||!o.whitelist.length,d=\"manual\"==o.dropdown.position;if(t=void 0===t?this.state.inputText:t,!(l&&!r&&!o.templates.dropdownItemNoMatch||!1===o.dropdown.enable||this.state.isLoading||this.settings.readonly)){if(clearTimeout(this.dropdownHide__bindEventsTimeout),this.suggestedListItems=this.dropdown.filterListItems(t),t&&!this.suggestedListItems.length&&(this.trigger(\"dropdown:noMatch\",t),o.templates.dropdownItemNoMatch&&(n=o.templates.dropdownItemNoMatch.call(this,{value:t}))),!n){if(this.suggestedListItems.length)t&&r&&!this.state.editing.scope&&!s(this.suggestedListItems[0].value,t)&&this.suggestedListItems.unshift({value:t});else{if(!t||!r||this.state.editing.scope)return this.input.autocomplete.suggest.call(this),void this.dropdown.hide();this.suggestedListItems=[{value:t}]}i=\"\"+(u(e=this.suggestedListItems[0])?e.value:e),o.autoComplete&&i&&0==i.indexOf(t)&&this.input.autocomplete.suggest.call(this,e)}this.dropdown.fill(n),o.dropdown.highlightFirst&&this.dropdown.highlightOption(this.DOM.dropdown.content.querySelector(o.classNames.dropdownItemSelector)),this.state.dropdown.visible||setTimeout(this.dropdown.events.binding.bind(this)),this.state.dropdown.visible=t||!0,this.state.dropdown.query=t,this.setStateSelection(),d||setTimeout((function(){a.dropdown.position(),a.dropdown.render()})),setTimeout((function(){a.trigger(\"dropdown:show\",a.DOM.dropdown)}))}},hide:function(t){var e=this,i=this.DOM,n=i.scope,s=i.dropdown,a=\"manual\"==this.settings.dropdown.position&&!t;if(s&&document.body.contains(s)&&!a)return window.removeEventListener(\"resize\",this.dropdown.position),this.dropdown.events.binding.call(this,!1),n.setAttribute(\"aria-expanded\",!1),s.parentNode.removeChild(s),setTimeout((function(){e.state.dropdown.visible=!1}),100),this.state.dropdown.query=this.state.ddItemData=this.state.ddItemElm=this.state.selection=null,this.state.tag&&this.state.tag.value.length&&(this.state.flaggedTags[this.state.tag.baseOffset]=this.state.tag),this.trigger(\"dropdown:hide\",s),this},toggle:function(t){this.dropdown[this.state.dropdown.visible&&!t?\"hide\":\"show\"]()},getAppendTarget:function(){var t=this.settings.dropdown;return\"function\"==typeof t.appendTarget?t.appendTarget():t.appendTarget},render:function(){var t,e,i,n=this,s=(t=this.DOM.dropdown,(i=t.cloneNode(!0)).style.cssText=\"position:fixed; top:-9999px; opacity:0\",document.body.appendChild(i),e=i.clientHeight,i.parentNode.removeChild(i),e),a=this.settings,o=\"number\"==typeof a.dropdown.enabled&&a.dropdown.enabled>=0,r=this.dropdown.getAppendTarget();return o?(this.DOM.scope.setAttribute(\"aria-expanded\",!0),document.body.contains(this.DOM.dropdown)||(this.DOM.dropdown.classList.add(a.classNames.dropdownInital),this.dropdown.position(s),r.appendChild(this.DOM.dropdown),setTimeout((function(){return n.DOM.dropdown.classList.remove(a.classNames.dropdownInital)}))),this):this},fill:function(t){t=\"string\"==typeof t?t:this.dropdown.createListHTML(t||this.suggestedListItems);var e,i=this.settings.templates.dropdownContent.call(this,t);this.DOM.dropdown.content.innerHTML=(e=i)?e.replace(/\\>[\\r\\n ]+\\</g,\"><\").split(/>\\s+</).join(\"><\").trim():\"\"},fillHeaderFooter:function(){var t=this.dropdown.filterListItems(this.state.dropdown.query),e=this.parseTemplate(\"dropdownHeader\",[t]),i=this.parseTemplate(\"dropdownFooter\",[t]),n=this.dropdown.getHeaderRef(),s=this.dropdown.getFooterRef();e&&(null==n||n.parentNode.replaceChild(e,n)),i&&(null==s||s.parentNode.replaceChild(i,s))},position:function(t){var e=this.settings.dropdown,i=this.dropdown.getAppendTarget();if(\"manual\"!=e.position&&i){var n,s,a,o,r,l,d,c,u,g=this.DOM.dropdown,h=e.RTL,p=i===document.body,f=i===this.DOM.scope,m=p?window.pageYOffset:i.scrollTop,v=document.fullscreenElement||document.webkitFullscreenElement||document.documentElement,b=v.clientHeight,y=Math.max(v.clientWidth||0,window.innerWidth||0)>480?e.position:\"all\",w=this.DOM[\"input\"==y?\"input\":\"scope\"];if(t=t||g.clientHeight,this.state.dropdown.visible){if(\"text\"==y?(a=(n=function(){var t=document.getSelection();if(t.rangeCount){var e,i,n=t.getRangeAt(0),s=n.startContainer,a=n.startOffset;if(a>0)return(i=document.createRange()).setStart(s,a-1),i.setEnd(s,a),{left:(e=i.getBoundingClientRect()).right,top:e.top,bottom:e.bottom};if(s.getBoundingClientRect)return s.getBoundingClientRect()}return{left:-9999,top:-9999}}()).bottom,s=n.top,o=n.left,r=\"auto\"):(l=function(t){var e=0,i=0;for(t=t.parentNode;t&&t!=v;)e+=t.offsetTop||0,i+=t.offsetLeft||0,t=t.parentNode;return{top:e,left:i}}(i),n=w.getBoundingClientRect(),s=f?-1:n.top-l.top,a=(f?n.height:n.bottom-l.top)-1,o=f?-1:n.left-l.left,r=n.width+\"px\"),!p){var T=function(){for(var t=0,i=e.appendTarget.parentNode;i;)t+=i.scrollTop||0,i=i.parentNode;return t}();s+=T,a+=T}var O;s=Math.floor(s),a=Math.ceil(a),c=((d=null!==(O=e.placeAbove)&&void 0!==O?O:b-n.bottom<t)?s:a)+m,u=\"left: \".concat(o+(h&&n.width||0)+window.pageXOffset,\"px;\"),g.style.cssText=\"\".concat(u,\"; top: \").concat(c,\"px; min-width: \").concat(r,\"; max-width: \").concat(r),g.setAttribute(\"placement\",d?\"top\":\"bottom\"),g.setAttribute(\"position\",y)}}}})?k:{},Object.getOwnPropertyDescriptors?Object.defineProperties(C,Object.getOwnPropertyDescriptors(k)):function(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}(Object(k)).forEach((function(t){Object.defineProperty(C,t,Object.getOwnPropertyDescriptor(k,t))})),C),j=\"@yaireo/tagify/\",V={empty:\"empty\",exceed:\"number of tags exceeded\",pattern:\"pattern mismatch\",duplicate:\"already exists\",notAllowed:\"not allowed\"},R={wrapper:function(e,i){return'<tags class=\"'.concat(i.classNames.namespace,\" \").concat(i.mode?\"\".concat(i.classNames[i.mode+\"Mode\"]):\"\",\" \").concat(e.className,'\"\\n                    ').concat(i.readonly?\"readonly\":\"\",\"\\n                    \").concat(i.disabled?\"disabled\":\"\",\"\\n                    \").concat(i.required?\"required\":\"\",\"\\n                    \").concat(\"select\"===i.mode?\"spellcheck='false'\":\"\",'\\n                    tabIndex=\"-1\">\\n            <span ').concat(!i.readonly&&i.userInput?\"contenteditable\":\"\",' tabIndex=\"0\" data-placeholder=\"').concat(i.placeholder||t,'\" aria-placeholder=\"').concat(i.placeholder||\"\",'\"\\n                class=\"').concat(i.classNames.input,'\"\\n                role=\"textbox\"\\n                aria-autocomplete=\"both\"\\n                aria-multiline=\"').concat(\"mix\"==i.mode,'\"></span>\\n                ').concat(t,\"\\n        </tags>\")},tag:function(t,e){var i=e.settings;return'<tag title=\"'.concat(t.title||t.value,\"\\\"\\n                    contenteditable='false'\\n                    spellcheck='false'\\n                    tabIndex=\\\"\").concat(i.a11y.focusableTags?0:-1,'\"\\n                    class=\"').concat(i.classNames.tag,\" \").concat(t.class||\"\",'\"\\n                    ').concat(this.getAttributes(t),\">\\n            <x title='' tabIndex=\\\"\").concat(i.a11y.focusableTags?0:-1,'\" class=\"').concat(i.classNames.tagX,\"\\\" role='button' aria-label='remove tag'></x>\\n            <div>\\n                <span \").concat(\"select\"===i.mode&&i.userInput?\"contenteditable='true'\":\"\",' class=\"').concat(i.classNames.tagText,'\">').concat(t[i.tagTextProp]||t.value,\"</span>\\n            </div>\\n        </tag>\")},dropdown:function(t){var e=t.dropdown,i=\"manual\"==e.position;return'<div class=\"'.concat(i?\"\":t.classNames.dropdown,\" \").concat(e.classname,'\" role=\"listbox\" aria-labelledby=\"dropdown\" dir=\"').concat(e.RTL?\"rtl\":\"\",\"\\\">\\n                    <div data-selector='tagify-suggestions-wrapper' class=\\\"\").concat(t.classNames.dropdownWrapper,'\"></div>\\n                </div>')},dropdownContent:function(t){var e=this.settings.templates,i=this.state.dropdown.suggestions;return\"\\n            \".concat(e.dropdownHeader.call(this,i),\"\\n            \").concat(t,\"\\n            \").concat(e.dropdownFooter.call(this,i),\"\\n        \")},dropdownItem:function(t){return\"<div \".concat(this.getAttributes(t),\"\\n                    class='\").concat(this.settings.classNames.dropdownItem,\" \").concat(t.class||\"\",'\\'\\n                    tabindex=\"0\"\\n                    role=\"option\">').concat(t.mappedValue||t.value,\"</div>\")},dropdownHeader:function(t){return\"<header data-selector='tagify-suggestions-header' class=\\\"\".concat(this.settings.classNames.dropdownHeader,'\"></header>')},dropdownFooter:function(t){var e=t.length-this.settings.dropdown.maxItems;return e>0?\"<footer data-selector='tagify-suggestions-footer' class=\\\"\".concat(this.settings.classNames.dropdownFooter,'\">\\n                ').concat(e,\" more items. Refine your search.\\n            </footer>\"):\"\"},dropdownItemNoMatch:null};function F(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function H(t,e){return null!=e&&\"undefined\"!=typeof Symbol&&e[Symbol.hasInstance]?!!e[Symbol.hasInstance](t):t instanceof e}function B(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var i=null==t?null:\"undefined\"!=typeof Symbol&&t[Symbol.iterator]||t[\"@@iterator\"];if(null!=i){var n,s,a=[],o=!0,r=!1;try{for(i=i.call(t);!(o=(n=i.next()).done)&&(a.push(n.value),!e||a.length!==e);o=!0);}catch(t){r=!0,s=t}finally{try{o||null==i.return||i.return()}finally{if(r)throw s}}return a}}(t,e)||function(t,e){if(!t)return;if(\"string\"==typeof t)return F(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);\"Object\"===i&&t.constructor&&(i=t.constructor.name);if(\"Map\"===i||\"Set\"===i)return Array.from(i);if(\"Arguments\"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return F(t,e)}(t,e)||function(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}()}function W(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function U(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function q(t,e){return null!=e&&\"undefined\"!=typeof Symbol&&e[Symbol.hasInstance]?!!e[Symbol.hasInstance](t):t instanceof e}function K(t,e){return e=null!=e?e:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):function(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}(Object(e)).forEach((function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(e,i))})),t}function z(t){return function(t){if(Array.isArray(t))return W(t)}(t)||function(t){if(\"undefined\"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t[\"@@iterator\"])return Array.from(t)}(t)||function(t,e){if(!t)return;if(\"string\"==typeof t)return W(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);\"Object\"===i&&t.constructor&&(i=t.constructor.name);if(\"Map\"===i||\"Set\"===i)return Array.from(i);if(\"Arguments\"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return W(t,e)}(t)||function(){throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}()}var X={customBinding:function(){var t=this;this.customEventsList.forEach((function(e){t.on(e,t.settings.callbacks[e])}))},binding:function(){var t,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],i=this.settings,n=this.events.callbacks,s=e?\"addEventListener\":\"removeEventListener\";if(!this.state.mainEvents||!e){for(var a in this.state.mainEvents=e,e&&!this.listeners.main&&(this.events.bindGlobal.call(this),this.settings.isJQueryPlugin&&jQuery(this.DOM.originalInput).on(\"tagify.removeAllTags\",this.removeAllTags.bind(this))),t=this.listeners.main=this.listeners.main||{keydown:[\"input\",n.onKeydown.bind(this)],click:[\"scope\",n.onClickScope.bind(this)],dblclick:\"select\"!=i.mode&&[\"scope\",n.onDoubleClickScope.bind(this)],paste:[\"input\",n.onPaste.bind(this)],drop:[\"input\",n.onDrop.bind(this)],compositionstart:[\"input\",n.onCompositionStart.bind(this)],compositionend:[\"input\",n.onCompositionEnd.bind(this)]})t[a]&&this.DOM[t[a][0]][s](a,t[a][1]);clearInterval(this.listeners.main.originalInputValueObserverInterval),this.listeners.main.originalInputValueObserverInterval=setInterval(n.observeOriginalInputValue.bind(this),500);var o=this.listeners.main.inputMutationObserver||new MutationObserver(n.onInputDOMChange.bind(this));o.disconnect(),\"mix\"==i.mode&&o.observe(this.DOM.input,{childList:!0})}},bindGlobal:function(t){var e,i=this.events.callbacks,n=t?\"removeEventListener\":\"addEventListener\";if(this.listeners&&(t||!this.listeners.global)){this.listeners.global=this.listeners.global||[{type:this.isIE?\"keydown\":\"input\",target:this.DOM.input,cb:i[this.isIE?\"onInputIE\":\"onInput\"].bind(this)},{type:\"keydown\",target:window,cb:i.onWindowKeyDown.bind(this)},{type:\"focusin\",target:this.DOM.scope,cb:i.onFocusBlur.bind(this)},{type:\"focusout\",target:this.DOM.scope,cb:i.onFocusBlur.bind(this)},{type:\"click\",target:document,cb:i.onClickAnywhere.bind(this),useCapture:!0}];var s=!0,a=!1,o=void 0;try{for(var r,l=this.listeners.global[Symbol.iterator]();!(s=(r=l.next()).done);s=!0)(e=r.value).target[n](e.type,e.cb,!!e.useCapture)}catch(t){a=!0,o=t}finally{try{s||null==l.return||l.return()}finally{if(a)throw o}}}},unbindGlobal:function(){this.events.bindGlobal.call(this,!0)},callbacks:{onFocusBlur:function(t){var e,i,n,s=b.call(this,t.target),a=v.call(this,t.target),o=\"focusin\"==t.type,r=\"focusout\"==t.type,l=null===(e=t.target)||void 0===e?void 0:e.closest(this.settings.classNames.tagTextSelector);if(s&&o&&!a)return this.toggleFocusClass(this.state.hasFocus=+new Date),l?this.events.callbacks.onEditTagFocus.call(this,s):void 0;var d=this.settings,c=t.target?this.trim(this.DOM.input.textContent):\"\",u=null===(n=this.value)||void 0===n||null===(i=n[0])||void 0===i?void 0:i[d.tagTextProp],g=d.dropdown.enabled>=0,h={relatedTarget:t.relatedTarget},p=this.state.actions.selectOption&&(g||!d.dropdown.closeOnSelect),f=this.state.actions.addNew&&g;if(r){if(t.relatedTarget===this.DOM.scope)return this.dropdown.hide(),void this.DOM.input.focus();this.postUpdate()}if(!p&&!f)if(this.state.hasFocus=!!o&&+new Date,this.toggleFocusClass(this.state.hasFocus),\"mix\"!=d.mode){if(o){if(!d.focusable)return;return this.toggleFocusClass(!0),this.trigger(\"focus\",h),void(0!==d.dropdown.enabled||this.state.dropdown.visible||this.dropdown.show(this.value.length?\"\":void 0))}if(r&&!a){if(this.trigger(\"blur\",h),this.loading(!1),\"select\"==d.mode){if(this.value.length){var m=this.getTagElms()[0];c=this.trim(m.textContent)}u===c&&(c=\"\")}c&&!this.state.actions.selectOption&&d.addTagOnBlur&&d.addTagOn.includes(\"blur\")&&this.addTags(c,!0)}this.DOM.input.removeAttribute(\"style\"),this.dropdown.hide()}else o?this.trigger(\"focus\",h):r&&(this.trigger(\"blur\",h),this.loading(!1),this.dropdown.hide(),this.state.dropdown.visible=void 0,this.setStateSelection())},onCompositionStart:function(t){this.state.composing=!0},onCompositionEnd:function(t){this.state.composing=!1},onWindowKeyDown:function(t){var e,i=document.activeElement,n=v.call(this,i)&&this.DOM.scope.contains(document.activeElement),s=n&&i.hasAttribute(\"readonly\");if(n&&!s)switch(e=i.nextElementSibling,t.key){case\"Backspace\":this.settings.readonly||(this.removeTags(i),(e||this.DOM.input).focus());break;case\"Enter\":setTimeout(this.editTag.bind(this),0,i)}},onKeydown:function(t){var e=this,i=this.settings;if(!this.state.composing&&i.userInput){\"select\"==i.mode&&i.enforceWhitelist&&this.value.length&&\"Tab\"!=t.key&&t.preventDefault();var n=this.trim(t.target.textContent);this.trigger(\"keydown\",{event:t}),i.hooks.beforeKeyDown(t,{tagify:this}).then((function(s){if(\"mix\"==i.mode){switch(t.key){case\"Left\":case\"ArrowLeft\":e.state.actions.ArrowLeft=!0;break;case\"Delete\":case\"Backspace\":if(e.state.editing)return;var a=document.getSelection(),o=\"Delete\"==t.key&&a.anchorOffset==(a.anchorNode.length||0),l=a.anchorNode.previousSibling,c=1==a.anchorNode.nodeType||!a.anchorOffset&&l&&1==l.nodeType&&a.anchorNode.previousSibling;r(e.DOM.input.innerHTML);var u,g,h,p=e.getTagElms(),m=1===a.anchorNode.length&&a.anchorNode.nodeValue==String.fromCharCode(8203);if(\"edit\"==i.backspace&&c)return u=1==a.anchorNode.nodeType?null:a.anchorNode.previousElementSibling,setTimeout(e.editTag.bind(e),0,u),void t.preventDefault();if(f()&&q(c,Element))return h=d(c),c.hasAttribute(\"readonly\")||c.remove(),e.DOM.input.focus(),void setTimeout((function(){T(h),e.DOM.input.click()}));if(\"BR\"==a.anchorNode.nodeName)return;if((o||c)&&1==a.anchorNode.nodeType?g=0==a.anchorOffset?o?p[0]:null:p[Math.min(p.length,a.anchorOffset)-1]:o?g=a.anchorNode.nextElementSibling:q(c,Element)&&(g=c),3==a.anchorNode.nodeType&&!a.anchorNode.nodeValue&&a.anchorNode.previousElementSibling&&t.preventDefault(),(c||o)&&!i.backspace)return void t.preventDefault();if(\"Range\"!=a.type&&!a.anchorOffset&&a.anchorNode==e.DOM.input&&\"Delete\"!=t.key)return void t.preventDefault();if(\"Range\"!=a.type&&g&&g.hasAttribute(\"readonly\"))return void T(d(g));\"Delete\"==t.key&&m&&w(a.anchorNode.nextSibling)&&e.removeTags(a.anchorNode.nextSibling),clearTimeout(L),L=setTimeout((function(){var t=document.getSelection();r(e.DOM.input.innerHTML),!o&&t.anchorNode.previousSibling,e.value=[].map.call(p,(function(t,i){var n=w(t);if(t.parentNode||n.readonly)return n;e.trigger(\"remove\",{tag:t,index:i,data:n})})).filter((function(t){return t}))}),20)}return!0}var v=\"manual\"==i.dropdown.position;switch(t.key){case\"Backspace\":\"select\"==i.mode&&i.enforceWhitelist&&e.value.length?e.removeTags():e.state.dropdown.visible&&\"manual\"!=i.dropdown.position||\"\"!=t.target.textContent&&8203!=n.charCodeAt(0)||(!0===i.backspace?e.removeTags():\"edit\"==i.backspace&&setTimeout(e.editTag.bind(e),0));break;case\"Esc\":case\"Escape\":if(e.state.dropdown.visible)return;t.target.blur();break;case\"Down\":case\"ArrowDown\":e.state.dropdown.visible||e.dropdown.show();break;case\"ArrowRight\":var b=e.state.inputSuggestion||e.state.ddItemData;if(b&&i.autoComplete.rightKey)return void e.addTags([b],!0);break;case\"Tab\":var y=\"select\"==i.mode;if(!n||y)return!0;t.preventDefault();case\"Enter\":if(e.state.dropdown.visible&&!v)return;t.preventDefault(),setTimeout((function(){e.state.dropdown.visible&&!v||e.state.actions.selectOption||!i.addTagOn.includes(t.key.toLowerCase())||e.addTags(n,!0)}))}})).catch((function(t){return t}))}},onInput:function(t){this.postUpdate();var e=this.settings;if(\"mix\"==e.mode)return this.events.callbacks.onMixTagsInput.call(this,t);var i=this.input.normalize.call(this,void 0,{trim:!1}),n=i.length>=e.dropdown.enabled,s={value:i,inputElm:this.DOM.input},a=this.validateTag({value:i});\"select\"==e.mode&&this.toggleScopeValidation(a),s.isValid=a,this.state.inputText!=i&&(this.input.set.call(this,i,!1),-1!=i.search(e.delimiters)?this.addTags(i)&&this.input.set.call(this):e.dropdown.enabled>=0&&this.dropdown[n?\"show\":\"hide\"](i),this.trigger(\"input\",s))},onMixTagsInput:function(t){var e,i,n,s,a,o,r,l,d=this,c=this.settings,u=this.value.length,h=this.getTagElms(),p=document.createDocumentFragment(),m=window.getSelection().getRangeAt(0),v=[].map.call(h,(function(t){return w(t).value}));if(\"deleteContentBackward\"==t.inputType&&f()&&this.events.callbacks.onKeydown.call(this,{target:t.target,key:\"Backspace\"}),O(this.getTagElms()),this.value.slice().forEach((function(t){t.readonly&&!v.includes(t.value)&&p.appendChild(d.createTagElem(t))})),p.childNodes.length&&(m.insertNode(p),this.setRangeAtStartEnd(!1,p.lastChild)),h.length!=u)return this.value=[].map.call(this.getTagElms(),(function(t){return w(t)})),void this.update({withoutChangeEvent:!0});if(this.hasMaxTags())return!0;if(window.getSelection&&(o=window.getSelection()).rangeCount>0&&3==o.anchorNode.nodeType){if((m=o.getRangeAt(0).cloneRange()).collapse(!0),m.setStart(o.focusNode,0),n=(e=m.toString().slice(0,m.endOffset)).split(c.pattern).length-1,(i=e.match(c.pattern))&&(s=e.slice(e.lastIndexOf(i[i.length-1]))),s){if(this.state.actions.ArrowLeft=!1,this.state.tag={prefix:s.match(c.pattern)[0],value:s.replace(c.pattern,\"\")},this.state.tag.baseOffset=o.baseOffset-this.state.tag.value.length,l=this.state.tag.value.match(c.delimiters))return this.state.tag.value=this.state.tag.value.replace(c.delimiters,\"\"),this.state.tag.delimiters=l[0],this.addTags(this.state.tag.value,c.dropdown.clearOnSelect),void this.dropdown.hide();a=this.state.tag.value.length>=c.dropdown.enabled;try{r=(r=this.state.flaggedTags[this.state.tag.baseOffset]).prefix==this.state.tag.prefix&&r.value[0]==this.state.tag.value[0],this.state.flaggedTags[this.state.tag.baseOffset]&&!this.state.tag.value&&delete this.state.flaggedTags[this.state.tag.baseOffset]}catch(t){}(r||n<this.state.mixMode.matchedPatternCount)&&(a=!1)}else this.state.flaggedTags={};this.state.mixMode.matchedPatternCount=n}setTimeout((function(){d.update({withoutChangeEvent:!0}),d.trigger(\"input\",g({},d.state.tag,{textContent:d.DOM.input.textContent})),d.state.tag&&d.dropdown[a?\"show\":\"hide\"](d.state.tag.value)}),10)},onInputIE:function(t){var e=this;setTimeout((function(){e.events.callbacks.onInput.call(e,t)}))},observeOriginalInputValue:function(){this.DOM.originalInput.parentNode||this.destroy(),this.DOM.originalInput.value!=this.DOM.originalInput.tagifyValue&&this.loadOriginalValues()},onClickAnywhere:function(t){t.target==this.DOM.scope||this.DOM.scope.contains(t.target)||(this.toggleFocusClass(!1),this.state.hasFocus=!1,!this.settings.userInput&&this.dropdown.hide())},onClickScope:function(t){var e=this.settings,i=t.target.closest(\".\"+e.classNames.tag),n=t.target===this.DOM.scope,s=+new Date-this.state.hasFocus;if(n&&\"select\"!=e.mode)this.DOM.input.focus();else{if(!t.target.classList.contains(e.classNames.tagX))return i&&!this.state.editing?(this.trigger(\"click\",{tag:i,index:this.getNodeIndex(i),data:w(i),event:t}),void(1!==e.editTags&&1!==e.editTags.clicks&&\"select\"!=e.mode||this.events.callbacks.onDoubleClickScope.call(this,t))):void(t.target==this.DOM.input&&(\"mix\"==e.mode&&this.fixFirefoxLastTagNoCaret(),s>500||!e.focusable)?this.state.dropdown.visible?this.dropdown.hide():0===e.dropdown.enabled&&\"mix\"!=e.mode&&this.dropdown.show(this.value.length?\"\":void 0):\"select\"!=e.mode||0!==e.dropdown.enabled||this.state.dropdown.visible||(this.events.callbacks.onDoubleClickScope.call(this,K(function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);\"function\"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter((function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable})))),n.forEach((function(e){U(t,e,i[e])}))}return t}({},t),{target:this.getTagElms()[0]})),!e.userInput&&this.dropdown.show()));this.removeTags(t.target.parentNode)}},onPaste:function(t){var e=this;t.preventDefault();var i,n,s,a=this.settings;if(\"select\"==a.mode&&a.enforceWhitelist||!a.userInput)return!1;a.readonly||(n=t.clipboardData||window.clipboardData,s=n.getData(\"Text\"),a.hooks.beforePaste(t,{tagify:this,pastedText:s,clipboardData:n}).then((function(a){void 0===a&&(a=s),a&&(e.injectAtCaret(a,window.getSelection().getRangeAt(0)),\"mix\"==e.settings.mode?e.events.callbacks.onMixTagsInput.call(e,t):e.settings.pasteAsTags?i=e.addTags(e.state.inputText+a,!0):(e.state.inputText=a,e.dropdown.show(a))),e.trigger(\"paste\",{event:t,pastedText:s,clipboardData:n,tagsElems:i})})).catch((function(t){return t})))},onDrop:function(t){t.preventDefault()},onEditTagInput:function(t,e){var i,n=t.closest(\".\"+this.settings.classNames.tag),s=this.getNodeIndex(n),a=w(n),o=this.input.normalize.call(this,t),r=(U(i={},this.settings.tagTextProp,o),U(i,\"__tagId\",a.__tagId),i),l=this.validateTag(r);this.editTagChangeDetected(g(a,r))||!0!==t.originalIsValid||(l=!0),n.classList.toggle(this.settings.classNames.tagInvalid,!0!==l),a.__isValid=l,n.title=!0===l?a.title||a.value:l,o.length>=this.settings.dropdown.enabled&&(this.state.editing&&(this.state.editing.value=o),this.dropdown.show(o)),this.trigger(\"edit:input\",{tag:n,index:s,data:g({},this.value[s],{newValue:o}),event:e})},onEditTagPaste:function(t,e){var i=(e.clipboardData||window.clipboardData).getData(\"Text\");e.preventDefault();var n=y(i);this.setRangeAtStartEnd(!1,n)},onEditTagClick:function(t,e){this.events.callbacks.onClickScope.call(this,e)},onEditTagFocus:function(t){this.state.editing={scope:t,input:t.querySelector(\"[contenteditable]\")}},onEditTagBlur:function(t,e){var i=v.call(this,e.relatedTarget);if(\"select\"==this.settings.mode&&i&&e.relatedTarget.contains(e.target))this.dropdown.hide();else if(this.state.editing&&(this.state.hasFocus||this.toggleFocusClass(),this.DOM.scope.contains(t))){var n,s,a,o=this.settings,r=t.closest(\".\"+o.classNames.tag),l=w(r),d=this.input.normalize.call(this,t),c=(U(n={},o.tagTextProp,d),U(n,\"__tagId\",l.__tagId),n),u=l.__originalData,h=this.editTagChangeDetected(g(l,c)),p=this.validateTag(c);if(d)if(h){var f;if(s=this.hasMaxTags(),a=g({},u,(U(f={},o.tagTextProp,this.trim(d)),U(f,\"__isValid\",p),f)),o.transformTag.call(this,a,u),!0!==(p=(!s||!0===u.__isValid)&&this.validateTag(a))){if(this.trigger(\"invalid\",{data:a,tag:r,message:p}),o.editTags.keepInvalid)return;o.keepInvalidTags?a.__isValid=p:a=u}else o.keepInvalidTags&&(delete a.title,delete a[\"aria-invalid\"],delete a.class);this.onEditTagDone(r,a)}else this.onEditTagDone(r,u);else this.onEditTagDone(r)}},onEditTagkeydown:function(t,e){if(!this.state.composing)switch(this.trigger(\"edit:keydown\",{event:t}),t.key){case\"Esc\":case\"Escape\":this.state.editing=!1,!!e.__tagifyTagData.__originalData.value?e.parentNode.replaceChild(e.__tagifyTagData.__originalHTML,e):e.remove();break;case\"Enter\":case\"Tab\":t.preventDefault();setTimeout((function(){return t.target.blur()}),0)}},onDoubleClickScope:function(t){var e,i,n=t.target.closest(\".\"+this.settings.classNames.tag),s=w(n),a=this.settings;n&&!1!==s.editable&&(e=n.classList.contains(this.settings.classNames.tagEditing),i=n.hasAttribute(\"readonly\"),a.readonly||e||i||!this.settings.editTags||!a.userInput||this.editTag(n),this.toggleFocusClass(!0),\"select\"!=a.mode&&this.trigger(\"dblclick\",{tag:n,index:this.getNodeIndex(n),data:w(n)}))},onInputDOMChange:function(t){var e=this;t.forEach((function(t){t.addedNodes.forEach((function(t){if(\"<div><br></div>\"==t.outerHTML)t.replaceWith(document.createElement(\"br\"));else if(1==t.nodeType&&t.querySelector(e.settings.classNames.tagSelector)){var i,n=document.createTextNode(\"\");3==t.childNodes[0].nodeType&&\"BR\"!=t.previousSibling.nodeName&&(n=document.createTextNode(\"\\n\")),(i=t).replaceWith.apply(i,z([n].concat(z(z(t.childNodes).slice(0,-1))))),T(n)}else if(v.call(e,t)){var s;if(3!=(null===(s=t.previousSibling)||void 0===s?void 0:s.nodeType)||t.previousSibling.textContent||t.previousSibling.remove(),t.previousSibling&&\"BR\"==t.previousSibling.nodeName){t.previousSibling.replaceWith(\"\\n\");for(var a=t.nextSibling,o=\"\";a;)o+=a.textContent,a=a.nextSibling;o.trim()&&T(t.previousSibling)}else t.previousSibling&&!w(t.previousSibling)||t.before(\"\")}})),t.removedNodes.forEach((function(t){t&&\"BR\"==t.nodeName&&v.call(e,i)&&(e.removeTags(i),e.fixFirefoxLastTagNoCaret())}))}));var i=this.DOM.input.lastChild;i&&\"\"==i.nodeValue&&i.remove(),i&&\"BR\"==i.nodeName||this.DOM.input.appendChild(document.createElement(\"br\"))}}};function J(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function G(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function $(t,e){return null!=e&&\"undefined\"!=typeof Symbol&&e[Symbol.hasInstance]?!!e[Symbol.hasInstance](t):t instanceof e}function Q(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);\"function\"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter((function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable})))),n.forEach((function(e){G(t,e,i[e])}))}return t}function Y(t){return function(t){if(Array.isArray(t))return J(t)}(t)||function(t){if(\"undefined\"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t[\"@@iterator\"])return Array.from(t)}(t)||function(t,e){if(!t)return;if(\"string\"==typeof t)return J(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);\"Object\"===i&&t.constructor&&(i=t.constructor.name);if(\"Map\"===i||\"Set\"===i)return Array.from(i);if(\"Arguments\"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return J(t,e)}(t)||function(){throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}()}function Z(t,e){if(!t){n.warn(\"input element not found\",t);var i=new Proxy(this,{get:function(){return function(){return i}}});return i}if(t.__tagify)return n.warn(\"input element is already Tagified - Same instance is returned.\",t),t.__tagify;var s;g(this,function(t){var e=document.createTextNode(\"\"),i={};function s(t,i,n){n&&i.split(/\\s+/g).forEach((function(i){return e[t+\"EventListener\"].call(e,i,n)}))}return{removeAllCustomListeners:function(){Object.entries(i).forEach((function(t){var e=B(t,2),i=e[0];e[1].forEach((function(t){return s(\"remove\",i,t)}))})),i={}},off:function(t,e){return t&&(e?s(\"remove\",t,e):t.split(/\\s+/g).forEach((function(t){var e;null===(e=i[t])||void 0===e||e.forEach((function(e){return s(\"remove\",t,e)})),delete i[t]}))),this},on:function(t,e){return e&&\"function\"==typeof e&&(t.split(/\\s+/g).forEach((function(t){Array.isArray(i[t])?i[t].push(e):i[t]=[e]})),s(\"add\",t,e)),this},trigger:function(i,s,a){var o;if(a=a||{cloneData:!0},i)if(t.settings.isJQueryPlugin)\"remove\"==i&&(i=\"removeTag\"),jQuery(t.DOM.originalInput).triggerHandler(i,[s]);else{try{var r=\"object\"==typeof s?s:{value:s};if((r=a.cloneData?g({},r):r).tagify=this,s.event&&(r.event=this.cloneEvent(s.event)),H(s,Object))for(var l in s)H(s[l],HTMLElement)&&(r[l]=s[l]);o=new CustomEvent(i,{detail:r})}catch(t){n.warn(t)}e.dispatchEvent(o)}}}}(this)),this.isFirefox=/firefox|fxios/i.test(navigator.userAgent)&&!/seamonkey/i.test(navigator.userAgent),this.isIE=window.document.documentMode,e=e||{},this.getPersistedData=(s=e.id,function(t){var e,i=\"/\"+t;if(1==localStorage.getItem(j+s+\"/v\",1))try{e=JSON.parse(localStorage[j+s+i])}catch(t){}return e}),this.setPersistedData=function(t){return t?(localStorage.setItem(j+t+\"/v\",1),function(e,i){var n=\"/\"+i,s=JSON.stringify(e);e&&i&&(localStorage.setItem(j+t+n,s),dispatchEvent(new Event(\"storage\")))}):function(){}}(e.id),this.clearPersistedData=function(t){return function(e){var i=j+\"/\"+t+\"/\";if(e)localStorage.removeItem(i+e);else for(var n in localStorage)n.includes(i)&&localStorage.removeItem(n)}}(e.id),this.applySettings(t,e),this.state={inputText:\"\",editing:!1,composing:!1,actions:{},mixMode:{},dropdown:{},flaggedTags:{}},this.value=[],this.listeners={},this.DOM={},this.build(t),A.call(this),this.getCSSVars(),this.loadOriginalValues(),this.events.customBinding.call(this),this.events.binding.call(this),t.autofocus&&this.DOM.input.focus(),t.__tagify=this}return Z.prototype={_dropdown:P,placeCaretAfterNode:T,getSetTagData:w,helpers:{sameStr:s,removeCollectionProp:a,omit:o,isObject:u,parseHTML:l,escapeHTML:c,extend:g,concatWithoutDups:h,getUID:m,isNodeTag:v},customEventsList:[\"change\",\"add\",\"remove\",\"invalid\",\"input\",\"paste\",\"click\",\"keydown\",\"focus\",\"blur\",\"edit:input\",\"edit:beforeUpdate\",\"edit:updated\",\"edit:start\",\"edit:keydown\",\"dropdown:show\",\"dropdown:hide\",\"dropdown:select\",\"dropdown:updated\",\"dropdown:noMatch\",\"dropdown:scroll\"],dataProps:[\"__isValid\",\"__removed\",\"__originalData\",\"__originalHTML\",\"__tagId\"],trim:function(t){return this.settings.trim&&t&&\"string\"==typeof t?t.trim():t},parseHTML:l,templates:R,parseTemplate:function(t,e){return l((t=this.settings.templates[t]||t).apply(this,e))},set whitelist(t){var e=t&&Array.isArray(t);this.settings.whitelist=e?t:[],this.setPersistedData(e?t:[],\"whitelist\")},get whitelist(){return this.settings.whitelist},set userInput(t){this.settings.userInput=!!t,this.setContentEditable(!!t)},get userInput(){return this.settings.userInput},generateClassSelectors:function(t){var e=function(e){var i=e;Object.defineProperty(t,i+\"Selector\",{get:function(){return\".\"+this[i].split(\" \")[0]}})};for(var i in t)e(i)},applySettings:function(t,e){var i,n;x.templates=this.templates;var s=g({},x,\"mix\"==e.mode?{dropdown:{position:\"text\"}}:{}),a=this.settings=g({},s,e);if(a.disabled=t.hasAttribute(\"disabled\"),a.readonly=a.readonly||t.hasAttribute(\"readonly\"),a.placeholder=c(t.getAttribute(\"placeholder\")||a.placeholder||\"\"),a.required=t.hasAttribute(\"required\"),this.generateClassSelectors(a.classNames),void 0===a.dropdown.includeSelectedTags&&(a.dropdown.includeSelectedTags=a.duplicates),this.isIE&&(a.autoComplete=!1),[\"whitelist\",\"blacklist\"].forEach((function(e){var i=t.getAttribute(\"data-\"+e);i&&$(i=i.split(a.delimiters),Array)&&(a[e]=i)})),\"autoComplete\"in e&&!u(e.autoComplete)&&(a.autoComplete=x.autoComplete,a.autoComplete.enabled=e.autoComplete),\"mix\"==a.mode&&(a.pattern=a.pattern||/@/,a.autoComplete.rightKey=!0,a.delimiters=e.delimiters||null,a.tagTextProp&&!a.dropdown.searchKeys.includes(a.tagTextProp)&&a.dropdown.searchKeys.push(a.tagTextProp)),t.pattern)try{a.pattern=new RegExp(t.pattern)}catch(t){}if(a.delimiters){a._delimiters=a.delimiters;try{a.delimiters=new RegExp(this.settings.delimiters,\"g\")}catch(t){}}a.disabled&&(a.userInput=!1),this.TEXTS=Q({},V,a.texts||{}),(\"select\"!=a.mode||(null===(i=e.dropdown)||void 0===i?void 0:i.enabled))&&a.userInput||(a.dropdown.enabled=0),a.dropdown.appendTarget=(null===(n=e.dropdown)||void 0===n?void 0:n.appendTarget)||document.body;var o=this.getPersistedData(\"whitelist\");Array.isArray(o)&&(this.whitelist=Array.isArray(a.whitelist)?h(a.whitelist,o):o)},getAttributes:function(t){var e,i=this.getCustomAttributes(t),n=\"\";for(e in i)n+=\" \"+e+(void 0!==t[e]?'=\"'.concat(i[e],'\"'):\"\");return n},getCustomAttributes:function(t){if(!u(t))return\"\";var e,i={};for(e in t)\"__\"!=e.slice(0,2)&&\"class\"!=e&&t.hasOwnProperty(e)&&void 0!==t[e]&&(i[e]=c(t[e]));return i},setStateSelection:function(){var t=window.getSelection(),e={anchorOffset:t.anchorOffset,anchorNode:t.anchorNode,range:t.getRangeAt&&t.rangeCount&&t.getRangeAt(0)};return this.state.selection=e,e},getCSSVars:function(){var t,e,i,n=getComputedStyle(this.DOM.scope,null);this.CSSVars={tagHideTransition:(t=function(t){if(!t)return{};var e=(t=t.trim().split(\" \")[0]).split(/\\d+/g).filter((function(t){return t})).pop().trim();return{value:+t.split(e).filter((function(t){return t}))[0].trim(),unit:e}}((i=\"tag-hide-transition\",n.getPropertyValue(\"--\"+i))),e=t.value,\"s\"==t.unit?1e3*e:e)}},build:function(t){var e=this.DOM,i=t.closest(\"label\");this.settings.mixMode.integrated?(e.originalInput=null,e.scope=t,e.input=t):(e.originalInput=t,e.originalInput_tabIndex=t.tabIndex,e.scope=this.parseTemplate(\"wrapper\",[t,this.settings]),e.input=e.scope.querySelector(this.settings.classNames.inputSelector),t.parentNode.insertBefore(e.scope,t),t.tabIndex=-1),i&&i.setAttribute(\"for\",\"\")},destroy:function(){this.events.unbindGlobal.call(this),this.DOM.scope.parentNode.removeChild(this.DOM.scope),this.DOM.originalInput.tabIndex=this.DOM.originalInput_tabIndex,delete this.DOM.originalInput.__tagify,this.dropdown.hide(!0),this.removeAllCustomListeners(),clearTimeout(this.dropdownHide__bindEventsTimeout),clearInterval(this.listeners.main.originalInputValueObserverInterval)},loadOriginalValues:function(t){var e,i=this.settings;if(this.state.blockChangeEvent=!0,void 0===t){var n=this.getPersistedData(\"value\");t=n&&!this.DOM.originalInput.value?n:i.mixMode.integrated?this.DOM.input.textContent:this.DOM.originalInput.value}if(this.removeAllTags(),t)if(\"mix\"==i.mode)this.parseMixTags(t),(e=this.DOM.input.lastChild)&&\"BR\"==e.tagName||this.DOM.input.insertAdjacentHTML(\"beforeend\",\"<br>\");else{try{$(JSON.parse(t),Array)&&(t=JSON.parse(t))}catch(t){}this.addTags(t,!0).forEach((function(t){return t&&t.classList.add(i.classNames.tagNoAnimation)}))}else this.postUpdate();this.state.lastOriginalValueReported=i.mixMode.integrated?\"\":this.DOM.originalInput.value},cloneEvent:function(t){var e={};for(var i in t)\"path\"!=i&&(e[i]=t[i]);return e},loading:function(t){return this.state.isLoading=t,this.DOM.scope.classList[t?\"add\":\"remove\"](this.settings.classNames.scopeLoading),this},tagLoading:function(t,e){return t&&t.classList[e?\"add\":\"remove\"](this.settings.classNames.tagLoading),this},toggleClass:function(t,e){\"string\"==typeof t&&this.DOM.scope.classList.toggle(t,e)},toggleScopeValidation:function(t){var e=!0===t||void 0===t;!this.settings.required&&t&&t===this.TEXTS.empty&&(e=!0),this.toggleClass(this.settings.classNames.tagInvalid,!e),this.DOM.scope.title=e?\"\":t},toggleFocusClass:function(t){this.toggleClass(this.settings.classNames.focus,!!t)},setPlaceholder:function(t){var e=this;[\"data\",\"aria\"].forEach((function(i){return e.DOM.input.setAttribute(\"\".concat(i,\"-placeholder\"),t)}))},triggerChangeEvent:function(){if(!this.settings.mixMode.integrated){var t=this.DOM.originalInput,e=this.state.lastOriginalValueReported!==t.value,i=new CustomEvent(\"change\",{bubbles:!0});e&&(this.state.lastOriginalValueReported=t.value,i.simulated=!0,t._valueTracker&&t._valueTracker.setValue(Math.random()),t.dispatchEvent(i),this.trigger(\"change\",this.state.lastOriginalValueReported),t.value=this.state.lastOriginalValueReported)}},events:X,fixFirefoxLastTagNoCaret:function(){},setRangeAtStartEnd:function(t,e){if(e){t=\"number\"==typeof t?t:!!t,e=e.lastChild||e;var i=document.getSelection();if($(i.focusNode,Element)&&!this.DOM.input.contains(i.focusNode))return!0;try{i.rangeCount>=1&&[\"Start\",\"End\"].forEach((function(n){return i.getRangeAt(0)[\"set\"+n](e,t||e.length)}))}catch(t){console.warn(t)}}},insertAfterTag:function(t,e){if(e=e||this.settings.mixMode.insertAfterTag,t&&t.parentNode&&e)return e=\"string\"==typeof e?document.createTextNode(e):e,t.parentNode.insertBefore(e,t.nextSibling),e},editTagChangeDetected:function(t){var e=t.__originalData;for(var i in e)if(!this.dataProps.includes(i)&&t[i]!=e[i])return!0;return!1},getTagTextNode:function(t){return t.querySelector(this.settings.classNames.tagTextSelector)},setTagTextNode:function(t,e){this.getTagTextNode(t).innerHTML=c(e)},editTag:function(t,e){var i=this;t=t||this.getLastTag(),e=e||{};var s=this.settings,a=this.getTagTextNode(t),o=this.getNodeIndex(t),r=w(t),l=this.events.callbacks,d=!0;if(\"select\"!=s.mode&&this.dropdown.hide(),a){if(!$(r,Object)||!(\"editable\"in r)||r.editable)return r=w(t,{__originalData:g({},r),__originalHTML:t.cloneNode(!0)}),w(r.__originalHTML,r.__originalData),a.setAttribute(\"contenteditable\",!0),t.classList.add(s.classNames.tagEditing),a.addEventListener(\"click\",l.onEditTagClick.bind(this,t)),a.addEventListener(\"blur\",l.onEditTagBlur.bind(this,this.getTagTextNode(t))),a.addEventListener(\"input\",l.onEditTagInput.bind(this,a)),a.addEventListener(\"paste\",l.onEditTagPaste.bind(this,a)),a.addEventListener(\"keydown\",(function(e){return l.onEditTagkeydown.call(i,e,t)})),a.addEventListener(\"compositionstart\",l.onCompositionStart.bind(this)),a.addEventListener(\"compositionend\",l.onCompositionEnd.bind(this)),e.skipValidation||(d=this.editTagToggleValidity(t)),a.originalIsValid=d,this.trigger(\"edit:start\",{tag:t,index:o,data:r,isValid:d}),a.focus(),this.setRangeAtStartEnd(!1,a),0===s.dropdown.enabled&&this.dropdown.show(),this.state.hasFocus=!0,this}else n.warn(\"Cannot find element in Tag template: .\",s.classNames.tagTextSelector)},editTagToggleValidity:function(t,e){var i;if(e=e||w(t))return(i=!(\"__isValid\"in e)||!0===e.__isValid)||this.removeTagsFromValue(t),this.update(),t.classList.toggle(this.settings.classNames.tagNotAllowed,!i),e.__isValid=i,e.__isValid;n.warn(\"tag has no data: \",t,e)},onEditTagDone:function(t,e){t=t||this.state.editing.scope,e=e||{};var i,n,s={tag:t,index:this.getNodeIndex(t),previousData:w(t),data:e},a=this.settings;this.trigger(\"edit:beforeUpdate\",s,{cloneData:!1}),this.state.editing=!1,delete e.__originalData,delete e.__originalHTML,t&&(void 0!==(n=e[a.tagTextProp])?null===(i=(n+=\"\").trim)||void 0===i?void 0:i.call(n):a.tagTextProp in e?void 0:e.value)?(t=this.replaceTag(t,e),this.editTagToggleValidity(t,e),a.a11y.focusableTags?t.focus():T(t)):t&&this.removeTags(t),this.trigger(\"edit:updated\",s),this.dropdown.hide(),this.settings.keepInvalidTags&&this.reCheckInvalidTags()},replaceTag:function(t,e){e&&\"\"!==e.value&&void 0!==e.value||(e=t.__tagifyTagData),e.__isValid&&1!=e.__isValid&&g(e,this.getInvalidTagAttrs(e,e.__isValid));var i=this.createTagElem(e);return t.parentNode.replaceChild(i,t),this.updateValueByDOMTags(),i},updateValueByDOMTags:function(){var t=this;this.value.length=0,[].forEach.call(this.getTagElms(),(function(e){e.classList.contains(t.settings.classNames.tagNotAllowed.split(\" \")[0])||t.value.push(w(e))})),this.update()},injectAtCaret:function(t,e){var i;if(!(e=e||(null===(i=this.state.selection)||void 0===i?void 0:i.range))&&t)return this.appendMixTags(t),this;var n=y(t,e);return this.setRangeAtStartEnd(!1,n),this.updateValueByDOMTags(),this.update(),this},input:{set:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:\"\",e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.settings.dropdown.closeOnSelect;this.state.inputText=t,e&&(this.DOM.input.innerHTML=c(\"\"+t)),!t&&i&&this.dropdown.hide.bind(this),this.input.autocomplete.suggest.call(this),this.input.validate.call(this)},raw:function(){return this.DOM.input.textContent},validate:function(){var t=!this.state.inputText||!0===this.validateTag({value:this.state.inputText});return this.DOM.input.classList.toggle(this.settings.classNames.inputInvalid,!t),t},normalize:function(t,e){var i=t||this.DOM.input,n=[];i.childNodes.forEach((function(t){return 3==t.nodeType&&n.push(t.nodeValue)})),n=n.join(\"\\n\");try{n=n.replace(/(?:\\r\\n|\\r|\\n)/g,this.settings.delimiters.source.charAt(0))}catch(t){}return n=n.replace(/\\s/g,\" \"),(null==e?void 0:e.trim)?this.trim(n):n},autocomplete:{suggest:function(t){if(this.settings.autoComplete.enabled){\"object\"!=typeof(t=t||{value:\"\"})&&(t={value:t});var e=this.dropdown.getMappedValue(t);if(\"number\"!=typeof e){var i=this.state.inputText.toLowerCase(),n=e.substr(0,this.state.inputText.length).toLowerCase(),s=e.substring(this.state.inputText.length);e&&this.state.inputText&&n==i?(this.DOM.input.setAttribute(\"data-suggest\",s),this.state.inputSuggestion=t):(this.DOM.input.removeAttribute(\"data-suggest\"),delete this.state.inputSuggestion)}}},set:function(t){var e=this.DOM.input.getAttribute(\"data-suggest\"),i=t||(e?this.state.inputText+e:null);return!!i&&(\"mix\"==this.settings.mode?this.replaceTextWithNode(document.createTextNode(this.state.tag.prefix+i)):(this.input.set.call(this,i),this.setRangeAtStartEnd(!1,this.DOM.input)),this.input.autocomplete.suggest.call(this),this.dropdown.hide(),!0)}}},getTagIdx:function(t){return this.value.findIndex((function(e){return e.__tagId==(t||{}).__tagId}))},getNodeIndex:function(t){var e=0;if(t)for(;t=t.previousElementSibling;)e++;return e},getTagElms:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];var n=\".\"+Y(this.settings.classNames.tag.split(\" \")).concat(Y(e)).join(\".\");return[].slice.call(this.DOM.scope.querySelectorAll(n))},getLastTag:function(){var t=this.DOM.scope.querySelectorAll(\"\".concat(this.settings.classNames.tagSelector,\":not(.\").concat(this.settings.classNames.tagHide,\"):not([readonly])\"));return t[t.length-1]},isTagDuplicate:function(t,e,i){var n=0;if(\"select\"==this.settings.mode)return!1;var a=!0,o=!1,r=void 0;try{for(var l,d=this.value[Symbol.iterator]();!(a=(l=d.next()).done);a=!0){var c=l.value;s(this.trim(\"\"+t),c.value,e)&&i!=c.__tagId&&n++}}catch(t){o=!0,r=t}finally{try{a||null==d.return||d.return()}finally{if(o)throw r}}return n},getTagIndexByValue:function(t){var e=this,i=[],n=this.settings.dropdown.caseSensitive;return this.getTagElms().forEach((function(a,o){a.__tagifyTagData&&s(e.trim(a.__tagifyTagData.value),t,n)&&i.push(o)})),i},getTagElmByValue:function(t){var e=this.getTagIndexByValue(t)[0];return this.getTagElms()[e]},flashTag:function(t){var e=this;t&&(t.classList.add(this.settings.classNames.tagFlash),setTimeout((function(){t.classList.remove(e.settings.classNames.tagFlash)}),100))},isTagBlacklisted:function(t){return t=this.trim(t.toLowerCase()),this.settings.blacklist.filter((function(e){return(\"\"+e).toLowerCase()==t})).length},isTagWhitelisted:function(t){return!!this.getWhitelistItem(t)},getWhitelistItem:function(t,e,i){e=e||\"value\";var n,a=this.settings;return(i=i||a.whitelist).some((function(i){var o=\"string\"==typeof i?i:i[e]||i.value;if(s(o,t,a.dropdown.caseSensitive,a.trim))return n=\"string\"==typeof i?{value:i}:i,!0})),n||\"value\"!=e||\"value\"==a.tagTextProp||(n=this.getWhitelistItem(t,a.tagTextProp,i)),n},validateTag:function(t){var e=this.settings,i=\"value\"in t?\"value\":e.tagTextProp,n=this.trim(t[i]+\"\");return(t[i]+\"\").trim()?\"mix\"!=e.mode&&e.pattern&&$(e.pattern,RegExp)&&!e.pattern.test(n)?this.TEXTS.pattern:!e.duplicates&&this.isTagDuplicate(n,e.dropdown.caseSensitive,t.__tagId)?this.TEXTS.duplicate:this.isTagBlacklisted(n)||e.enforceWhitelist&&!this.isTagWhitelisted(n)?this.TEXTS.notAllowed:!e.validate||e.validate(t):this.TEXTS.empty},getInvalidTagAttrs:function(t,e){return{\"aria-invalid\":!0,class:\"\".concat(t.class||\"\",\" \").concat(this.settings.classNames.tagNotAllowed).trim(),title:e}},hasMaxTags:function(){return this.value.length>=this.settings.maxTags&&this.TEXTS.exceed},setReadonly:function(t,e){var i=this.settings;document.activeElement.blur(),i[e||\"readonly\"]=t,this.DOM.scope[(t?\"set\":\"remove\")+\"Attribute\"](e||\"readonly\",!0),this.settings.userInput=!0,this.setContentEditable(!t)},setContentEditable:function(t){this.DOM.input.contentEditable=t,this.DOM.input.tabIndex=t?0:-1},setDisabled:function(t){this.setReadonly(t,\"disabled\")},normalizeTags:function(t){var e=this,i=this.settings,n=i.whitelist,s=i.delimiters,a=i.mode,o=i.tagTextProp,r=[],l=!!n&&$(n[0],Object),d=Array.isArray(t),c=d&&t[0].value,u=function(t){return(t+\"\").split(s).filter((function(t){return t})).map((function(t){var i;return G(i={},o,e.trim(t)),G(i,\"value\",e.trim(t)),i}))};if(\"number\"==typeof t&&(t=t.toString()),\"string\"==typeof t){if(!t.trim())return[];t=u(t)}else if(d){var g;t=(g=[]).concat.apply(g,Y(t.map((function(t){return null!=t.value?t:u(t)}))))}return l&&!c&&(t.forEach((function(t){var i=r.map((function(t){return t.value})),n=e.dropdown.filterListItems.call(e,t[o],{exact:!0});e.settings.duplicates||(n=n.filter((function(t){return!i.includes(t.value)})));var s=n.length>1?e.getWhitelistItem(t[o],o,n):n[0];s&&$(s,Object)?r.push(s):\"mix\"!=a&&(null==t.value&&(t.value=t[o]),r.push(t))})),r.length&&(t=r)),t},parseMixTags:function(t){var e=this,i=this.settings,n=i.mixTagsInterpolator,s=i.duplicates,a=i.transformTag,o=i.enforceWhitelist,r=i.maxTags,l=i.tagTextProp,d=[];t=t.split(n[0]).map((function(t,i){var c,u,g,h=t.split(n[1]),p=h[0],f=d.length==r;try{if(p==+p)throw Error;u=JSON.parse(p)}catch(t){u=e.normalizeTags(p)[0]||{value:p}}if(a.call(e,u),f||!(h.length>1)||o&&!e.isTagWhitelisted(u.value)||!s&&e.isTagDuplicate(u.value)){if(t)return i?n[0]+t:t}else u[c=u[l]?l:\"value\"]=e.trim(u[c]),g=e.createTagElem(u),d.push(u),g.classList.add(e.settings.classNames.tagNoAnimation),h[0]=g.outerHTML,e.value.push(u);return h.join(\"\")})).join(\"\"),this.DOM.input.innerHTML=t,this.DOM.input.appendChild(document.createTextNode(\"\")),this.DOM.input.normalize();var c=this.getTagElms();return c.forEach((function(t,e){return w(t,d[e])})),this.update({withoutChangeEvent:!0}),O(c,this.state.hasFocus),t},replaceTextWithNode:function(t,e){if(this.state.tag||e){e=e||this.state.tag.prefix+this.state.tag.value;var i,n,s=this.state.selection||window.getSelection(),a=s.anchorNode,o=this.state.tag.delimiters?this.state.tag.delimiters.length:0;return a.splitText(s.anchorOffset-o),-1==(i=a.nodeValue.lastIndexOf(e))?!0:(n=a.splitText(i),t&&a.parentNode.replaceChild(t,n),!0)}},prepareNewTagNode:function(t,e){e=e||{};var i=this.settings,n=[],s={},a=Object.assign({},t,{value:t.value+\"\"});if(t=Object.assign({},a),i.transformTag.call(this,t),t.__isValid=this.hasMaxTags()||this.validateTag(t),!0!==t.__isValid){if(e.skipInvalid)return;if(g(s,this.getInvalidTagAttrs(t,t.__isValid),{__preInvalidData:a}),t.__isValid==this.TEXTS.duplicate&&this.flashTag(this.getTagElmByValue(t.value)),!i.createInvalidTags)return void n.push(t.value)}return\"readonly\"in t&&(t.readonly?s[\"aria-readonly\"]=!0:delete t.readonly),{tagElm:this.createTagElem(t,s),tagData:t,aggregatedInvalidInput:n}},postProcessNewTagNode:function(t,e){var i=this,n=this.settings,s=e.__isValid;s&&!0===s?(this.value.push(e),this.trigger(\"add\",{tag:t,index:this.value.length-1,data:e})):(this.trigger(\"invalid\",{data:e,index:this.value.length,tag:t,message:s}),n.keepInvalidTags||setTimeout((function(){return i.removeTags(t,!0)}),1e3)),this.dropdown.position()},selectTag:function(t,e){var i=this;if(!this.settings.enforceWhitelist||this.isTagWhitelisted(e.value)){this.state.actions.selectOption&&setTimeout((function(){return i.setRangeAtStartEnd(!1,i.DOM.input)}));var n=this.getLastTag();return n?this.replaceTag(n,e):this.appendTag(t),this.value[0]=e,this.update(),this.trigger(\"add\",{tag:t,data:e}),[t]}},addEmptyTag:function(t){var e=g({value:\"\"},t||{}),i=this.createTagElem(e);w(i,e),this.appendTag(i),this.editTag(i,{skipValidation:!0}),this.toggleFocusClass(!0)},addTags:function(t,e,i){var n=this,s=[],a=this.settings,o=[],r=document.createDocumentFragment();if(!t||0==t.length)return s;switch(t=this.normalizeTags(t),a.mode){case\"mix\":return this.addMixTags(t);case\"select\":e=!1,this.removeAllTags()}return this.DOM.input.removeAttribute(\"style\"),t.forEach((function(t){var e=n.prepareNewTagNode(t,{skipInvalid:i||a.skipInvalid});if(e){var l=e.tagElm;if(t=e.tagData,o=e.aggregatedInvalidInput,s.push(l),\"select\"==a.mode)return n.selectTag(l,t);r.appendChild(l),n.postProcessNewTagNode(l,t)}})),this.appendTag(r),this.update(),t.length&&e&&(this.input.set.call(this,a.createInvalidTags?\"\":o.join(a._delimiters)),this.setRangeAtStartEnd(!1,this.DOM.input)),a.dropdown.enabled&&this.dropdown.refilter(),s},addMixTags:function(t){var e=this;if((t=this.normalizeTags(t))[0].prefix||this.state.tag)return this.prefixedTextToTag(t[0]);var i=document.createDocumentFragment();return t.forEach((function(t){var n=e.prepareNewTagNode(t);i.appendChild(n.tagElm),e.insertAfterTag(n.tagElm),e.postProcessNewTagNode(n.tagElm,n.tagData)})),this.appendMixTags(i),i.children},appendMixTags:function(t){var e=!!this.state.selection;e?this.injectAtCaret(t):(this.DOM.input.focus(),(e=this.setStateSelection()).range.setStart(this.DOM.input,e.range.endOffset),e.range.setEnd(this.DOM.input,e.range.endOffset),this.DOM.input.appendChild(t),this.updateValueByDOMTags(),this.update())},prefixedTextToTag:function(t){var e,i,n,s=this,a=this.settings,o=null===(e=this.state.tag)||void 0===e?void 0:e.delimiters;if(t.prefix=t.prefix||this.state.tag?this.state.tag.prefix:(a.pattern.source||a.pattern)[0],n=this.prepareNewTagNode(t),i=n.tagElm,this.replaceTextWithNode(i)||this.DOM.input.appendChild(i),setTimeout((function(){return i.classList.add(s.settings.classNames.tagNoAnimation)}),300),this.value.push(n.tagData),this.update(),!o){var r=this.insertAfterTag(i)||i;setTimeout(T,0,r)}return this.state.tag=null,this.postProcessNewTagNode(i,n.tagData),i},appendTag:function(t){var e=this.DOM,i=e.input;e.scope.insertBefore(t,i)},createTagElem:function(t,e){t.__tagId=m();var i,n=g({},t,Q({value:c(t.value+\"\")},e));return function(t){for(var e,i=document.createNodeIterator(t,NodeFilter.SHOW_TEXT,null,!1);e=i.nextNode();)e.textContent.trim()||e.parentNode.removeChild(e)}(i=this.parseTemplate(\"tag\",[n,this])),w(i,t),i},reCheckInvalidTags:function(){var t=this,e=this.settings;this.getTagElms(e.classNames.tagNotAllowed).forEach((function(i,n){var s=w(i),a=t.hasMaxTags(),o=t.validateTag(s),r=!0===o&&!a;if(\"select\"==e.mode&&t.toggleScopeValidation(o),r)return s=s.__preInvalidData?s.__preInvalidData:{value:s.value},t.replaceTag(i,s);i.title=a||o}))},removeTags:function(t,e,i){var n,s=this,a=this.settings;if(t=t&&$(t,HTMLElement)?[t]:$(t,Array)?t:t?[t]:[this.getLastTag()],n=t.reduce((function(t,e){e&&\"string\"==typeof e&&(e=s.getTagElmByValue(e));var i=w(e);return e&&i&&!i.readonly&&t.push({node:e,idx:s.getTagIdx(i),data:w(e,{__removed:!0})}),t}),[]),i=\"number\"==typeof i?i:this.CSSVars.tagHideTransition,\"select\"==a.mode&&(i=0,this.input.set.call(this)),1==n.length&&\"select\"!=a.mode&&n[0].node.classList.contains(a.classNames.tagNotAllowed)&&(e=!0),n.length)return a.hooks.beforeRemoveTag(n,{tagify:this}).then((function(){var t=function(t){t.node.parentNode&&(t.node.parentNode.removeChild(t.node),e?a.keepInvalidTags&&this.trigger(\"remove\",{tag:t.node,index:t.idx}):(this.trigger(\"remove\",{tag:t.node,index:t.idx,data:t.data}),this.dropdown.refilter(),this.dropdown.position(),this.DOM.input.normalize(),a.keepInvalidTags&&this.reCheckInvalidTags()))};i&&i>10&&1==n.length?function(e){e.node.style.width=parseFloat(window.getComputedStyle(e.node).width)+\"px\",document.body.clientTop,e.node.classList.add(a.classNames.tagHide),setTimeout(t.bind(this),i,e)}.call(s,n[0]):n.forEach(t.bind(s)),e||(s.removeTagsFromValue(n.map((function(t){return t.node}))),s.update(),\"select\"==a.mode&&a.userInput&&s.setContentEditable(!0))})).catch((function(t){}))},removeTagsFromDOM:function(){this.getTagElms().forEach((function(t){return t.remove()}))},removeTagsFromValue:function(t){var e=this;(t=Array.isArray(t)?t:[t]).forEach((function(t){var i=w(t),n=e.getTagIdx(i);n>-1&&e.value.splice(n,1)}))},removeAllTags:function(t){var e=this;t=t||{},this.value=[],\"mix\"==this.settings.mode?this.DOM.input.innerHTML=\"\":this.removeTagsFromDOM(),this.dropdown.refilter(),this.dropdown.position(),this.state.dropdown.visible&&setTimeout((function(){e.DOM.input.focus()})),\"select\"==this.settings.mode&&(this.input.set.call(this),this.settings.userInput&&this.setContentEditable(!0)),this.update(t)},postUpdate:function(){this.state.blockChangeEvent=!1;var t,e,i=this.settings,n=i.classNames,s=\"mix\"==i.mode?i.mixMode.integrated?this.DOM.input.textContent:this.DOM.originalInput.value.trim():this.value.length+this.input.raw.call(this).length;(this.toggleClass(n.hasMaxTags,this.value.length>=i.maxTags),this.toggleClass(n.hasNoTags,!this.value.length),this.toggleClass(n.empty,!s),\"select\"==i.mode)&&this.toggleScopeValidation(null===(e=this.value)||void 0===e||null===(t=e[0])||void 0===t?void 0:t.__isValid)},setOriginalInputValue:function(t){var e=this.DOM.originalInput;this.settings.mixMode.integrated||(e.value=t,e.tagifyValue=e.value,this.setPersistedData(t,\"value\"))},update:function(t){clearTimeout(this.debouncedUpdateTimeout),this.debouncedUpdateTimeout=setTimeout(function(){var e=this.getInputValue();this.setOriginalInputValue(e),this.settings.onChangeAfterBlur&&(t||{}).withoutChangeEvent||this.state.blockChangeEvent||this.triggerChangeEvent();this.postUpdate()}.bind(this),100)},getInputValue:function(){var t=this.getCleanValue();return\"mix\"==this.settings.mode?this.getMixedTagsAsString(t):t.length?this.settings.originalInputValueFormat?this.settings.originalInputValueFormat(t):JSON.stringify(t):\"\"},getCleanValue:function(t){return a(t||this.value,this.dataProps)},getMixedTagsAsString:function(){var t=\"\",e=this,i=this.settings,n=i.originalInputValueFormat||JSON.stringify,s=i.mixTagsInterpolator;return function i(a){a.childNodes.forEach((function(a){if(1==a.nodeType){var r=w(a);if(\"BR\"==a.tagName&&(t+=\"\\r\\n\"),r&&v.call(e,a)){if(r.__removed)return;t+=s[0]+n(o(r,e.dataProps))+s[1]}else a.getAttribute(\"style\")||[\"B\",\"I\",\"U\"].includes(a.tagName)?t+=a.textContent:\"DIV\"!=a.tagName&&\"P\"!=a.tagName||(t+=\"\\r\\n\",i(a))}else t+=a.textContent}))}(this.DOM.input),t}},Z.prototype.removeTag=Z.prototype.removeTags,Z}));\n//# sourceMappingURL=tagify.min.js.map\r\n","import { mergeActorWounds, updateActorWounds } from '../helpers/combat.mjs';\r\nimport {\r\n  onManageActiveEffect,\r\n  prepareActiveEffectCategories,\r\n} from '../helpers/effects.mjs';\r\nimport Tagify from '@yaireo/tagify'\r\nimport { handleSkillActivate } from '../helpers/skill.mjs';\r\n\r\n/**\r\n * Extend the basic ActorSheet with some very simple modifications\r\n * @extends {ActorSheet}\r\n */\r\nexport class AbbrewActorSheet extends ActorSheet {\r\n  /** @override */\r\n  static get defaultOptions() {\r\n    return foundry.utils.mergeObject(super.defaultOptions, {\r\n      classes: ['abbrew', 'sheet', 'actor'],\r\n      width: 750,\r\n      height: 600,\r\n      tabs: [\r\n        {\r\n          navSelector: '.sheet-tabs',\r\n          contentSelector: '.sheet-body',\r\n          initial: 'skills',\r\n        },\r\n      ],\r\n    });\r\n  }\r\n\r\n  /** @override */\r\n  get template() {\r\n    return `systems/abbrew/templates/actor/actor-${this.actor.type}-sheet.hbs`;\r\n  }\r\n\r\n  /* -------------------------------------------- */\r\n\r\n  /** @override */\r\n  async getData() {\r\n    // Retrieve the data structure from the base sheet. You can inspect or log\r\n    // the context variable to see the structure, but some key properties for\r\n    // sheets are the actor object, the data object, whether or not it's\r\n    // editable, the items array, and the effects array.\r\n    const context = super.getData();\r\n\r\n    // Use a safe clone of the actor data for further operations.\r\n    const actorData = context.data;\r\n\r\n    // Add the actor's data to context.data for easier access, as well as flags.\r\n    context.system = actorData.system;\r\n    context.flags = actorData.flags;\r\n\r\n    // Prepare character data and items.\r\n    if (actorData.type == 'character') {\r\n      this._prepareItems(context);\r\n      this._prepareCharacterData(context);\r\n    }\r\n\r\n    // Prepare NPC data and items.\r\n    if (actorData.type == 'npc') {\r\n      this._prepareItems(context);\r\n    }\r\n\r\n    // Enrich biography info for display\r\n    // Enrichment turns text like `[[/r 1d20]]` into buttons\r\n    context.enrichedBiography = await TextEditor.enrichHTML(\r\n      this.actor.system.biography,\r\n      {\r\n        // Whether to show secret blocks in the finished html\r\n        secrets: this.document.isOwner,\r\n        // Necessary in v11, can be removed in v12\r\n        async: true,\r\n        // Data to fill in for inline rolls\r\n        rollData: this.actor.getRollData(),\r\n        // Relative UUID resolution\r\n        relativeTo: this.actor,\r\n      }\r\n    );\r\n\r\n    // Prepare active effects\r\n    context.effects = prepareActiveEffectCategories(\r\n      // A generator that returns all effects stored on the actor\r\n      // as well as any items\r\n      this.actor.allApplicableEffects()\r\n    );\r\n\r\n    context.config = CONFIG.ABBREW;\r\n\r\n    return context;\r\n  }\r\n\r\n  /**\r\n   * Organize and classify Items for Character sheets.\r\n   *\r\n   * @param {Object} actorData The actor to prepare.\r\n   *\r\n   * @return {undefined}\r\n   */\r\n  _prepareCharacterData(context) {\r\n    // Handle attribute scores.\r\n    // for (let [k, v] of Object.entries(context.system.abilities)) {\r\n    //   v.label = game.i18n.localize(CONFIG.ABBREW.abilities[k]) ?? k;\r\n    // }\r\n  }\r\n\r\n  /**\r\n   * Organize and classify Items for Character sheets.\r\n   *\r\n   * @param {Object} actorData The actor to prepare.\r\n   *\r\n   * @return {undefined}\r\n   */\r\n  _prepareItems(context) {\r\n    // Initialize containers.    \r\n    const gear = [];\r\n    const features = [];\r\n    const skills = { background: [], basic: [], path: [], resource: [], temporary: [], untyped: [] };\r\n    const spells = {\r\n      0: [],\r\n      1: [],\r\n      2: [],\r\n      3: [],\r\n      4: [],\r\n      5: [],\r\n      6: [],\r\n      7: [],\r\n      8: [],\r\n      9: [],\r\n    };\r\n    const anatomy = [];\r\n    const armour = [];\r\n    const weapons = [];\r\n    const equippedWeapons = [];\r\n\r\n    // Iterate through items, allocating to containers\r\n    for (let i of context.items) {\r\n      i.img = i.img || Item.DEFAULT_ICON;\r\n      // Append to gear.\r\n      if (i.type === 'item') {\r\n        gear.push(i);\r\n      }\r\n      // Append to features.\r\n      else if (i.type === 'feature') {\r\n        features.push(i);\r\n      }\r\n      // Append to skills.\r\n      else if (i.type === 'skill') {\r\n        switch (i.system.skillType) {\r\n          case 'background':\r\n            skills.background.push(i);\r\n            break;\r\n          case 'basic':\r\n            skills.basic.push(i);\r\n            break;\r\n          case 'path':\r\n            skills.path.push(i)\r\n            break;\r\n          case 'resource':\r\n            skills.resource.push(i)\r\n            break;\r\n          case 'temporary':\r\n            skills.temporary.push(i)\r\n            break;\r\n          default:\r\n            skills.untyped.push(i);\r\n        }\r\n      }\r\n      else if (i.type === 'anatomy') {\r\n        anatomy.push(i);\r\n      }\r\n      else if (i.type === 'armour') {\r\n        armour.push(i);\r\n      }\r\n      else if (i.type === 'weapon') {\r\n        weapons.push(i);\r\n        // TODO: May want to handle unarmed etc. differently i.e. worn weapons with no hands required.\r\n        // TODO: Non physical weapons?\r\n        // Unarmed technically should take 1h but stowed / dropped seem a little funny\r\n        if (['held1H', 'held2H'].includes(i.system.equipState)) {\r\n          equippedWeapons.push(i);\r\n        }\r\n      }\r\n      // Append to spells.\r\n      else if (i.type === 'spell') {\r\n        if (i.system.spellLevel != undefined) {\r\n          spells[i.system.spellLevel].push(i);\r\n        }\r\n      }\r\n    }\r\n\r\n    // Assign and return\r\n    context.gear = gear;\r\n    context.features = features;\r\n    context.spells = spells;\r\n    context.skillSections = this.updateObjectValueByKey(this.getSkillSectionDisplays(CONFIG.ABBREW.skillTypes, skills), this.skillSectionDisplay);\r\n    context.skills = skills;\r\n    context.anatomy = anatomy;\r\n    context.armour = armour;\r\n    context.weapons = weapons;\r\n    context.equippedWeapons = equippedWeapons;\r\n  }\r\n\r\n  skillSectionDisplay = {};\r\n\r\n  /* -------------------------------------------- */\r\n\r\n  getSkillSectionDisplays(skillTypes, skills) {\r\n    return Object.fromEntries(this.getSkillSectionKeys(skillTypes).map(s => { return { \"type\": s, \"display\": skills[s].length > 0 ? 'grid' : 'none' } }).map(x => [x.type, x.display]));\r\n  }\r\n\r\n  /* -------------------------------------------- */\r\n\r\n  updateObjectValueByKey = (obj1, obj2) => {\r\n    var destination = Object.assign({}, obj1);\r\n    Object.keys(obj2).forEach(k => {\r\n      if (k in destination && k in obj2) {\r\n        destination[k] = obj2[k];\r\n      }\r\n    });\r\n    return destination;\r\n  }\r\n\r\n  /* -------------------------------------------- */\r\n\r\n  getSkillSectionKeys(skillTypes) {\r\n    return Object.keys(skillTypes);\r\n  }\r\n\r\n  /* -------------------------------------------- */\r\n\r\n  _activateTraits(html) {\r\n    const traits = html[0].querySelector('input[name=\"system.traits\"]');\r\n    const traitsSettings = {\r\n      dropdown: {\r\n        maxItems: 20,               // <- mixumum allowed rendered suggestions\r\n        classname: \"tags-look\",     // <- custom classname for this dropdown, so it could be targeted\r\n        enabled: 0,                 // <- show suggestions on focus\r\n        closeOnSelect: false,       // <- do not hide the suggestions dropdown once an item has been selected\r\n        includeSelectedTags: true   // <- Should the suggestions list Include already-selected tags (after filtering)\r\n      },\r\n      userInput: false,             // <- Disable manually typing/pasting/editing tags (tags may only be added from the whitelist). Can also use the disabled attribute on the original input element. To update this after initialization use the setter tagify.userInput\r\n      duplicates: false,             // <- Should duplicate tags be allowed or not\r\n      // whitelist: [.../* Object.values( */CONFIG.ABBREW.traits/* ) */.map(trait => game.i18n.localize(trait.name))]\r\n      whitelist: [.../* Object.values( */CONFIG.ABBREW.traits/* ) */.map(trait => ({\r\n        ...trait,\r\n        value: game.i18n.localize(trait.value)\r\n      }))],\r\n    };\r\n    if (traits) {\r\n      var taggedTraits = new Tagify(traits, traitsSettings);\r\n    }\r\n  }\r\n\r\n  /* -------------------------------------------- */\r\n\r\n  _activateFatalWounds(html) {\r\n    const fatalWounds = html[0].querySelector('input[name=\"system.defense.fatalWounds\"]');\r\n    const fatalWoundsSettings = {\r\n      dropdown: {\r\n        maxItems: 20,               // <- mixumum allowed rendered suggestions\r\n        classname: \"tags-look\",     // <- custom classname for this dropdown, so it could be targeted\r\n        enabled: 0,                 // <- show suggestions on focus\r\n        closeOnSelect: false,       // <- do not hide the suggestions dropdown once an item has been selected\r\n        includeSelectedTags: true   // <- Should the suggestions list Include already-selected tags (after filtering)\r\n      },\r\n      userInput: false,             // <- Disable manually typing/pasting/editing tags (tags may only be added from the whitelist). Can also use the disabled attribute on the original input element. To update this after initialization use the setter tagify.userInput\r\n      duplicates: false,             // <- Should duplicate tags be allowed or not\r\n      whitelist: [...Object.values(CONFIG.ABBREW.wounds).map(wound => game.i18n.localize(wound.name))]\r\n    };\r\n    if (fatalWounds) {\r\n      var taggedFatalWounds = new Tagify(fatalWounds, fatalWoundsSettings);\r\n    }\r\n  }\r\n\r\n  /* -------------------------------------------- */\r\n\r\n  /** @override */\r\n  activateListeners(html) {\r\n    super.activateListeners(html);\r\n\r\n    // Render the item sheet for viewing/editing prior to the editable check.\r\n    html.on('click', '.item-edit', (ev) => {\r\n      const li = $(ev.currentTarget).parents('.item');\r\n      const item = this.actor.items.get(li.data('itemId'));\r\n      item.sheet.render(true);\r\n    });\r\n\r\n    // Render the skill sheet for viewing/editing prior to the editable check.\r\n    html.on('click', '.skill-edit', (ev) => {\r\n      const li = $(ev.currentTarget).parents('.skill');\r\n      const skill = this.actor.items.get(li.data('itemId'));\r\n      skill.sheet.render(true);\r\n    });\r\n\r\n    html.on('click', '.skill-activate', this._onSkillActivate.bind(this))\r\n\r\n    // -------------------------------------------------------------\r\n    // Everything below here is only needed if the sheet is editable\r\n    if (!this.isEditable) return;\r\n\r\n    // Add Inventory Item\r\n    html.on('click', '.item-create', this._onItemCreate.bind(this));\r\n\r\n    // Delete Inventory Item\r\n    html.on('click', '.item-delete', (ev) => {\r\n      const li = $(ev.currentTarget).parents('.item');\r\n      const item = this.actor.items.get(li.data('itemId'));\r\n      item.delete();\r\n      li.slideUp(200, () => this.render(false));\r\n    });\r\n\r\n    // Delete Skill Item\r\n    html.on('click', '.skill-delete', (ev) => {\r\n      const li = $(ev.currentTarget).parents('.skill');\r\n      const skill = this.actor.items.get(li.data('itemId'));\r\n      skill.delete();\r\n      li.slideUp(200, () => this.render(false));\r\n    });\r\n\r\n    // Active Effect management\r\n    html.on('click', '.effect-control', (ev) => {\r\n      const row = ev.currentTarget.closest('li');\r\n      const document =\r\n        row.dataset.parentId === this.actor.id\r\n          ? this.actor\r\n          : this.actor.items.get(row.dataset.parentId);\r\n      onManageActiveEffect(ev, document);\r\n    });\r\n\r\n    html.on('change', '.item-select', this._onItemChange.bind(this));\r\n\r\n    html.on('change', '.item input', this._onItemChange.bind(this));\r\n\r\n    // Rollable abilities.\r\n    html.on('click', '.rollable', this._onRoll.bind(this));\r\n\r\n    html.on('click', '.attack-damage-button', async (event) => {\r\n      const t = event.currentTarget;\r\n      await this._onAttackDamageAction(t, 'attack');\r\n    });\r\n\r\n    html.on('click', '.attack-feint-button', async (event) => {\r\n      const t = event.currentTarget;\r\n      await this._onAttackDamageAction(t, 'feint');\r\n    });\r\n\r\n    html.on('click', '.attack-overpower-button', async (event) => {\r\n      const t = event.currentTarget;\r\n      await this._onAttackDamageAction(t, 'overpower');\r\n    });\r\n\r\n    html.on('click', '.attack-finisher-button', async (event) => {\r\n      const t = event.currentTarget;\r\n      await this._onAttackDamageAction(t, 'finisher');\r\n    });\r\n\r\n    html.on('click', '.skill-header', this._onToggleSkillHeader.bind(this));\r\n\r\n    html.on('click', '.wound', this._onWoundClick.bind(this));\r\n\r\n    html.on('contextmenu', '.wound', this._onWoundRightClick.bind(this));\r\n\r\n    this._activateFatalWounds(html);\r\n    this._activateTraits(html);\r\n\r\n    // Drag events for macros.\r\n    if (this.actor.isOwner) {\r\n      let handler = (ev) => this._onDragStart(ev);\r\n      html.find('li.item').each((i, li) => {\r\n        if (li.classList.contains('inventory-header')) return;\r\n        li.setAttribute('draggable', true);\r\n        li.addEventListener('dragstart', handler, false);\r\n      });\r\n    }\r\n  }\r\n\r\n  async _onItemChange(event) {\r\n    const target = event.target;\r\n    const itemId = target.closest('.item').dataset.itemId;\r\n    const itemValuePath = target.name;\r\n    const item = this.actor.items.get(itemId);\r\n    const value = this._getItemInputValue(target);\r\n    const updates = {};\r\n    updates[itemValuePath] = value;\r\n    await item.update(updates);\r\n  }\r\n\r\n  _getItemInputValue(target) {\r\n    switch (target.type) {\r\n      case 'checkbox':\r\n        return target.checked;\r\n      default:\r\n        return target.value;\r\n    }\r\n  }\r\n\r\n  _onToggleSkillHeader(event) {\r\n    event.preventDefault();\r\n    const target = event.currentTarget;\r\n    const skillSection = target.nextElementSibling;\r\n    if (skillSection.children.length === 0 || skillSection.style.display === \"grid\" || skillSection.style.display === '') {\r\n      this.skillSectionDisplay[target.dataset.skillSection] = \"none\"\r\n      skillSection.style.display = \"none\";\r\n    } else {\r\n      this.skillSectionDisplay[target.dataset.skillSection] = \"grid\"\r\n      skillSection.style.display = \"grid\";\r\n    }\r\n  }\r\n\r\n  _onWoundClick(event) {\r\n    this.handleWoundClick(event, 1)\r\n  }\r\n\r\n  _onWoundRightClick(event) {\r\n    this.handleWoundClick(event, -1)\r\n  }\r\n\r\n  handleWoundClick(event, modification) {\r\n    const woundType = event.currentTarget.dataset.woundType;\r\n    updateActorWounds(this.actor, mergeActorWounds(this.actor, [{ type: woundType, value: modification }]));\r\n  }\r\n\r\n  async _onSkillActivate(event) {\r\n    event.preventDefault();\r\n    const target = event.target.closest('.skill');\r\n    const id = target.dataset.itemId;\r\n    const skill = this.actor.items.get(id);\r\n\r\n    await handleSkillActivate(this.actor, skill);\r\n  }\r\n\r\n  async _onAttackDamageAction(target, attackMode) {\r\n    const itemId = target.closest('li.item').dataset.itemId;\r\n    const attackProfileId = target.closest('li .attack-profile').dataset.attackProfileId;\r\n    const item = this.actor.items.get(itemId);\r\n    await item.handleAttackDamageAction(this.actor, attackProfileId, attackMode);\r\n  }\r\n\r\n  /**\r\n   * Handle creating a new Owned Item for the actor using initial data defined in the HTML dataset\r\n   * @param {Event} event   The originating click event\r\n   * @private\r\n   */\r\n  async _onItemCreate(event) {\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n    const header = event.currentTarget;\r\n    // Get the type of item to create.\r\n    const type = header.dataset.type;\r\n    // Grab any data associated with this control.\r\n    const data = foundry.utils.duplicate(header.dataset);\r\n    // Initialize a default name.\r\n    const name = `New ${type.capitalize()}`;\r\n    // Prepare the item object.\r\n    const itemData = {\r\n      name: name,\r\n      type: type,\r\n      system: data,\r\n    };\r\n    // Remove the type from the dataset since it's in the itemData.type prop.\r\n    delete itemData.system['type'];\r\n\r\n    // Finally, create the item!\r\n    return await Item.create(itemData, { parent: this.actor });\r\n  }\r\n\r\n  /**\r\n   * Handle clickable rolls.\r\n   * @param {Event} event   The originating click event\r\n   * @private\r\n   */\r\n  _onRoll(event) {\r\n    console.log('actor roll');\r\n    event.preventDefault();\r\n    const element = event.currentTarget;\r\n    const dataset = element.dataset;\r\n\r\n    // Handle item rolls.\r\n    if (dataset.rollType) {\r\n      if (dataset.rollType == 'item') {\r\n        const itemId = element.closest('.item').dataset.itemId;\r\n        const item = this.actor.items.get(itemId);\r\n        if (item) return item.roll();\r\n      }\r\n    }\r\n\r\n    // Handle rolls that supply the formula directly.\r\n    if (dataset.roll) {\r\n      let label = dataset.label ? `[attribute] ${dataset.label}` : '';\r\n      let roll = new Roll(dataset.roll, this.actor.getRollData());\r\n      roll.toMessage({\r\n        speaker: ChatMessage.getSpeaker({ actor: this.actor }),\r\n        flavor: label,\r\n        rollMode: game.settings.get('core', 'rollMode'),\r\n      });\r\n      return roll;\r\n    }\r\n  }\r\n}\r\n","import {\r\n  onManageActiveEffect,\r\n  prepareActiveEffectCategories,\r\n} from '../helpers/effects.mjs';\r\nimport Tagify from '@yaireo/tagify'\r\n\r\n/**\r\n * Extend the basic ItemSheet with some very simple modifications\r\n * @extends {ItemSheet}\r\n */\r\nexport class AbbrewItemSheet extends ItemSheet {\r\n  /** @override */\r\n  static get defaultOptions() {\r\n    return foundry.utils.mergeObject(super.defaultOptions, {\r\n      classes: ['abbrew', 'sheet', 'item'],\r\n      width: 520,\r\n      height: 480,\r\n      tabs: [\r\n        {\r\n          navSelector: '.sheet-tabs',\r\n          contentSelector: '.sheet-body',\r\n          initial: 'description',\r\n        },\r\n      ],\r\n    });\r\n  }\r\n\r\n  /** @override */\r\n  get template() {\r\n    const path = 'systems/abbrew/templates/item';\r\n    // Return a single sheet for all item types.\r\n    // return `${path}/item-sheet.hbs`;\r\n\r\n    // Alternatively, you could use the following return statement to do a\r\n    // unique item sheet by type, like `weapon-sheet.hbs`.\r\n    return `${path}/item-${this.item.type}-sheet.hbs`;\r\n  }\r\n\r\n  /* -------------------------------------------- */\r\n\r\n  /** @override */\r\n  async getData() {\r\n    // Retrieve base data structure.\r\n    const context = super.getData();\r\n\r\n    // Use a safe clone of the item data for further operations.\r\n    const itemData = context.data;\r\n\r\n    // Retrieve the roll data for TinyMCE editors.\r\n    context.rollData = this.item.getRollData();\r\n\r\n    // Add the item's data to context.data for easier access, as well as flags.\r\n    context.system = itemData.system;\r\n    context.actions = this.prepareActions(itemData.system);\r\n    context.flags = itemData.flags;\r\n\r\n    // Enrich description info for display\r\n    // Enrichment turns text like `[[/r 1d20]]` into buttons\r\n    context.enrichedDescription = await TextEditor.enrichHTML(\r\n      this.item.system.description,\r\n      {\r\n        // Whether to show secret blocks in the finished html\r\n        secrets: this.document.isOwner,\r\n        // Necessary in v11, can be removed in v12\r\n        async: true,\r\n        // Data to fill in for inline rolls\r\n        rollData: this.item.getRollData(),\r\n        // Relative UUID resolution\r\n        relativeTo: this.item,\r\n      }\r\n    );\r\n\r\n    // Prepare active effects for easier access\r\n    context.effects = prepareActiveEffectCategories(this.item.effects);\r\n\r\n    context.config = CONFIG.ABBREW;\r\n\r\n    return context;\r\n  }\r\n\r\n  /* -------------------------------------------- */\r\n\r\n  /** @override */\r\n  activateListeners(html) {\r\n    super.activateListeners(html);\r\n\r\n    // Everything below here is only needed if the sheet is editable\r\n    if (!this.isEditable) return;\r\n\r\n    // Roll handlers, click handlers, etc. would go here.\r\n\r\n    // Active Effect management\r\n    html.on('click', '.effect-control', (ev) =>\r\n      onManageActiveEffect(ev, this.item)\r\n    );\r\n\r\n    html.find(\".damage-reduction-control\").click(event => {\r\n      const t = event.currentTarget;\r\n      if (t.dataset.action) this._onDamageReductionAction(t, t.dataset.action);\r\n    });\r\n\r\n    html.find(\".damage-control\").click(event => {\r\n      const t = event.currentTarget;\r\n      if (t.dataset.action) this._onDamageAction(t, t.dataset.action);\r\n    });\r\n\r\n    html.find(\".attack-profile-control\").click(event => {\r\n      const t = event.currentTarget;\r\n      if (t.dataset.action) this._onAttackProfileAction(t, t.dataset.action);\r\n    });\r\n\r\n    this._activateArmourPoints(html);\r\n    this._activateAnatomyParts(html);\r\n  }\r\n\r\n  prepareActions(system) {\r\n    let actions = system.actions;\r\n\r\n    return actions;\r\n  }\r\n\r\n  _activateArmourPoints(html) {\r\n    const armourPoints = html[0].querySelector('input[name=\"system.armourPoints\"]');\r\n    const armourPointsSettings = {\r\n      dropdown: {\r\n        maxItems: 20,               // <- mixumum allowed rendered suggestions\r\n        classname: \"tags-look\",     // <- custom classname for this dropdown, so it could be targeted\r\n        enabled: 0,                 // <- show suggestions on focus\r\n        closeOnSelect: false,       // <- do not hide the suggestions dropdown once an item has been selected\r\n        includeSelectedTags: true   // <- Should the suggestions list Include already-selected tags (after filtering)\r\n      },\r\n      userInput: false,             // <- Disable manually typing/pasting/editing tags (tags may only be added from the whitelist). Can also use the disabled attribute on the original input element. To update this after initialization use the setter tagify.userInput\r\n      duplicates: true,             // <- Should duplicate tags be allowed or not\r\n      whitelist: [...Object.values(CONFIG.ABBREW.armourPoints.points).map(key => game.i18n.localize(key))]\r\n    };\r\n    if (armourPoints) {\r\n      var taggedArmourPoints = new Tagify(armourPoints, armourPointsSettings);\r\n    }\r\n  }\r\n\r\n  _activateAnatomyParts(html) {\r\n    const anatomyParts = html[0].querySelector('input[name=\"system.parts\"]');\r\n    const anatomyPartsSettings = {\r\n      dropdown: {\r\n        maxItems: 20,               // <- mixumum allowed rendered suggestions\r\n        classname: \"tags-look\",     // <- custom classname for this dropdown, so it could be targeted\r\n        enabled: 0,                 // <- show suggestions on focus\r\n        closeOnSelect: false,       // <- do not hide the suggestions dropdown once an item has been selected\r\n        includeSelectedTags: true   // <- Should the suggestions list Include already-selected tags (after filtering)\r\n      },\r\n      userInput: false,             // <- Disable manually typing/pasting/editing tags (tags may only be added from the whitelist). Can also use the disabled attribute on the original input element. To update this after initialization use the setter tagify.userInput\r\n      duplicates: true,             // <- Should duplicate tags be allowed or not\r\n      whitelist: [...Object.values(CONFIG.ABBREW.armourPoints.points).map(key => game.i18n.localize(key))]\r\n    };\r\n    if (anatomyParts) {\r\n      var taggedAnatomyParts = new Tagify(anatomyParts, anatomyPartsSettings);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle one of the add or remove damage reduction buttons.\r\n   * @param {Element} target  Button or context menu entry that triggered this action.\r\n   * @param {string} action   Action being triggered.\r\n   * @returns {Promise|void}\r\n   */\r\n  _onDamageReductionAction(target, action) {\r\n    switch (action) {\r\n      case 'add-damage-reduction':\r\n        return this.addDamageReduction();\r\n      case 'remove-damage-reduction':\r\n        return this.removeDamageReduction(target);\r\n        break;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle one of the add or remove damage reduction buttons.\r\n   * @param {Element} target  Button or context menu entry that triggered this action.\r\n   * @param {string} action   Action being triggered.\r\n   * @returns {Promise|void}\r\n   */\r\n  _onDamageAction(target, action) {\r\n    switch (action) {\r\n      case 'add-damage':\r\n        return this.addDamage(target);\r\n      case 'remove-damage':\r\n        return this.removeDamage(target);\r\n        break;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle one of the add or remove damage reduction buttons.\r\n   * @param {Element} target  Button or context menu entry that triggered this action.\r\n   * @param {string} action   Action being triggered.\r\n   * @returns {Promise|void}\r\n   */\r\n  _onAttackProfileAction(target, action) {\r\n    switch (action) {\r\n      case 'add-attack-profile':\r\n        return this.addAttackProfile();\r\n      case 'remove-attack-profile':\r\n        return this.removeAttackProfile(target);\r\n        break;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle one of the add or remove damage reduction buttons.\r\n   * @param {Element} target  Button or context menu entry that triggered this action.\r\n   * @param {string} action   Action being triggered.\r\n   * @returns {Promise|void}\r\n   */\r\n  _onSkillActionAction(target, action) {\r\n    if (this.item.system.configurable) {\r\n      switch (action) {\r\n        case 'add-skill-action':\r\n          return this.addSkillAction();\r\n        case 'remove-skill-action':\r\n          return this.removeSkillAction(target);\r\n          break;\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n    * Handle one of the add or remove damage reduction buttons.\r\n    * @param {Element} target  Button or context menu entry that triggered this action.\r\n    * @param {string} action   Action being triggered.\r\n    * @returns {Promise|void}\r\n    */\r\n  _onSkillActionResourceRequirementAction(target, action) {\r\n    if (this.item.system.configurable) {\r\n      switch (action) {\r\n        case 'add-skill-action-resource-requirement':\r\n          return this.addSkillActionResourceRequirement(target);\r\n        case 'remove-skill-action-resource-requirement':\r\n          return this.removeSkillActionResourceRequirement(target);\r\n          break;\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n    * Handle one of the add or remove damage reduction buttons.\r\n    * @param {Element} target  Button or context menu entry that triggered this action.\r\n    * @param {string} action   Action being triggered.\r\n    * @returns {Promise|void}\r\n    */\r\n  _onSkillActionModifierDamageAction(target, action) {\r\n    if (this.item.system.configurable) {\r\n      switch (action) {\r\n        case 'add-skill-action-modifier-damage':\r\n          return this.addSkillActionModifierDamage(target);\r\n        case 'remove-skill-action-modifier-damage':\r\n          return this.removeSkillActionModifierDamage(target);\r\n      }\r\n    }\r\n  }\r\n\r\n  addSkillActionModifierDamage(target) {\r\n    const actionId = target.closest(\".action\").dataset.id;\r\n    let actions = foundry.utils.deepClone(this.item.system.actions);\r\n    actions[actionId].modifiers.damage = [...actions[actionId].modifiers.damage, {}];\r\n    return this.item.update({ \"system.actions\": actions });\r\n\r\n  }\r\n\r\n  removeSkillActionModifierDamage(target) {\r\n    const id = target.closest(\"li\").dataset.id;\r\n    const actionId = target.closest(\".action\").dataset.id;\r\n    const actions = foundry.utils.deepClone(this.item.system.actions);\r\n    actions[actionId].modifiers.damage.splice(Number(id), 1);\r\n    return this.item.update({ \"system.actions\": actions });\r\n  }\r\n\r\n  addSkillActionResourceRequirement(target) {\r\n    const actionId = target.closest(\".action\").dataset.id;\r\n    let actions = foundry.utils.deepClone(this.item.system.actions);\r\n    actions[actionId].requirements.resources = [...actions[actionId].requirements.resources, {}];\r\n    return this.item.update({ \"system.actions\": actions });\r\n  }\r\n\r\n  removeSkillActionResourceRequirement(target) {\r\n    const id = target.closest(\"li\").dataset.id;\r\n    const actionId = target.closest(\".action\").dataset.id;\r\n    const actions = foundry.utils.deepClone(this.item.system.actions);\r\n    actions[actionId].requirements.resources.splice(Number(id), 1);\r\n    return this.item.update({ \"system.actions\": actions });\r\n  }\r\n\r\n  addSkillAction() {\r\n    const actions = this.item.system.actions;\r\n    return this.item.update({ \"system.actions\": [...actions, {}] });\r\n  }\r\n\r\n  removeSkillAction(target) {\r\n    const id = target.closest(\"li\").dataset.id;\r\n    const actions = foundry.utils.deepClone(this.item.system.actions);\r\n    actions.splice(Number(id), 1);\r\n    return this.item.update({ \"system.actions\": actions });\r\n  }\r\n\r\n  addAttackProfile() {\r\n    const attackProfiles = this.item.system.attackProfiles;\r\n    return this.item.update({ \"system.attackProfiles\": [...attackProfiles, {}] });\r\n  }\r\n\r\n  removeAttackProfile(target) {\r\n    const id = target.closest(\"li\").dataset.id;\r\n    const attackProfiles = foundry.utils.deepClone(this.item.system.attackProfiles);\r\n    attackProfiles.splice(Number(id), 1);\r\n    return this.item.update({ \"system.attackProfiles\": attackProfiles });\r\n  }\r\n\r\n  addDamageReduction() {\r\n    const protection = this.item.system.defense.protection;\r\n    return this.item.update({ \"system.defense.protection\": [...protection, {}] });\r\n  }\r\n\r\n  removeDamageReduction(target) {\r\n    const id = target.closest(\"li\").dataset.id;\r\n    const defense = foundry.utils.deepClone(this.item.system.defense);\r\n    defense.protection.splice(Number(id), 1);\r\n    return this.item.update({ \"system.defense.protection\": defense.protection });\r\n  }\r\n\r\n  addDamage(target) {\r\n    const attackProfileId = target.closest(\".attack-profile\").dataset.id;\r\n    const attackProfiles = foundry.utils.deepClone(this.item.system.attackProfiles);\r\n    const damage = attackProfiles[attackProfileId].damage;\r\n    attackProfiles[attackProfileId].damage = [...damage, {}];\r\n    return this.item.update({ \"system.attackProfiles\": attackProfiles });\r\n  }\r\n\r\n  removeDamage(target) {\r\n    const damageId = target.closest(\"li\").dataset.id;\r\n    const attackProfileId = target.closest(\".attack-profile\").dataset.id;\r\n    const attackProfiles = foundry.utils.deepClone(this.item.system.attackProfiles);\r\n    attackProfiles[attackProfileId].damage.splice(Number(damageId), 1);\r\n    return this.item.update({ \"system.attackProfiles\": attackProfiles });\r\n  }\r\n}\r\n","/**\r\n * Define a set of template paths to pre-load\r\n * Pre-loaded templates are compiled and cached for fast access when rendering\r\n * @return {Promise}\r\n */\r\nexport const preloadHandlebarsTemplates = async function () {\r\n  return loadTemplates([\r\n    // Actor partials.\r\n    'systems/abbrew/templates/actor/parts/actor-features.hbs',\r\n    'systems/abbrew/templates/actor/parts/actor-items.hbs',\r\n    'systems/abbrew/templates/actor/parts/actor-spells.hbs',\r\n    'systems/abbrew/templates/actor/parts/actor-effects.hbs',\r\n    'systems/abbrew/templates/actor/parts/actor-skills.hbs',\r\n    'systems/abbrew/templates/actor/parts/actor-anatomy.hbs',\r\n    'systems/abbrew/templates/actor/parts/actor-armour.hbs',\r\n    'systems/abbrew/templates/actor/parts/actor-weapons.hbs',\r\n    'systems/abbrew/templates/actor/parts/actor-defenses.hbs',\r\n    // Item partials.\r\n    'systems/abbrew/templates/item/parts/item-effects.hbs',\r\n    'systems/abbrew/templates/item/parts/item-defenses.hbs',\r\n    'systems/abbrew/templates/item/parts/item-damage.hbs',\r\n    'systems/abbrew/templates/item/parts/item-equipstate.hbs',\r\n    // Skill partials.\r\n    'systems/abbrew/templates/item/parts/skill-type.hbs',\r\n    'systems/abbrew/templates/item/parts/skill-actions.hbs',\r\n    'systems/abbrew/templates/item/parts/skill-damage.hbs',\r\n    // Chat Cards.\r\n    'systems/abbrew/templates/chat/skill-card.hbs',\r\n    'systems/abbrew/templates/chat/finisher-card.hbs',\r\n    'systems/abbrew/templates/chat/lost-resolve-card.hbs',\r\n    'systems/abbrew/templates/chat/attack-result-card.hbs'\r\n  ]);\r\n};\r\n","// Namespace Configuration Values\r\nexport const ABBREW = {};\r\n\r\nABBREW.durations = {\r\n  instant: { label: \"ABBREW.Durations.instant\", value: 0 },\r\n  second: { label: \"ABBREW.Durations.second\", value: 1 },\r\n  turn: { label: \"ABBREW.Durations.turn\", value: 0.01 },\r\n  round: { label: \"ABBREW.Durations.round\", value: 6 },\r\n  minute: { label: \"ABBREW.Durations.minute\", value: 60 },\r\n  hour: { label: \"ABBREW.Durations.hour\", value: 3600 },\r\n  day: { label: \"ABBREW.Durations.day\", value: 86400 },\r\n  permanent: { label: \"ABBREW.Durations.permanent\", value: -1 }\r\n}\r\n\r\nABBREW.durationsLabels = {\r\n  instant: \"ABBREW.Durations.instant\",\r\n  second: \"ABBREW.Durations.second\",\r\n  turn: \"ABBREW.Durations.turn\",\r\n  round: \"ABBREW.Durations.round\",\r\n  minute: \"ABBREW.Durations.minute\",\r\n  hour: \"ABBREW.Durations.hour\",\r\n  day: \"ABBREW.Durations.day\"\r\n}\r\n\r\n/**\r\n * The set of Attribute Scores used within the system.\r\n * @type {Object}\r\n */\r\nABBREW.attributes = {\r\n  str: 'ABBREW.Attribute.Str.long',\r\n  dex: 'ABBREW.Attribute.Dex.long',\r\n  agi: 'ABBREW.Attribute.Agi.long',\r\n  con: 'ABBREW.Attribute.Con.long',\r\n  int: 'ABBREW.Attribute.Int.long',\r\n  wit: 'ABBREW.Attribute.Wit.long',\r\n  vis: 'ABBREW.Attribute.Vis.long',\r\n  wil: 'ABBREW.Attribute.Wil.long',\r\n};\r\n\r\nABBREW.attributeAbbreviations = {\r\n  str: 'ABBREW.Attribute.Str.abbr',\r\n  dex: 'ABBREW.Attribute.Dex.abbr',\r\n  agi: 'ABBREW.Attribute.Agi.abbr',\r\n  con: 'ABBREW.Attribute.Con.abbr',\r\n  int: 'ABBREW.Attribute.Int.abbr',\r\n  wis: 'ABBREW.Attribute.Wis.abbr',\r\n  cha: 'ABBREW.Attribute.Cha.abbr',\r\n  vis: 'ABBREW.Attribute.Vis.abbr',\r\n  wil: 'ABBREW.Attribute.Wil.abbr',\r\n};\r\n\r\nABBREW.HasRequirement = \"ABBREW.HasRequirement\";\r\nABBREW.SkillAttributeIncrease = \"ABBREW.AttributeIncrease\";\r\nABBREW.skillActivationType = \"ABBREW.SkillActivationType\";\r\nABBREW.skillActivationTypes = {\r\n  standalone: 'ABBREW.SkillActivationTypes.standalone',\r\n  synergy: 'ABBREW.SkillActivationTypes.synergy',\r\n  stackRemoval: 'ABBREW.SkillActivationTypes.stackRemoval'\r\n}\r\nABBREW.EquippedWeapon = \"ABBREW.EquippedWeapon\";\r\nABBREW.Damage = \"ABBREW.Damage\";\r\nABBREW.operator = \"ABBREW.Operator\"\r\nABBREW.operators = {\r\n  equal: \"ABBREW.Operators.equal\",\r\n  add: \"ABBREW.Operators.add\",\r\n  minus: \"ABBREW.Operators.minus\",\r\n}\r\n\r\nABBREW.Defense = {\r\n  guard: 'ABBREW.Defense.guard'\r\n}\r\n\r\nABBREW.armourPoints = {\r\n  label: \"ABBREW.ArmourPoints.label\",\r\n  points: {\r\n    head: \"ABBREW.ArmourPoints.Points.head\",\r\n    torso: \"ABBREW.ArmourPoints.Points.torso\",\r\n    arm: \"ABBREW.ArmourPoints.Points.arm\",\r\n    leg: \"ABBREW.ArmourPoints.Points.leg\",\r\n    tail: \"ABBREW.ArmourPoints.Points.tail\",\r\n    wing: \"ABBREW.ArmourPoints.Points.wing\"\r\n  }\r\n}\r\n\r\nABBREW.concepts = {\r\n  physical: 'ABBREW.Concepts.physical',\r\n  crushing: 'ABBREW.Resistances.crushing',\r\n  piercing: 'ABBREW.Resistances.piercing',\r\n  slashing: 'ABBREW.Resistances.slashing'\r\n}\r\n\r\nABBREW.facing = {\r\n  front: \"ABBREW.Facing.front\",\r\n  left: \"ABBREW.Facing.left\",\r\n  right: \"ABBREW.Facing.right\",\r\n  back: \"ABBREW.Facing.back\",\r\n}\r\n\r\nABBREW.attackTypes = {\r\n  arc: \"ABBREW.AttackTypes.arc\",\r\n  thrust: \"ABBREW.AttackTypes.thrust\",\r\n  static: \"ABBREW.AttackTypes.static\"\r\n}\r\n\r\nABBREW.equipState = {\r\n  held1H: \"ABBREW.EquipState.heldOne\",\r\n  held2H: \"ABBREW.EquipState.heldTwo\",\r\n  worn: \"ABBREW.EquipState.worn\",\r\n  stowed: \"ABBREW.EquipState.stowed\",\r\n  dropped: \"ABBREW.EquipState.dropped\"\r\n}\r\n\r\nABBREW.wornEquipState = {\r\n  worn: \"ABBREW.EquipState.worn\",\r\n  stowed: \"ABBREW.EquipState.stowed\",\r\n  dropped: \"ABBREW.EquipState.dropped\"\r\n}\r\n\r\nABBREW.skillTypes = {\r\n  basic: \"ABBREW.SkillTypes.basic\",\r\n  path: \"ABBREW.SkillTypes.path\",\r\n  resource: \"ABBREW.SkillTypes.resource\",\r\n  temporary: \"ABBREW.SkillTypes.temporary\",\r\n  untyped: \"ABBREW.SkillTypes.untyped\",\r\n  background: \"ABBREW.SkillTypes.background\"\r\n}\r\n\r\nABBREW.actionCosts = {\r\n  passive: \"ABBREW.ActionCosts.passive\",\r\n  one: \"ABBREW.ActionCosts.one\",\r\n  two: \"ABBREW.ActionCosts.two\",\r\n  three: \"ABBREW.ActionCosts.three\",\r\n  reaction: \"ABBREW.ActionCosts.reaction\",\r\n  other: \"ABBREW.ActionCosts.other\"\r\n}\r\n\r\nABBREW.wounds = {\r\n  physical: {\r\n    name: \"ABBREW.Wounds.physical\",\r\n    lingeringWounds: [],\r\n    concepts: [\"physical\"]\r\n  },\r\n  bleed: {\r\n    name: \"ABBREW.Wounds.bleed\",\r\n    lingeringWounds: [\"vital\"],\r\n    concepts: [\"life\"]\r\n  },\r\n  vital: {\r\n    name: \"ABBREW.Wounds.vital\",\r\n    lingeringWounds: [],\r\n    concepts: [\"life\"]\r\n  },\r\n  burning: {\r\n    name: \"ABBREW.Wounds.burning\",\r\n    lingeringWounds: [\"burn\"],\r\n    concepts: [\"fire\"]\r\n  },\r\n  burn: {\r\n    name: \"ABBREW.Wounds.burn\",\r\n    lingeringWounds: [],\r\n    concepts: [\"fire\"]\r\n  },\r\n  fatigue: {\r\n    name: \"ABBREW.Wounds.fatigue\",\r\n    lingeringWounds: [\"exhaustion\"],\r\n    concepts: []\r\n  },\r\n  exhaustion: {\r\n    name: \"ABBREW.Wounds.exhaustion\",\r\n    lingeringWounds: [],\r\n    concepts: []\r\n  },\r\n  dread: {\r\n    name: \"ABBREW.Wounds.dread\",\r\n    lingeringWounds: [\"terror\"],\r\n    concepts: [\"fear\"]\r\n  },\r\n  terror: {\r\n    name: \"ABBREW.Wounds.terror\",\r\n    lingeringWounds: [],\r\n    concepts: [\"fear\"]\r\n  },\r\n  enraged: {\r\n    name: \"ABBREW.Wounds.enraged\",\r\n    lingeringWounds: [\"rage\"],\r\n    concepts: [\"emotion\"]\r\n  },\r\n  rage: {\r\n    name: \"ABBREW.Wounds.rage\",\r\n    lingeringWounds: [],\r\n    concepts: [\"emotion\"]\r\n  },\r\n  instability: {\r\n    name: \"ABBREW.Wounds.instability\",\r\n    lingeringWounds: [\"mutation\"],\r\n    concepts: [\"mutation\"]\r\n  },\r\n  mutation: {\r\n    name: \"ABBREW.Wounds.mutation\",\r\n    lingeringWounds: [],\r\n    concepts: [\"mutation\"]\r\n  },\r\n  sin: {\r\n    name: \"ABBREW.Wounds.sin\",\r\n    lingeringWounds: [\"corruption\"],\r\n    concepts: [\"corruption\"]\r\n  },\r\n  corruption: {\r\n    name: \"ABBREW.Wounds.corruption\",\r\n    lingeringWounds: [],\r\n    concepts: [\"corruption\"]\r\n  }\r\n}\r\n\r\nABBREW.conditions = {\r\n  dead: {\r\n    name: \"ABBREW.EFFECT.Condition.Dead.name\",\r\n    img: \"systems/abbrew/assets/icons/statuses/dead.svg\",\r\n    description: \"ABBREW.EFFECT.Condition.Dead.description\",\r\n    statuses: ['dead', 'defeated']\r\n  },\r\n  defeated: {\r\n    name: \"ABBREW.EFFECT.Condition.Defeated.name\",\r\n    img: \"systems/abbrew/assets/icons/statuses/defeated.svg\",\r\n    description: \"ABBREW.EFFECT.Condition.Defeated.description\",\r\n    statuses: ['defeated']\r\n  },\r\n  disoriented: {\r\n    name: \"ABBREW.EFFECT.Condition.disoriented.name\",\r\n    img: \"systems/abbrew/assets/icons/statuses/disoriented.svg\",\r\n    description: \"ABBREW.EFFECT.Condition.Disoriented.description\",\r\n    statuses: ['disoriented']\r\n  },\r\n  guardBreak: {\r\n    name: \"ABBREW.EFFECT.Condition.GuardBreak.name\",\r\n    img: \"systems/abbrew/assets/icons/statuses/guardBreak.svg\",\r\n    description: \"ABBREW.EFFECT.Condition.GuardBreak.description\",\r\n    statuses: ['offGuard']\r\n  },\r\n  offGuard: {\r\n    name: \"ABBREW.EFFECT.Condition.OffGuard.name\",\r\n    img: \"systems/abbrew/assets/icons/statuses/offGuard.svg\",\r\n    description: \"ABBREW.EFFECT.Condition.OffGuard.description\",\r\n    statuses: ['offGuard']\r\n  }\r\n}\r\n\r\nABBREW.statusEffects = {\r\n  dead: {\r\n    name: \"ABBREW.EFFECT.Status.dead\",\r\n    img: \"systems/abbrew/assets/icons/statuses/dead.svg\",\r\n    description: \"You have suffered fatal wounds, resulting in death.\",\r\n    order: 2,\r\n    statuses: ['defeated']\r\n  },\r\n  defeated: {\r\n    name: \"ABBREW.EFFECT.Status.defeated\",\r\n    img: \"systems/abbrew/assets/icons/statuses/defeated.svg\",\r\n    description: \"You resolve buckles as you are unable to continue the fight.\",\r\n    special: \"DEFEATED\",\r\n    order: 1\r\n  },\r\n  disoriented: {\r\n    name: \"ABBREW.EFFECT.Status.disoriented\",\r\n    img: \"systems/abbrew/assets/icons/statuses/disoriented.svg\",\r\n    description: \"You have been disoriented, you cannot restore guard nor parry while you have this condition.\"\r\n  },\r\n  guardBreak: {\r\n    name: \"ABBREW.EFFECT.Status.guardBreak\",\r\n    img: \"systems/abbrew/assets/icons/statuses/guardBreak.svg\",\r\n    description: \"Your guard is broken, your foes can directly capitalise on your weakpoints. You can be targeted by finishers.\"\r\n  },\r\n  offGuard: {\r\n    name: \"ABBREW.EFFECT.Status.offGuard\",\r\n    img: \"systems/abbrew/assets/icons/statuses/offGuard.svg\",\r\n    description: \"Your are harried and your guard compromised, your foes can directly capitalise on your weakpoints. You can be targeted by finishers.\"\r\n  }\r\n}\r\n\r\nABBREW.equipTypes = {\r\n  none: \"ABBREW.EquipTypes.none\",\r\n  held: \"ABBREW.EquipTypes.held\",\r\n  worn: \"ABBREW.EquipTypes.worn\"\r\n}\r\n\r\nABBREW.hands = {\r\n  none: {\r\n    label: \"ABBREW.Hands.none\",\r\n    states: []\r\n  },\r\n  oneHand: {\r\n    label: \"ABBREW.Hands.oneHand\",\r\n    states: [\"held1H\"]\r\n  },\r\n  versatile: {\r\n    label: \"ABBREW.Hands.versatile\",\r\n    states: [\"held2H\", \"held1H\"]\r\n  },\r\n  twoHand: {\r\n    label: \"ABBREW.Hands.twoHand\",\r\n    states: [\"held2H\"]\r\n  }\r\n}\r\n\r\nconst lingeringWoundImmunities = [\r\n  { key: \"bleedImmunity\", value: \"ABBREW.Traits.WoundImmunities.bleedImmunity\", feature: \"wound\", subFeature: \"lingeringWound\", effect: \"immunity\", data: \"bleed\" },\r\n  { key: \"burningImmunity\", value: \"ABBREW.Traits.WoundImmunities.burningImmunity\", feature: \"wound\", subFeature: \"lingeringWound\", effect: \"immunity\", data: \"burning\" },\r\n  { key: \"fatigueImmunity\", value: \"ABBREW.Traits.WoundImmunities.fatigueImmunity\", feature: \"wound\", subFeature: \"lingeringWound\", effect: \"immunity\", data: \"fatigue\" },\r\n  { key: \"dreadImmunity\", value: \"ABBREW.Traits.WoundImmunities.dreadImmunity\", feature: \"wound\", subFeature: \"lingeringWound\", effect: \"immunity\", data: \"dread\" },\r\n  { key: \"enragedImmunity\", value: \"ABBREW.Traits.WoundImmunities.enragedImmunity\", feature: \"wound\", subFeature: \"lingeringWound\", effect: \"immunity\", data: \"enraged\" },\r\n  { key: \"instabilityImmunity\", value: \"ABBREW.Traits.WoundImmunities.instabilityImmunity\", feature: \"wound\", subFeature: \"lingeringWound\", effect: \"immunity\", data: \"instability\" },\r\n  { key: \"sinImmunity\", value: \"ABBREW.Traits.WoundImmunities.sinImmunity\", feature: \"wound\", subFeature: \"lingeringWound\", effect: \"immunity\", data: \"sin\" }\r\n]\r\n\r\nconst skillTraining = [\r\n  { key: \"attackBaseTraining\", value: \"ABBREW.Traits.SkillTraining.attackBase\", feature: \"skillTraining\", subFeature: \"offensiveSkills\", effect: \"base\", data: \"attack\" },\r\n  { key: \"finisherBaseTraining\", value: \"ABBREW.Traits.SkillTraining.finisherBase\", feature: \"skillTraining\", subFeature: \"offensiveSkills\", effect: \"base\", data: \"finisher\" },\r\n  { key: \"feintBaseTraining\", value: \"ABBREW.Traits.SkillTraining.feintBase\", feature: \"skillTraining\", subFeature: \"offensiveSkills\", effect: \"base\", data: \"feint\" },\r\n  { key: \"parryBaseTraining\", value: \"ABBREW.Traits.SkillTraining.parryBase\", feature: \"skillTraining\", subFeature: \"defensiveSkills\", effect: \"base\", data: \"parry\" },\r\n  { key: \"overpowerBaseTraining\", value: \"ABBREW.Traits.SkillTraining.overpowerBase\", feature: \"skillTraining\", subFeature: \"offensiveSkills\", effect: \"base\", data: \"overpower\" },\r\n  { key: \"attackTraining\", value: \"ABBREW.Traits.SkillTraining.attack\", feature: \"skillTraining\", subFeature: \"offensiveSkills\", effect: \"increase\", data: \"attack\" },\r\n  { key: \"finisherTraining\", value: \"ABBREW.Traits.SkillTraining.finisher\", feature: \"skillTraining\", subFeature: \"offensiveSkills\", effect: \"increase\", data: \"finisher\" },\r\n  { key: \"overpowerTraining\", value: \"ABBREW.Traits.SkillTraining.overpower\", feature: \"skillTraining\", subFeature: \"offensiveSkills\", effect: \"increase\", data: \"overpower\" },\r\n  { key: \"feintTraining\", value: \"ABBREW.Traits.SkillTraining.feint\", feature: \"skillTraining\", subFeature: \"offensiveSkills\", effect: \"increase\", data: \"feint\" },\r\n  { key: \"parryTraining\", value: \"ABBREW.Traits.SkillTraining.parry\", feature: \"skillTraining\", subFeature: \"defensiveSkills\", effect: \"increase\", data: \"parry\" },\r\n  { key: \"feintCounterTraining\", value: \"ABBREW.Traits.SkillTraining.feintCounter\", feature: \"skillTraining\", subFeature: \"offensiveSkills\", effect: \"increase\", data: \"feintCounter\" },\r\n  { key: \"parryCounterTraining\", value: \"ABBREW.Traits.SkillTraining.parryCounter\", feature: \"skillTraining\", subFeature: \"defensiveSkills\", effect: \"increase\", data: \"parryCounter\" }\r\n]\r\n\r\nABBREW.traits = [\r\n  ...lingeringWoundImmunities,\r\n  ...skillTraining,\r\n]\r\n\r\nABBREW.attackModes = {\r\n  \"attack\": \"ABBREW.AttackModes.attack\",\r\n  \"feint\": \"ABBREW.AttackModes.feint\",\r\n  \"overpower\": \"ABBREW.AttackModes.overpower\"\r\n}\r\n\r\nABBREW.proxiedSkills = {\r\n  \"attack\": \"Attack\",\r\n  \"parry\": \"Parry\",\r\n  \"feint\": \"Feint\",\r\n  \"overpower\": \"Overpower\",\r\n  \"finisher\": \"Finisher\"\r\n}\r\n\r\nABBREW.modify = {\r\n  \"all\": \"Modify All\",\r\n  \"one\": \"Modify One\",\r\n  \"add\": \"Add\",\r\n  \"skip\": \"Skip\"\r\n}","import { getSafeJson } from \"../helpers/utils.mjs\";\r\n\r\nexport default class AbbrewActorBase extends foundry.abstract.TypeDataModel {\r\n\r\n  get traitsData() {\r\n    return this.traits !== \"\" ? JSON.parse(this.traits) : [];\r\n  }\r\n\r\n  get heldArmourGuard() {\r\n    return this.parent.getActorHeldItems().filter(i => i.type === 'armour').reduce((result, a) => result += a.system.defense.guard, 0);\r\n  }\r\n\r\n  static defineSchema() {\r\n    const fields = foundry.data.fields;\r\n    const requiredInteger = { required: true, nullable: false, integer: true };\r\n    const blankString = { required: true, blank: true }\r\n    const schema = {};\r\n\r\n    schema.traits = new fields.StringField({ required: true, blank: true });\r\n    schema.actions = new fields.NumberField({ ...requiredInteger, initial: 0, min: 0, max: 5 })\r\n    schema.wounds = new fields.ArrayField(\r\n      new fields.SchemaField({\r\n        type: new fields.StringField({ required: true }),\r\n        value: new fields.NumberField({ ...requiredInteger, initial: 0, max: 100 })\r\n      })\r\n    );\r\n    schema.activeSkills = new fields.ArrayField(\r\n      new fields.StringField({ required: true, blank: true })\r\n    );\r\n    schema.queuedSkills = new fields.ArrayField(\r\n      new fields.StringField({ required: true, blank: true })\r\n    );\r\n    schema.defense = new fields.SchemaField({\r\n      guard: new fields.SchemaField({\r\n        value: new fields.NumberField({ ...requiredInteger, initial: 0, min: 0 }),\r\n        base: new fields.NumberField({ ...requiredInteger, initial: 0, min: 0 }),\r\n        max: new fields.NumberField({ ...requiredInteger, initial: 0, min: 0 }),\r\n        label: new fields.StringField({ required: true, blank: true }),\r\n\r\n      }),\r\n      protection: new fields.ArrayField(\r\n        new fields.SchemaField({\r\n          type: new fields.StringField({ required: true, blank: true }),\r\n          value: new fields.NumberField({ ...requiredInteger, initial: 0, min: 0 }),\r\n          resistance: new fields.NumberField({ ...requiredInteger, initial: 0, min: 0 }),\r\n          weakness: new fields.NumberField({ ...requiredInteger, initial: 0, min: 0 }),\r\n          immunity: new fields.NumberField({ ...requiredInteger, initial: 0, min: 0 }),\r\n          label: new fields.StringField({ required: true, blank: true })\r\n        })\r\n      ),\r\n      inflexibility: new fields.SchemaField({\r\n        raw: new fields.NumberField({ ...requiredInteger, initial: 0, min: 0 }),\r\n        max: new fields.NumberField({ ...requiredInteger, initial: 10, min: 10, max: 10 }),\r\n        resistance: new fields.SchemaField({\r\n          raw: new fields.NumberField({ ...requiredInteger, initial: 0, min: 0 }),\r\n          value: new fields.NumberField({ ...requiredInteger, initial: 0, min: 0 }),\r\n        })\r\n      }),\r\n      risk: new fields.SchemaField({\r\n        raw: new fields.NumberField({ ...requiredInteger, initial: 0, min: 0, max: 100 }),\r\n        value: new fields.NumberField({ ...requiredInteger, initial: 0, min: 0, max: 10 }),\r\n        max: new fields.NumberField({ ...requiredInteger, initial: 10, min: 10, max: 10 })\r\n      }),\r\n      resolve: new fields.SchemaField({\r\n        value: new fields.NumberField({ ...requiredInteger, initial: 0, min: 0, max: 20 }),\r\n        base: new fields.NumberField({ ...requiredInteger, initial: 0, min: 0, max: 20 }),\r\n        max: new fields.NumberField({ ...requiredInteger, initial: 0, min: 0, max: 20 }),\r\n        label: new fields.StringField({ required: true, blank: true })\r\n      }),\r\n      fatalWounds: new fields.StringField({ required: true, blank: true })\r\n    });\r\n\r\n    schema.biography = new fields.StringField({ required: true, blank: true });\r\n\r\n    schema.movement = new fields.SchemaField({\r\n      baseSpeed: new fields.NumberField({ ...requiredInteger, initial: 0, min: 0 }),\r\n    });\r\n\r\n    schema.meta = new fields.SchemaField({\r\n      tier: new fields.SchemaField({\r\n        value: new fields.NumberField({ ...requiredInteger, initial: 1, min: 0, max: 10 })\r\n      })\r\n    });\r\n\r\n    schema.proxiedSkills = new fields.SchemaField({\r\n      attack: new fields.StringField({ ...blankString }),\r\n      parry: new fields.StringField({ ...blankString }),\r\n      feint: new fields.StringField({ ...blankString }),\r\n      overpower: new fields.StringField({ ...blankString }),\r\n      finisher: new fields.StringField({ ...blankString })\r\n    });\r\n\r\n    schema.skillTraining = new fields.ArrayField(\r\n      new fields.SchemaField({\r\n        type: new fields.StringField({ ...blankString }),\r\n        value: new fields.NumberField({ ...requiredInteger })\r\n      })\r\n    )\r\n\r\n    // Iterate over attribute names and create a new SchemaField for each.\r\n    schema.attributes = new fields.SchemaField(Object.keys(CONFIG.ABBREW.attributes).reduce((obj, attribute) => {\r\n      obj[attribute] = new fields.SchemaField({\r\n        value: new fields.NumberField({ ...requiredInteger, initial: 0, min: 0, max: 9 }),\r\n        tier: new fields.NumberField({ ...requiredInteger, initial: 1, min: 1 }),\r\n        rank: new fields.NumberField({ ...requiredInteger, initial: 0, min: 0 }),\r\n        label: new fields.StringField({ required: true, blank: true })\r\n      });\r\n      return obj;\r\n    }, {}));\r\n\r\n    schema.momentum = new fields.NumberField({ ...requiredInteger, initial: 0 });\r\n\r\n    return schema;\r\n  }\r\n\r\n\r\n  // Prior to Active Effects\r\n  prepareBaseData() {\r\n    // Loop through attribute scores, and determine their base rank.\r\n    for (const key in this.attributes) {\r\n      this.attributes[key].value = 0 + this.parent.items.filter(i => i.type === 'skill' && i.system.skillType === 'background' && i.system.attributeIncrease === key).length;\r\n      this.attributes[key].rank = this.attributes[key].value;\r\n    }\r\n\r\n    this.defense.risk.value = Math.floor(this.defense.risk.raw / 10);\r\n\r\n    this.defense.resolve.max = 2 + Math.floor((this._getMaxFromPhysicalAttributes() + this._getMaxFromMentalAttributes()) / 2);\r\n\r\n    this.skillTraining = ([\r\n      { type: \"attack\", value: 0 },\r\n      { type: \"overpower\", value: 0 },\r\n      { type: \"parry\", value: 0 },\r\n      { type: \"feint\", value: 0 },\r\n      { type: \"finisher\", value: 0 },\r\n      { type: \"parryCounter\", value: 0 },\r\n      { type: \"feintCounter\", value: 0 }\r\n    ])\r\n  }\r\n\r\n  _getMaxFromPhysicalAttributes() {\r\n    return this._getMaxFromAttributes(['str', 'con', 'dex', 'agi']);\r\n  }\r\n\r\n  _getMaxFromMentalAttributes() {\r\n    return this._getMaxFromAttributes(['int', 'wil', 'vis', 'wit']);\r\n  }\r\n\r\n  _getMaxFromAttributes(attributes) {\r\n    return Object.keys(this.attributes).filter(a => attributes.includes(a)).reduce((result, attribute) => Math.max(result, this.attributes[attribute].value), 0);\r\n  }\r\n\r\n  // Post Active Effects\r\n  prepareDerivedData() {\r\n    // Loop through attribute scores, and add their modifiers to our sheet output.\r\n    for (const key in this.attributes) {\r\n      const rankBonus = this.attributes[key].rank;\r\n      // Handle attribute label localization.\r\n      this.attributes[key].label = game.i18n.localize(CONFIG.ABBREW.attributes[key]) ?? key;\r\n      // // Rank total for the attribute\r\n      this.attributes[key].rank = rankBonus + this.parent.items.filter(i => i.type === 'skill' && i.system.skillType === 'path' && i.system.attributeRankIncrease === key).length;\r\n      // Tier of the attribute\r\n      this.attributes[key].tier = 1 + Math.floor(this.attributes[key].rank / 10);\r\n    }\r\n\r\n    for (const key in this.defense.damageTypes) {\r\n      // Handle damage type label localization.\r\n      // this.defense.damageTypes[key].label = game.i18n.localize(CONFIG.ABBREW.damageTypes[key]) ?? key;\r\n    }\r\n\r\n    const anatomy = this._prepareAnatomy();\r\n\r\n    this._prepareMovement(anatomy);\r\n\r\n    this._prepareDefenses();\r\n\r\n    this._prepareResolve();\r\n\r\n    Object.keys(this.proxiedSkills).forEach(ps => {\r\n      const item = this.parent.items.find(i => i.name.toLowerCase() === ps);\r\n      this.proxiedSkills[ps] = item?._id;\r\n    });\r\n\r\n    const skillTraining = this.parent.items.filter(i => i.type === \"skill\").filter(s => s.system.skillTraits).flatMap(s => getSafeJson(s.system.skillTraits, []).filter(st => st.feature === \"skillTraining\").map(st => st.data)).reduce((result, st) => { if (st in result) { result[st] += 1; } else { result[st] = 1; } return result; }, {});\r\n    const mappedTraining = Object.entries(skillTraining).map(e => ({ type: e[0], value: e[1] }));\r\n    this.skillTraining = foundry.utils.mergeObject(this.skillTraining, mappedTraining);\r\n\r\n  }\r\n\r\n  _prepareAnatomy() {\r\n    const res = this.parent.items.filter(i => i.type == 'anatomy').reduce((result, a) => {\r\n      const values = a.system;\r\n      result.hands += values.hands;\r\n      result.speed += values.speed;\r\n      result.parts = result.parts.concat(JSON.parse(values.parts).map(a => a.value));\r\n      return result;\r\n    }, { hands: 0, speed: 0, parts: [] });\r\n    return res;\r\n  }\r\n\r\n  _prepareMovement(anatomy) {\r\n    this.movement.baseSpeed = this.attributes.agi.value * anatomy.speed;\r\n  }\r\n\r\n  _prepareDefenses() {\r\n    const armour = this.parent.items.filter(i => i.type === 'armour');\r\n    const anatomy = this.parent.items.filter(i => i.type === 'anatomy');\r\n    const wornArmour = this._getAppliedArmour(armour);\r\n    this._prepareDamageReduction(wornArmour, anatomy);\r\n    this._prepareGuard(wornArmour, anatomy);\r\n    this._prepareInflexibility(wornArmour);\r\n  }\r\n\r\n  _getAppliedArmour(armour) {\r\n    const wornArmour = armour.filter(a => ['worn', 'none'].includes(a.system.equipState)).filter(a => a.system.equipState === 'worn');\r\n    const heldArmour = armour.filter(a => a.system.equipType === 'held').filter(a => a.system.equipState.startsWith('held'));\r\n    return [...wornArmour, ...heldArmour];\r\n  }\r\n\r\n  _prepareResolve() {\r\n    const currentResolve = this.defense.resolve.value;\r\n    if (currentResolve > this.defense.resolve.max) {\r\n      this.defense.resolve.value = this.defense.resolve.max;\r\n    }\r\n  }\r\n\r\n  _prepareDamageReduction(wornArmour, anatomy) {\r\n    const armour = wornArmour.filter(a => !a.system.isSundered);\r\n    const armourProtection = armour.map(a => a.system.defense.protection).flat(1);\r\n    const anatomyProtection = anatomy.map(a => a.system.defense.protection).flat(1);\r\n    const protection = [...armourProtection, ...anatomyProtection];\r\n\r\n    const flatDR = protection.reduce((result, dr) => {\r\n      const drType = dr.type;\r\n      if (Object.keys(result).includes(drType)) {\r\n        result[drType].value += dr.value;\r\n        result[drType].resistance += dr.resistance;\r\n        result[drType].immunity += dr.immunity;\r\n        result[drType].weakness += dr.weakness;\r\n      }\r\n      else {\r\n        result[drType] = { type: dr.type, value: dr.value, resistance: dr.resistance, immunity: dr.immunity, weakness: dr.weakness, label: dr.label };\r\n      }\r\n      return result;\r\n    }, {}\r\n    );\r\n\r\n    this.defense.protection.length = 0;\r\n    Object.values(flatDR).map(v => this.defense.protection.push(v));\r\n  }\r\n\r\n  _prepareGuard(wornArmour, anatomy) {\r\n    const armour = wornArmour.filter(a => !a.system.isSundered);\r\n    this.defense.guard.base = this.attributes['wit'].value;\r\n    // Handle damage type label localization.\r\n    this.defense.guard.label = game.i18n.localize(CONFIG.ABBREW.Defense.guard) ?? key;\r\n\r\n    const guardBonus = armour.map(a => a.system.defense.guard).reduce((a, b) => a + b, 0);\r\n    this.defense.guard.max = this.defense.guard.base + guardBonus;\r\n\r\n    if (this.defense.guard.value > this.defense.guard.max) {\r\n      this.defense.guard.value = this.defense.guard.max;\r\n    }\r\n  }\r\n\r\n  _prepareInflexibility(wornArmour) {\r\n    const armour = wornArmour.filter(a => !a.system.isSundered);\r\n    const armourInflexibility = armour.map(a => a.system.defense.inflexibility).reduce((a, b) => a + b, 0);\r\n    const wornArmourInflexibility = wornArmour.map(a => a.system.defense.inflexibility).reduce((a, b) => a + b, 0);\r\n    const weapons = this.parent.items.filter(i => i.type === 'weapon').filter(a => a.system.equipType === 'held').filter(a => a.system.equipState.startsWith('held'));\r\n    const otherInflexibility = Math.max(0, weapons.reduce((result, w) => result += (w.system.weapon.size * 2), 0) - this.attributes['str'].value);\r\n    this.defense.inflexibility.resistance.raw = armourInflexibility;\r\n    this.defense.inflexibility.raw = Math.floor((0 + wornArmourInflexibility + otherInflexibility) / 2); // TODO: - weapon drills as \"Shield Training\" is handled\r\n    this.defense.inflexibility.resistance.value = Math.floor(armourInflexibility / 10);\r\n  }\r\n\r\n  getRollData() {\r\n    let data = {};\r\n\r\n    // Copy the attribute scores to the top level, so that rolls can use\r\n    // formulas like `@str.mod + 4`.\r\n    if (this.attributes) {\r\n      for (let [k, v] of Object.entries(this.attributes)) {\r\n        data[k] = foundry.utils.deepClone(v);\r\n      }\r\n    }\r\n\r\n    data.tier = this.meta.tier.value;\r\n\r\n    return data\r\n  }\r\n}","import AbbrewActorBase from \"./actor-base.mjs\";\r\n\r\nexport default class AbbrewCharacter extends AbbrewActorBase {\r\n\r\n  static defineSchema() {\r\n    const fields = foundry.data.fields;\r\n    const requiredInteger = { required: true, nullable: false, integer: true };\r\n    const schema = super.defineSchema();\r\n\r\n    return schema;\r\n  }\r\n\r\n  // Prior to Active Effects\r\n  prepareBaseData() {\r\n    super.prepareBaseData();\r\n  }\r\n\r\n  // Post Active Effects\r\n  prepareDerivedData() {\r\n    super.prepareDerivedData();\r\n  }\r\n\r\n  getRollData() {\r\n    const data = super.getRollData();\r\n\r\n    return data;\r\n  }\r\n}","import AbbrewActorBase from \"./actor-base.mjs\";\n\nexport default class AbbrewNPC extends AbbrewActorBase {\n\n  static defineSchema() {\n    const fields = foundry.data.fields;\n    const requiredInteger = { required: true, nullable: false, integer: true };\n    const schema = super.defineSchema();\n\n    schema.cr = new fields.NumberField({ ...requiredInteger, initial: 1, min: 0 });\n    schema.xp = new fields.NumberField({ ...requiredInteger, initial: 0, min: 0 });\n    \n    return schema\n  }\n\n  prepareDerivedData() {\n    this.xp = this.cr * this.cr * 100;\n  }\n}","export default class AbbrewItemBase extends foundry.abstract.TypeDataModel {\r\n\r\n  static defineSchema() {\r\n    const schema = {};\r\n\r\n    const fields = foundry.data.fields;\r\n\r\n    schema.description = new fields.StringField({ required: true, blank: true });\r\n    schema.traits = new fields.StringField({ required: true, blank: true });\r\n    schema.abbrewId = new fields.StringField({ required: true, blank: true });\r\n\r\n    return schema;\r\n  }\r\n\r\n  // Prior to Active Effects\r\n  prepareBaseData() {\r\n    if (this.abbrewId === \"\") {\r\n      this.abbrewId = this.generateAbbrewId();\r\n    }\r\n  }\r\n\r\n  // Post Active Effects\r\n  prepareDerivedData() {\r\n  }\r\n\r\n  /**\r\n * Migrate source data from some prior format into a new specification.\r\n * The source parameter is either original data retrieved from disk or provided by an update operation.\r\n * @inheritDoc\r\n */\r\n  static migrateData(source) {\r\n    return super.migrateData(source);\r\n  }\r\n\r\n  generateAbbrewId() {\r\n    return `abbrew.${this.parent.type}.${this.parent.name.toLowerCase().replace(/\\s/g, '')}.${this.parent._id}`\r\n  }\r\n}","import AbbrewItemBase from \"./item-base.mjs\";\r\n\r\nexport default class AbbrewItem extends AbbrewItemBase {\r\n\r\n  static defineSchema() {\r\n    const fields = foundry.data.fields;\r\n    const requiredInteger = { required: true, nullable: false, integer: true };\r\n    const schema = super.defineSchema();\r\n\r\n    // Pull to physical?\r\n    schema.quantity = new fields.NumberField({ ...requiredInteger, initial: 1, min: 1 });\r\n    schema.weight = new fields.NumberField({ required: true, nullable: false, initial: 0, min: 0 });\r\n\r\n    // Break down roll formula into three independent fields\r\n    schema.roll = new fields.SchemaField({\r\n      diceNum: new fields.NumberField({ ...requiredInteger, initial: 1, min: 1 }),\r\n      diceSize: new fields.StringField({ initial: \"d20\" }),\r\n      diceBonus: new fields.StringField({ initial: \"+@str.mod+ceil(@lvl / 2)\" })\r\n    })\r\n\r\n    schema.formula = new fields.StringField({ blank: true });\r\n\r\n    return schema;\r\n  }\r\n\r\n  prepareDerivedData() {\r\n    // Build the formula dynamically using string interpolation\r\n    const roll = this.roll;\r\n\r\n    this.formula = `${roll.diceNum}${roll.diceSize}${roll.diceBonus}`\r\n  }\r\n}","import { getNumericParts } from '../helpers/utils.mjs';\r\nimport AbbrewItemBase from './item-base.mjs'\r\n\r\nexport default class AbbrewPhysicalItem extends AbbrewItemBase {\r\n\r\n    static defineSchema() {\r\n        const schema = super.defineSchema();\r\n        const fields = foundry.data.fields;\r\n        const requiredInteger = { required: true, nullable: false, integer: true };\r\n\r\n        schema.equipType = new fields.StringField({ required: true, blank: true });\r\n        schema.armourPoints = new fields.StringField({ required: true, blank: true });\r\n        schema.handsRequired = new fields.StringField({ required: true, blank: true });\r\n        schema.equipState = new fields.StringField({ required: true, blank: false, initial: 'stowed' });\r\n        schema.handsSupplied = new fields.NumberField({ ...requiredInteger, initial: 0 });\r\n        schema.actionCost = new fields.NumberField({ ...requiredInteger, initial: 0 });\r\n        schema.exertActionCost = new fields.NumberField({ ...requiredInteger, initial: 0 });\r\n        schema.validEquipStates = new fields.ArrayField(\r\n            new fields.SchemaField({\r\n                label: new fields.StringField({ required: true, blank: true }),\r\n                value: new fields.StringField({ required: true, blank: true }),\r\n            })\r\n        );\r\n\r\n        return schema;\r\n    }\r\n\r\n\r\n\r\n\r\n    // Prior to Active Effects\r\n    prepareBaseData() {\r\n        switch (this.equipType) {\r\n            case \"none\":\r\n                this.clearHeldDetails();\r\n                this.clearWornDetails();\r\n                break;\r\n            case \"held\":\r\n                this.clearWornDetails();\r\n                break;\r\n            case \"worn\":\r\n                this.clearHeldDetails();\r\n                break;\r\n        }\r\n\r\n        const baseEquipStates = Object.entries(CONFIG.ABBREW.wornEquipState).map(s => ({ value: s[0], label: s[1] }));\r\n        const validHands = CONFIG.ABBREW.hands[this.handsRequired]?.states ?? [];\r\n        const additionalEquipStates = validHands.map(s => ({ value: s, label: CONFIG.ABBREW.equipState[s] }))\r\n        this.validEquipStates = [...additionalEquipStates, ...baseEquipStates];\r\n        this.handsSupplied = getNumericParts(this.equipState);\r\n        this.actionCost = 0 + this.handsSupplied ?? 1;\r\n        this.exertActionCost = 1 + this.handsSupplied ?? 2;\r\n    }\r\n\r\n    clearHeldDetails() {\r\n        this.hands = 0;\r\n    }\r\n\r\n    clearWornDetails() {\r\n        this.armourPoints = \"[]\";\r\n    }\r\n\r\n    // Post Active Effects\r\n    prepareDerivedData() {\r\n    }\r\n\r\n    /**\r\n   * Migrate source data from some prior format into a new specification.\r\n   * The source parameter is either original data retrieved from disk or provided by an update operation.\r\n   * @inheritDoc\r\n   */\r\n    static migrateData(source) {\r\n        return super.migrateData(source);\r\n    }\r\n}","import AbbrewItemBase from \"./item-base.mjs\";\n\nexport default class AbbrewFeature extends AbbrewItemBase {}","import AbbrewItemBase from \"./item-base.mjs\";\n\nexport default class AbbrewSpell extends AbbrewItemBase {\n\n  static defineSchema() {\n    const fields = foundry.data.fields;\n    const schema = super.defineSchema();\n\n    schema.spellLevel = new fields.NumberField({ required: true, nullable: false, integer: true, initial: 1, min: 1, max: 9 });\n\n    return schema;\n  }\n}","import AbbrewItemBase from \"./item-base.mjs\";\r\n\r\nexport default class AbbrewSkill extends AbbrewItemBase {\r\n\r\n    static defineSchema() {\r\n        const fields = foundry.data.fields;\r\n        const schema = super.defineSchema();\r\n        const blankString = { required: true, blank: true }\r\n        const requiredInteger = { required: true, nullable: false, integer: true };\r\n\r\n        schema.skillTraits = new fields.StringField({ ...blankString });\r\n        schema.skillModifiers = new fields.SchemaField({\r\n            synergy: new fields.StringField({ ...blankString }),\r\n            discord: new fields.StringField({ ...blankString })\r\n        });\r\n        schema.configurable = new fields.BooleanField({ required: true });\r\n        schema.isActivatable = new fields.BooleanField({ required: true, label: \"ABBREW.IsActivatable\" });\r\n        schema.skills = new fields.ArrayField(\r\n            new fields.SchemaField({\r\n                name: new fields.StringField({ required: true, blank: true }),\r\n                skillType: new fields.StringField({ required: true, blank: true }),\r\n                id: new fields.StringField({ required: true, blank: true }),\r\n                image: new fields.StringField({ required: true, blank: true }),\r\n                sourceId: new fields.StringField({ required: true, blank: true })\r\n            })\r\n        );\r\n        schema.action = new fields.SchemaField({\r\n            activationType: new fields.StringField({ ...blankString }),\r\n            actionCost: new fields.StringField({ ...blankString }),\r\n            actionImage: new fields.StringField({ ...blankString }),\r\n            duration: new fields.SchemaField({\r\n                precision: new fields.StringField({ ...blankString }),\r\n                value: new fields.NumberField({ ...requiredInteger, initial: 0 }),\r\n            }),\r\n            uses: new fields.SchemaField({\r\n                hasUses: new fields.BooleanField({ required: true, initial: false }),\r\n                value: new fields.NumberField({ ...requiredInteger, initial: 0 }),\r\n                max: new fields.NumberField({ ...requiredInteger, initial: 0 }),\r\n                period: new fields.StringField({ ...blankString })\r\n            }),\r\n            charges: new fields.SchemaField({\r\n                hasCharges: new fields.BooleanField({ required: true, initial: false }),\r\n                value: new fields.NumberField({ ...requiredInteger, initial: 0 }),\r\n                max: new fields.NumberField({ ...requiredInteger, initial: 0 })\r\n            }),\r\n            isActive: new fields.BooleanField({ required: true }),\r\n            attackProfile: new fields.SchemaField({\r\n                name: new fields.StringField({ required: true, blank: true }),\r\n                attackType: new fields.StringField({ required: true, blank: true }),\r\n                lethal: new fields.NumberField({ ...requiredInteger, initial: 0 }),\r\n                critical: new fields.NumberField({ ...requiredInteger, initial: 10, min: 5 }),\r\n                handsSupplied: new fields.NumberField({ ...requiredInteger, min: 0, max: 2, nullable: true }),\r\n                attackMode: new fields.StringField({ required: true, blank: true }),\r\n                damage: new fields.ArrayField(\r\n                    new fields.SchemaField({\r\n                        type: new fields.StringField({ required: true, blank: true }),\r\n                        value: new fields.NumberField({ ...requiredInteger, initial: 0, min: 0 }),\r\n                        attributeModifier: new fields.StringField({ required: true, blank: true }),\r\n                        attributeMultiplier: new fields.NumberField({ ...requiredInteger, initial: 1, min: 0 }),\r\n                        damageMultiplier: new fields.NumberField({ ...requiredInteger, initial: 1, min: 0 }),\r\n                        overallMultiplier: new fields.NumberField({ ...requiredInteger, initial: 1, min: 0 }),\r\n                    })\r\n                ),\r\n                finisherLimit: new fields.NumberField({ ...requiredInteger, initial: 10, min: 1 })\r\n            }),\r\n            modifiers: new fields.SchemaField({\r\n                fortune: new fields.NumberField({ ...requiredInteger, initial: 0 }),\r\n                actionCost: new fields.SchemaField({\r\n                    value: new fields.NumberField({ ...requiredInteger, initial: 0 }),\r\n                    operator: new fields.StringField({ ...blankString }),\r\n                }),\r\n                attackProfile: new fields.SchemaField({\r\n                    attackType: new fields.StringField({ required: true, blank: true }),\r\n                    attackMode: new fields.StringField({ required: true, blank: true }),\r\n                    handsSupplied: new fields.NumberField({ ...requiredInteger, min: 0, max: 2, nullable: true }),\r\n                    finisherLimit: new fields.SchemaField({\r\n                        value: new fields.NumberField({ ...requiredInteger, nullable: true }),\r\n                        operator: new fields.StringField({ required: true, blank: true })\r\n                    }),\r\n                    lethal: new fields.SchemaField({\r\n                        value: new fields.NumberField({ ...requiredInteger, initial: 0, nullable: true }),\r\n                        operator: new fields.StringField({ required: true, blank: true })\r\n                    }),\r\n                    critical: new fields.SchemaField({\r\n                        value: new fields.NumberField({ ...requiredInteger, initial: 10, nullable: true }),\r\n                        operator: new fields.StringField({ required: true, blank: true })\r\n                    }),\r\n                    damage: new fields.ArrayField(\r\n                        new fields.SchemaField({\r\n                            modify: new fields.StringField({ required: true, blank: true }),\r\n                            type: new fields.StringField({ required: true, blank: true, nullable: true }),\r\n                            value: new fields.NumberField({ ...requiredInteger, nullable: true, nullable: true }),\r\n                            attributeModifier: new fields.StringField({ required: true, blank: true, nullable: true }),\r\n                            attributeMultiplier: new fields.NumberField({ ...requiredInteger, initial: 1, min: 0 }),\r\n                            damageMultiplier: new fields.NumberField({ ...requiredInteger, initial: 1, min: 0 }),\r\n                            overallMultiplier: new fields.NumberField({ ...requiredInteger, initial: 1, min: 0 })\r\n                        })\r\n                    )\r\n                }),\r\n                guard: new fields.SchemaField({\r\n                    self: new fields.SchemaField({\r\n                        value: new fields.StringField({ ...blankString }),\r\n                        operator: new fields.StringField({ ...blankString })\r\n                    }),\r\n                    target: new fields.SchemaField({\r\n                        value: new fields.StringField({ ...blankString }),\r\n                        operator: new fields.StringField({ ...blankString })\r\n                    })\r\n                }),\r\n                risk: new fields.SchemaField({\r\n                    self: new fields.SchemaField({\r\n                        value: new fields.NumberField({ ...requiredInteger, initial: 0 }),\r\n                        operator: new fields.StringField({ ...blankString })\r\n                    }),\r\n                    target: new fields.SchemaField({\r\n                        value: new fields.NumberField({ ...requiredInteger, initial: 0 }),\r\n                        operator: new fields.StringField({ ...blankString })\r\n                    })\r\n                }),\r\n                wounds: new fields.SchemaField({\r\n                    self: new fields.ArrayField(\r\n                        new fields.SchemaField({\r\n                            type: new fields.StringField({ ...blankString }),\r\n                            value: new fields.NumberField({ ...requiredInteger, initial: 0 }),\r\n                            // TODO: Should be Increase/Suppress/Reduce\r\n                            operator: new fields.StringField({ ...blankString })\r\n                        })\r\n                    ),\r\n                    target: new fields.ArrayField(\r\n                        new fields.SchemaField({\r\n                            type: new fields.StringField({ ...blankString }),\r\n                            value: new fields.NumberField({ ...requiredInteger, initial: 0 }),\r\n                            operator: new fields.StringField({ ...blankString })\r\n                        })\r\n                    )\r\n                }),\r\n                resolve: new fields.SchemaField({\r\n                    self: new fields.SchemaField({\r\n                        value: new fields.NumberField({ ...requiredInteger, initial: 0 }),\r\n                        operator: new fields.StringField({ ...blankString })\r\n                    }),\r\n                    target: new fields.SchemaField({\r\n                        value: new fields.NumberField({ ...requiredInteger, initial: 0 }),\r\n                        operator: new fields.StringField({ ...blankString })\r\n                    })\r\n                }),\r\n                resources: new fields.SchemaField({\r\n                    self: new fields.ArrayField(\r\n                        new fields.SchemaField({\r\n                            name: new fields.StringField({ ...blankString }),\r\n                            value: new fields.NumberField({ ...requiredInteger, initial: 0 }),\r\n                            operator: new fields.StringField({ ...blankString }),\r\n                        })\r\n                    ),\r\n                    target: new fields.ArrayField(\r\n                        new fields.SchemaField({\r\n                            name: new fields.StringField({ ...blankString }),\r\n                            value: new fields.NumberField({ ...requiredInteger, initial: 0 }),\r\n                            operator: new fields.StringField({ ...blankString }),\r\n                        })\r\n                    ),\r\n                }),\r\n                concepts: new fields.SchemaField({\r\n                    self: new fields.ArrayField(\r\n                        new fields.SchemaField({\r\n                            type: new fields.StringField({ ...blankString }),\r\n                            value: new fields.NumberField({ ...requiredInteger, initial: 0 }),\r\n                            comparator: new fields.StringField({ ...blankString }),\r\n                            operator: new fields.StringField({ ...blankString })\r\n                        })\r\n                    ),\r\n                    target: new fields.ArrayField(\r\n                        new fields.SchemaField({\r\n                            type: new fields.StringField({ ...blankString }),\r\n                            value: new fields.NumberField({ ...requiredInteger, initial: 0 }),\r\n                            comparator: new fields.StringField({ ...blankString }),\r\n                            operator: new fields.StringField({ ...blankString })\r\n                        })\r\n                    )\r\n                })\r\n            })\r\n        });\r\n        schema.skillType = new fields.StringField({ ...blankString });\r\n        schema.path = new fields.SchemaField({\r\n            value: new fields.StringField({ ...blankString }),\r\n            archetype: new fields.StringField({ ...blankString })\r\n        });\r\n        schema.attributeIncrease = new fields.StringField({ ...blankString });\r\n        schema.attributeIncreaseLong = new fields.StringField({ ...blankString });\r\n        schema.attributeRankIncrease = new fields.StringField({ ...blankString });\r\n\r\n        return schema;\r\n    }\r\n\r\n    prepareBaseData() {\r\n        super.prepareBaseData();\r\n        if (this.isActivatable) {\r\n            this.action.actionCostOperator = \"\";\r\n        }\r\n    }\r\n\r\n    // Post Active Effects\r\n    prepareDerivedData() {\r\n        if (this.attributeIncrease) {\r\n            this.attributeIncreaseLong = game.i18n.localize(CONFIG.ABBREW.attributes[this.attributeIncrease]);\r\n        }\r\n\r\n        if (this.action.actionCost) {\r\n            this.action.actionImage = this.getActionImageName(this.action.actionCost);\r\n        }\r\n\r\n        if (this.parent) {\r\n            const queuedSkills = this.parent?.parent?.system?.queuedSkills ?? [];\r\n            const activeSkills = this.parent?.parent?.system?.activeSkills ?? [];\r\n            const id = this.parent?._id ?? null;\r\n            this.action.isActive = queuedSkills.includes(id) || activeSkills.includes(id);\r\n        }\r\n    }\r\n\r\n    getActionImageName(cost) {\r\n        if (cost === \"0\" || cost > 5) {\r\n            return \"fa\";\r\n        }\r\n\r\n        return \"\" + cost + \"a\";\r\n    }\r\n}","export default class AbbrewRevealedItem {\r\n    static addRevealedItemSchema(schema) {\r\n        const fields = foundry.data.fields;\r\n        const requiredInteger = { required: true, nullable: false, integer: true };\r\n\r\n        schema.revealed = new fields.SchemaField({\r\n            isRevealed: new fields.BooleanField({}),\r\n            difficulty: new fields.NumberField({ ...requiredInteger, initial: 0, min: 0 }),\r\n            tier: new fields.NumberField({ ...requiredInteger, initial: 0, min: 0, max: 10 })\r\n        });\r\n    }\r\n}","import AbbrewPhysicalItem from \"./item-physical.mjs\";\r\nimport AbbrewRevealedItem from \"./revealedItem.mjs\";\r\n\r\nexport default class AbbrewArmour extends AbbrewPhysicalItem {\r\n\r\n    static defineSchema() {\r\n        const schema = super.defineSchema();\r\n        const fields = foundry.data.fields;\r\n\r\n        this.addDefenseSchema(schema);\r\n        AbbrewRevealedItem.addRevealedItemSchema(schema);\r\n        schema.isSundered = new fields.BooleanField({ required: true, nullable: false, initial: false })\r\n\r\n        return schema;\r\n    }\r\n\r\n    static addDefenseSchema(schema) {\r\n        const fields = foundry.data.fields;\r\n        const requiredInteger = { required: true, nullable: false, integer: true };\r\n\r\n        schema.defense = new fields.SchemaField({\r\n            guard: new fields.NumberField({ ...requiredInteger, initial: 0, min: 0 }),\r\n            inflexibility: new fields.NumberField({ ...requiredInteger, initial: 0, min: 0 }),\r\n            protection: new fields.ArrayField(\r\n                new fields.SchemaField({\r\n                    type: new fields.StringField({ required: true, blank: true }),\r\n                    value: new fields.NumberField({ ...requiredInteger, initial: 0, min: 0 }),\r\n                    resistance: new fields.NumberField({ ...requiredInteger, initial: 0, min: 0 }),\r\n                    weakness: new fields.NumberField({ ...requiredInteger, initial: 0, min: 0 }),\r\n                    immunity: new fields.NumberField({ ...requiredInteger, initial: 0, min: 0 }),\r\n                    label: new fields.StringField({ required: true, blank: true })\r\n                })\r\n            )\r\n        });\r\n    }\r\n\r\n    prepareDerivedData() {\r\n        // Build the formula dynamically using string interpolation\r\n        const roll = this.roll;\r\n\r\n        // this.formula = `${roll.diceNum}${roll.diceSize}${roll.diceBonus}`\r\n    }\r\n}","import AbbrewPhysicalItem from \"./item-physical.mjs\";\r\nimport AbbrewArmour from \"./armour.mjs\";\r\nimport AbbrewRevealedItem from './revealedItem.mjs'\r\n\r\nexport default class AbbrewAnatomy extends AbbrewPhysicalItem {\r\n\r\n  static defineSchema() {\r\n    const fields = foundry.data.fields;\r\n    const requiredInteger = { required: true, nullable: false, integer: true };\r\n    const schema = super.defineSchema();\r\n\r\n    schema.parts = new fields.StringField({ required: true, blank: true });\r\n    // TODO: Discount broken limbs but keep them in anatomy\r\n    schema.isBroken = new fields.BooleanField({ required: true, nullable: false, initial: false });\r\n    // TODO: Discount dismembered limbs and removed them from anatomy but include them in items (set to dropped?)\r\n    schema.isDismembered = new fields.BooleanField({ required: true, nullable: false, initial: false });\r\n    schema.hands = new fields.NumberField({ ...requiredInteger, initial: 0, min: 0 });\r\n    schema.speed = new fields.NumberField({ ...requiredInteger, initial: 0, min: 0 });\r\n    AbbrewRevealedItem.addRevealedItemSchema(schema);\r\n    AbbrewArmour.addDefenseSchema(schema);\r\n    schema.naturalWeapons = new fields.ArrayField(\r\n      new fields.SchemaField({\r\n        name: new fields.StringField({ required: true, blank: true }),\r\n        id: new fields.StringField({ required: true, blank: true }),\r\n        image: new fields.StringField({ required: true, blank: true })\r\n      })\r\n    );\r\n\r\n    return schema;\r\n  }\r\n\r\n  // TODO: Add revealed button\r\n  // TODO: NPC sheet and player view that shows revealed armour / anatomy\r\n  prepareDerivedData() {\r\n    // Build the formula dynamically using string interpolation\r\n    const roll = this.roll;\r\n\r\n    // this.formula = `${roll.diceNum}${roll.diceSize}${roll.diceBonus}`\r\n  }\r\n}","export default class AbbrewAttackBase extends foundry.abstract.TypeDataModel {\r\n\r\n    static defineSchema() {\r\n        const schema = super.defineSchema();\r\n\r\n        AbbrewAttackBase.addAttackSchema(schema);\r\n\r\n        return schema;\r\n    }\r\n\r\n    static addAttackSchema(schema) {\r\n        const fields = foundry.data.fields;\r\n        const requiredInteger = { required: true, nullable: false, integer: true };\r\n\r\n        schema.attackProfiles = new fields.ArrayField(\r\n            new fields.SchemaField({\r\n                name: new fields.StringField({ required: true, blank: true }),\r\n                attackType: new fields.StringField({ required: true, blank: true }),\r\n                lethal: new fields.NumberField({ ...requiredInteger, initial: 0 }),\r\n                critical: new fields.NumberField({ ...requiredInteger, initial: 10, min: 5 }),\r\n                damage: new fields.ArrayField(\r\n                    new fields.SchemaField({\r\n                        type: new fields.StringField({ required: true, blank: true }),\r\n                        value: new fields.NumberField({ ...requiredInteger, initial: 0, min: 0 }),\r\n                        attributeModifier: new fields.StringField({ required: true, blank: true }),\r\n                        attributeMultiplier: new fields.NumberField({ ...requiredInteger, initial: 1, min: 0 }),\r\n                        damageMultiplier: new fields.NumberField({ ...requiredInteger, initial: 1, min: 0 }),\r\n                        overallMultiplier: new fields.NumberField({ ...requiredInteger, initial: 1, min: 0 })\r\n                    })\r\n                ),\r\n                finisherLimit: new fields.NumberField({ ...requiredInteger, initial: 10, min: 1 }),\r\n                hasStrongAttack: new fields.BooleanField({ required: true, nullable: false, initial: true })\r\n            })\r\n        );\r\n    }\r\n\r\n    prepareDerivedData() { }\r\n}","import AbbrewAttackBase from \"./attack-base.mjs\";\r\nimport AbbrewPhysicalItem from \"./item-physical.mjs\";\r\n\r\nexport default class AbbrewWeapon extends AbbrewPhysicalItem {\r\n\r\n  static defineSchema() {\r\n    const schema = super.defineSchema();\r\n\r\n    AbbrewWeapon.addWeaponSchema(schema);\r\n\r\n    return schema;\r\n  }\r\n\r\n  static addWeaponSchema(schema) {\r\n    const fields = foundry.data.fields;\r\n    const requiredInteger = { required: true, nullable: false, integer: true };\r\n\r\n    schema.weapon = new fields.SchemaField({\r\n      size: new fields.NumberField({ ...requiredInteger, initial: 0, min: 0, max: 9 })\r\n    });\r\n    schema.isAttackTrained = new fields.BooleanField({ required: true, nullable: false, initial: false });\r\n    schema.isFinisherTrained = new fields.BooleanField({ required: true, nullable: false, initial: false });\r\n    schema.isFeintTrained = new fields.BooleanField({ required: true, nullable: false, initial: false });\r\n    schema.isOverpowerTrained = new fields.BooleanField({ required: true, nullable: false, initial: false });\r\n\r\n    AbbrewAttackBase.addAttackSchema(schema);\r\n  }\r\n\r\n  // Prior to Active Effects\r\n  prepareBaseData() {\r\n    super.prepareBaseData();\r\n  }\r\n\r\n\r\n  // Post Active Effects\r\n  prepareDerivedData() {\r\n    this.isAttackTrained = this.doesParentActorHaveSkillTrait(\"skillTraining\", \"offensiveSkills\", \"base\", \"attack\") ?? false;\r\n    this.isFinisherTrained = this.doesParentActorHaveSkillTrait(\"skillTraining\", \"offensiveSkills\", \"base\", \"finisher\") ?? false;\r\n    this.isFeintTrained = this.doesParentActorHaveSkillTrait(\"skillTraining\", \"offensiveSkills\", \"base\", \"feint\") ?? false;\r\n    this.isOverpowerTrained = this.doesParentActorHaveSkillTrait(\"skillTraining\", \"offensiveSkills\", \"base\", \"overpower\") ?? false;\r\n  }\r\n\r\n  doesParentActorHaveSkillTrait(feature, subFeature, effect, data) {\r\n    return this?.parent?.actor?.doesActorHaveSkillTrait(feature, subFeature, effect, data) ?? false;\r\n  }\r\n}\r\n","import AbbrewItemBase from \"./item-base.mjs\";\r\n\r\nexport default class AbbrewWound extends AbbrewItemBase {\r\n\r\n    static defineSchema() {\r\n        const fields = foundry.data.fields;\r\n        const schema = super.defineSchema();\r\n        const blankString = { required: true, blank: true }\r\n        const requiredInteger = { required: true, nullable: false, integer: true };\r\n\r\n        schema.wound = new fields.SchemaField({\r\n            type: new fields.StringField({ ...blankString }),\r\n            value: new fields.NumberField({ ...requiredInteger, initial: 0 })\r\n        });\r\n\r\n        return schema;\r\n    }\r\n}","import AbbrewItemBase from \"../item-base.mjs\";\r\n\r\nexport default class AbbrewSkillDeck extends AbbrewItemBase {\r\n\r\n    static defineSchema() {\r\n        const fields = foundry.data.fields;\r\n        const schema = super.defineSchema();\r\n\r\n        schema.skills = new fields.ArrayField(\r\n            new fields.SchemaField({\r\n                name: new fields.StringField({ required: true, blank: true }),\r\n                skillType: new fields.StringField({ required: true, blank: true }),\r\n                id: new fields.StringField({ required: true, blank: true }),\r\n                image: new fields.StringField({ required: true, blank: true }),\r\n                sourceId: new fields.StringField({ required: true, blank: true })\r\n            })\r\n        );\r\n\r\n        return schema;\r\n    }\r\n\r\n    // Post Active Effects\r\n    prepareDerivedData() {\r\n        super.prepareDerivedData();\r\n    }\r\n}","export function addAttributesToSchema(schema) {\r\n    const fields = foundry.data.fields;\r\n    const requiredInteger = { required: true, nullable: false, integer: true };\r\n\r\n    schema.attributes = new fields.SchemaField(Object.keys(CONFIG.ABBREW.attributes).reduce((obj, attribute) => {\r\n        obj[attribute] = new fields.SchemaField({\r\n            value: new fields.NumberField({ ...requiredInteger, initial: 0, min: 0, max: 2 }),\r\n            label: new fields.StringField({ required: true, blank: true }),\r\n            isEnabled: new fields.BooleanField({ required: true, nullable: false, initial: false })\r\n        });\r\n        return obj;\r\n    }, {}));\r\n}\r\n\r\nexport function prepareDerivedAttributeData(obj) {\r\n    // Loop through attribute scores, and add their modifiers to our sheet output.\r\n    for (const key in obj.attributes) {\r\n        // Handle attribute label localization.\r\n        obj.attributes[key].label = game.i18n.localize(CONFIG.ABBREW.attributes[key]) ?? key;\r\n    }\r\n}","import AbbrewSkillDeck from \"./skill-deck.mjs\";\r\nimport { addAttributesToSchema, prepareDerivedAttributeData } from \"./utilities/attribute-increase-skill.mjs\";\r\n\r\nexport default class AbbrewBackground extends AbbrewSkillDeck {\r\n\r\n    static defineSchema() {\r\n        const fields = foundry.data.fields;\r\n        const schema = super.defineSchema();\r\n\r\n        addAttributesToSchema(schema);\r\n        // TODO: Add modifiers to skills, allow basics to show modifiers e.g. speed *0.75 for dwarf\r\n        schema.creatureForm = new fields.SchemaField({\r\n            name: new fields.StringField({ required: true, blank: true }),\r\n            id: new fields.StringField({ required: true, blank: true }),\r\n            image: new fields.StringField({ required: true, blank: true }),\r\n            sourceId: new fields.StringField({ required: true, blank: true })\r\n        })\r\n\r\n        return schema;\r\n    }\r\n\r\n    // Post Active Effects\r\n    prepareDerivedData() {\r\n        super.prepareDerivedData();\r\n        prepareDerivedAttributeData(this);\r\n    }\r\n}","import AbbrewItemBase from \"./item-base.mjs\";\r\n\r\n// TODO: Needs a sheet\r\n// TODO: Sheet needs to be able to accept limbs\r\n// TODO: Need to handle drag and drop to actor\r\nexport default class AbbrewCreatureForm extends AbbrewItemBase {\r\n\r\n    static defineSchema() {\r\n        const fields = foundry.data.fields;\r\n        const schema = super.defineSchema();\r\n        const blankString = { required: true, blank: true }\r\n        // TODO: Traits that can apply down over e.g. canBleed, should add the same for Background e.g. darkvision\r\n        schema.anatomy = new fields.ArrayField(\r\n            new fields.SchemaField({\r\n                name: new fields.StringField({ required: true, blank: true }),\r\n                id: new fields.StringField({ required: true, blank: true }),\r\n                image: new fields.StringField({ required: true, blank: true })\r\n            })\r\n        );\r\n\r\n        return schema;\r\n    }\r\n}","export function getDefenderAdvantageGuardResult(skillTraining, attackCounterTraining, damage) {\r\n    const trainingResult = skillTraining - attackCounterTraining;\r\n    if (trainingResult > 0) {\r\n        return 0;\r\n    }\r\n\r\n    return 0;\r\n}\r\n\r\nexport function getDefenderAdvantageRiskResult(skillTraining, attackCounterTraining, damage, inflexibility) {\r\n    const trainingResult = skillTraining - attackCounterTraining;\r\n    if (trainingResult > 0) {\r\n        return 0;\r\n    }\r\n\r\n    return Math.min(damage, inflexibility);\r\n}\r\n\r\nexport function getAttackerAdvantageGuardResult(counterTraining, attackerSkillTraining, damage) {\r\n    const trainingResult = attackerSkillTraining - counterTraining;\r\n    if (trainingResult > 0) {\r\n        return damage;\r\n    }\r\n\r\n    return damage;\r\n}\r\n\r\nexport function getAttackerAdvantageRiskResult(counterTraining, attackerSkillTraining, damage, inflexibility) {\r\n    const trainingResult = attackerSkillTraining - counterTraining;\r\n    if (trainingResult > 0) {\r\n        return 2 * Math.min(damage, inflexibility);\r\n    }\r\n\r\n    return Math.min(damage, inflexibility);\r\n}","export const FINISHERS = {\r\n    \"bludgeoning\": {\r\n        1: { \"type\": \"bludgeoning\", \"wounds\": [{ \"type\": \"physical\", \"value\": 1 }], \"text\": \"Target is wounded\" },\r\n        2: { \"type\": \"bludgeoning\", \"wounds\": [{ \"type\": \"physical\", \"value\": 2 }], \"text\": \"Target is wounded\" },\r\n        4: { \"type\": \"bludgeoning\", \"wounds\": [{ \"type\": \"physical\", \"value\": 3 }], \"text\": \"Target is wounded\" },\r\n        8: { \"type\": \"bludgeoning\", \"wounds\": [{ \"type\": \"physical\", \"value\": 5 }], \"text\": \"Target limb is broken\" }\r\n    },\r\n    \"piercing\": {\r\n        1: { \"type\": \"piercing\", \"wounds\": [{ \"type\": \"bleed\", \"value\": 1 }], \"text\": \"Target bleeds lesser\" },\r\n        2: { \"type\": \"piercing\", \"wounds\": [{ \"type\": \"bleed\", \"value\": 2 }], \"text\": \"Target bleeds moderate\" },\r\n        4: { \"type\": \"piercing\", \"wounds\": [{ \"type\": \"bleed\", \"value\": 3 }], \"text\": \"Target bleeds greater\" },\r\n        8: { \"type\": \"piercing\", \"wounds\": [{ \"type\": \"bleed\", \"value\": 5 }], \"text\": \"Target bleeds critically\" }\r\n    },\r\n    \"slashing\": {\r\n        1: { \"type\": \"slashing\", \"wounds\": [{ \"type\": \"physical\", \"value\": 1 }], \"text\": \"Target is cut\" },\r\n        2: { \"type\": \"slashing\", \"wounds\": [{ \"type\": \"bleed\", \"value\": 1 }], \"text\": \"Target bleeds lesser\" },\r\n        4: { \"type\": \"slashing\", \"wounds\": [{ \"type\": \"bleed\", \"value\": 2 }], \"text\": \"Target bleeds moderate\" },\r\n        8: { \"type\": \"slashing\", \"wounds\": [{ \"type\": \"physical\", \"value\": 4 }], \"text\": \"Target loses a limb\" }\r\n    },\r\n    \"physical\": {\r\n        1: { \"type\": \"physical\", \"wounds\": [{ \"type\": \"physical\", \"value\": 1 }], \"text\": \"Target is wounded\" },\r\n        2: { \"type\": \"physical\", \"wounds\": [{ \"type\": \"physical\", \"value\": 2 }], \"text\": \"Target is wounded\" },\r\n        4: { \"type\": \"physical\", \"wounds\": [{ \"type\": \"physical\", \"value\": 3 }], \"text\": \"Target is wounded\" },\r\n        8: { \"type\": \"physical\", \"wounds\": [{ \"type\": \"physical\", \"value\": 4 }], \"text\": \"Target is wounded\" }\r\n    }\r\n}\r\n","import { mergeActorWounds } from \"../helpers/combat.mjs\";\r\nimport { isSkillBlocked } from \"../helpers/skill.mjs\";\r\nimport { getAttackerAdvantageGuardResult, getAttackerAdvantageRiskResult, getDefenderAdvantageGuardResult, getDefenderAdvantageRiskResult } from \"../helpers/trainedSkills.mjs\";\r\nimport { getSafeJson } from \"../helpers/utils.mjs\";\r\nimport { FINISHERS } from \"../static/finishers.mjs\";\r\n\r\n/**\r\n * Extend the base Actor document by defining a custom roll data structure which is ideal for the Simple system.\r\n * @extends {Actor}\r\n */\r\nexport default class AbbrewActor extends Actor {\r\n  /** @override */\r\n  prepareData() {\r\n    // Prepare data for the actor. Calling the super version of this executes\r\n    // the following, in order: data reset (to clear active effects),\r\n    // prepareBaseData(), prepareEmbeddedDocuments() (including active effects),\r\n    // prepareDerivedData().\r\n    super.prepareData();\r\n  }\r\n\r\n  /** @override */\r\n  prepareBaseData() {\r\n    // Data modifications in this step occur before processing embedded\r\n    // documents or derived data.\r\n    super.prepareBaseData();\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * Augment the actor source data with additional dynamic data that isn't \r\n   * handled by the actor's DataModel. Data calculated in this step should be\r\n   * available both inside and outside of character sheets (such as if an actor\r\n   * is queried and has a roll executed directly from it).\r\n   */\r\n  prepareDerivedData() {\r\n    super.prepareDerivedData();\r\n    const actorData = this;\r\n    const flags = actorData.flags.abbrew || {};\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @override\r\n   * Augment the actor's default getRollData() method by appending the data object\r\n   * generated by the its DataModel's getRollData(), or null. This polymorphic \r\n   * approach is useful when you have actors & items that share a parent Document, \r\n   * but have slightly different data preparation needs.\r\n   */\r\n  getRollData() {\r\n    return { ...super.getRollData(), ...this.system.getRollData?.() ?? null };\r\n  }\r\n\r\n  async takeDamage(rolls, data, action) {\r\n    Hooks.call('actorTakesDamage', this);\r\n    let guard = this.system.defense.guard.value;\r\n    let risk = this.system.defense.risk.raw;\r\n    const inflexibility = this.system.defense.inflexibility.raw;\r\n\r\n    const attackingActorParryCounter = data.attackerSkillTraining.find(st => st.type === \"parryCounter\")?.value ?? 0;\r\n    const attackingActorFeint = data.attackerSkillTraining.find(st => st.type === \"feint\")?.value ?? 0;\r\n\r\n    //TODO: Tidy this up\r\n    let damage = this.applyModifiersToDamage(rolls, data, action);\r\n    const updateRisk = this.calculateRisk(damage, guard, risk, inflexibility, data.isFeint, data.isStrongAttack, action, attackingActorParryCounter, attackingActorFeint);\r\n    let overFlow = updateRisk > 100 ? updateRisk - 100 : 0;\r\n\r\n\r\n    const updates = { \"system.defense.guard.value\": await this.calculateGuard(damage + overFlow, guard, data.isFeint, data.isStrongAttack, action, attackingActorParryCounter, attackingActorFeint), \"system.defense.risk.raw\": updateRisk };\r\n    await this.update(updates);\r\n    await this.renderAttackResultCard(data, action);\r\n    return this;\r\n  }\r\n\r\n  async takeFinisher(rolls, data) {\r\n    if (data.totalSuccesses < 1 && !this.statuses.has('offGuard')) {\r\n      await this.sendFinisherToChat();\r\n      return;\r\n    }\r\n\r\n    await this.takeDamage(rolls, data);\r\n\r\n    const risk = this.system.defense.risk.raw;\r\n    const totalRisk = this.applyModifiersToRisk(rolls, data);\r\n    const availableFinishers = this.getAvailableFinishersForDamageType(data);\r\n    const finisherCost = this.getFinisherCost(availableFinishers, totalRisk, data.attackProfile);\r\n    const finisher = this.getFinisher(availableFinishers, finisherCost);\r\n    await this.sendFinisherToChat(finisher, finisherCost);\r\n    if (finisher) {\r\n      return await this.applyFinisher(risk, finisher, finisherCost);\r\n    }\r\n  }\r\n\r\n  applyModifiersToRisk(rolls, data) {\r\n    let successes = 0;\r\n    successes += data.totalSuccesses;\r\n    successes += this.system.defense.risk.value;\r\n    successes -= this.system.defense.inflexibility.resistance.value;\r\n    successes += data.damage.map(d => this.system.defense.protection.find(w => w.type === d.damageType)).reduce((result, p) => result += p?.weakness ?? 0, 0);\r\n    successes -= data.damage.map(d => this.system.defense.protection.find(w => w.type === d.damageType)).reduce((result, p) => result += p?.resistance ?? 0, 0);\r\n    // TODO: Size Diff\r\n    // TODO: Tier Diff\r\n    // TODO: Lethal Diff\r\n    // TODO: Material Tier Diff\r\n    return successes;\r\n  }\r\n\r\n  getAvailableFinishersForDamageType(data) {\r\n    // TODO: Only looking at main damage type?\r\n    return data.damage[0].damageType in FINISHERS ? FINISHERS[data.damage[0].damageType] : FINISHERS['physical'];\r\n  }\r\n\r\n  getFinisherCost(availableFinishers, risk, attackProfile) {\r\n    const viableRisk = Math.min(risk, attackProfile.finisherLimit);\r\n    const keys = Object.keys(availableFinishers);\r\n    const cost = keys.filter((value) => value <= viableRisk).pop();\r\n    if (cost) {\r\n      return cost;\r\n    }\r\n\r\n    return 0;\r\n  }\r\n\r\n  getFinisher(availableFinishers, finisherKey) {\r\n    return availableFinishers[finisherKey];\r\n  }\r\n\r\n  // TODO: Move to another module?\r\n  async sendFinisherToChat(finisher, finisherCost) {\r\n    const templateData = {\r\n      finisherCost,\r\n      finisher,\r\n      actor: this,\r\n      tokenId: this.token?.uuid || null,\r\n    };\r\n\r\n    const html = await renderTemplate(\"systems/abbrew/templates/chat/finisher-card.hbs\", templateData);\r\n\r\n    // Initialize chat data.\r\n    const speaker = ChatMessage.getSpeaker({ actor: this.actor });\r\n    // const rollMode = game.settings.get('core', 'rollMode');\r\n    const label = finisher ? `${finisher.name}` : \"No available finisher\";\r\n    ChatMessage.create({\r\n      speaker: speaker,\r\n      // rollMode: rollMode,\r\n      flavor: label,\r\n      content: html,\r\n      flags: { data: { finisher, finisherCost } }\r\n    });\r\n  }\r\n\r\n  async applyFinisher(risk, finisher, finisherCost) {\r\n    const updates = { \"system.wounds\": mergeActorWounds(this, finisher.wounds), \"system.defense.risk.raw\": this.reduceRiskForFinisher(risk, finisherCost) };\r\n    await this.update(updates);\r\n    return this;\r\n  }\r\n\r\n  reduceRiskForFinisher(risk, finisherCost) {\r\n    return risk - (finisherCost * 10);\r\n  }\r\n\r\n  applyModifiersToDamage(rolls, data) {\r\n    let rollSuccesses = data.totalSuccesses;\r\n    return data.damage.reduce((result, d) => {\r\n      // TODO: Enable new DR types\r\n      const protection = /* this.system.defense.protection.some(dr => dr.type === d.damageType) ? this.system.defense.protection.filter(dr => dr.type === d.damageType)[0] : */ { immunity: 0, resistance: 0, weakness: 0 };\r\n      if (protection.immunity > 0) {\r\n        return result;\r\n      }\r\n\r\n      const damageTypeSuccesses = rollSuccesses;\r\n\r\n      if (damageTypeSuccesses < 0) {\r\n        return result;\r\n      }\r\n\r\n      const dmg = d.value;\r\n\r\n      return result += dmg;\r\n    }, 0);\r\n  }\r\n\r\n  async calculateGuard(damage, guard, isFeint, isStrongAttack, action, attackingActorParryCounter, attackingActorFeint) {\r\n    return guard - this.calculateGuardReduction(damage, guard, isFeint, isStrongAttack, action, attackingActorParryCounter, attackingActorFeint);\r\n  }\r\n\r\n  calculateGuardReduction(damage, guard, isFeint, isStrongAttack, action, attackingActorParryCounter, attackingActorFeint) {\r\n    if (this.noneResult(isFeint, action)) {\r\n      return 0;\r\n    }\r\n\r\n    if (isStrongAttack) {\r\n      return 0 + damage;\r\n    }\r\n\r\n    if (this.attackerGainsAdvantage(isFeint, action)) {\r\n      return getAttackerAdvantageGuardResult(this.system.skillTraining.find(st => st.type === \"feintCounter\")?.value ?? 0, attackingActorFeint, damage);\r\n    }\r\n\r\n    if (this.defenderGainsAdvantage(isFeint, action)) {\r\n      return getDefenderAdvantageGuardResult(this.system.skillTraining.find(st => st.type === \"parry\")?.value ?? 0, attackingActorParryCounter, damage);\r\n    }\r\n\r\n    return 0 + damage;\r\n  }\r\n\r\n  calculateRisk(damage, guard, risk, inflexibility, isFeint, isStrongAttack, action, attackingActorParryCounter, attackingActorFeint) {\r\n    return risk + this.calculateRiskIncrease(damage, guard, risk, inflexibility, isFeint, isStrongAttack, action, attackingActorParryCounter, attackingActorFeint);\r\n  }\r\n\r\n  calculateRiskIncrease(damage, guard, risk, inflexibility, isFeint, isStrongAttack, action, attackingActorParryCounter, attackingActorFeint) {\r\n    if (this.noneResult(isFeint, action)) {\r\n      return 0;\r\n    }\r\n\r\n    if (isStrongAttack) {\r\n      return Math.min(damage, inflexibility);\r\n    }\r\n\r\n    if (this.attackerGainsAdvantage(isFeint, action)) {\r\n      return getAttackerAdvantageRiskResult(this.system.skillTraining.find(st => st.type === \"feintCounter\")?.value ?? 0, attackingActorFeint, damage, inflexibility);\r\n    }\r\n\r\n    if (this.defenderGainsAdvantage(isFeint, action)) {\r\n      return getDefenderAdvantageRiskResult(this.system.skillTraining.find(st => st.type === \"parry\")?.value ?? 0, attackingActorParryCounter, damage, inflexibility);\r\n    }\r\n\r\n    return Math.min(damage, inflexibility);\r\n  }\r\n\r\n  defenderGainsAdvantage(isFeint, action) {\r\n    return isFeint === false && action === 'parry';\r\n  }\r\n\r\n  attackerGainsAdvantage(isFeint, action) {\r\n    return isFeint === true && action === 'parry';\r\n  }\r\n\r\n  noneResult(isFeint, action) {\r\n    return isFeint === true && action === 'damage'\r\n  }\r\n\r\n  async renderAttackResultCard(data, action) {\r\n    const attackerAdvantage = this.attackerGainsAdvantage(data.isFeint, action);\r\n    const defenderAdvantage = this.defenderGainsAdvantage(data.isFeint, action);\r\n    const noneResult = this.noneResult(data.isFeint, action);\r\n\r\n    const templateData = {\r\n      attackerAdvantage,\r\n      defenderAdvantage,\r\n      noneResult,\r\n      actor: this,\r\n      defendingActor: this,\r\n      attackingActor: data.attackingActor,\r\n      tokenId: this.token?.uuid || null,\r\n    };\r\n\r\n    const html = await renderTemplate(\"systems/abbrew/templates/chat/attack-result-card.hbs\", templateData);\r\n\r\n    // Initialize chat data.\r\n    const speaker = ChatMessage.getSpeaker({ actor: this.actor });\r\n\r\n    ChatMessage.create({\r\n      speaker: speaker,\r\n      // rollMode: rollMode,\r\n      // flavor: label,\r\n      content: html,\r\n      flags: { /* data: { finisher, finisherCost } */ }\r\n    });\r\n  }\r\n\r\n  getActorWornArmour() {\r\n    const armour = this.items.filter(i => i.type === 'armour');\r\n    return armour.filter(a => a.system.equipState === 'worn')\r\n  }\r\n\r\n  getActorHeldItems() {\r\n    return this.items.filter(a => a.system.equipType === 'held').filter(a => a.system.equipState.startsWith('held'));\r\n  }\r\n\r\n  getActorAnatomy() {\r\n    return this.items.filter(i => i.type === 'anatomy');\r\n  }\r\n\r\n  doesActorHaveSkillTrait(feature, subFeature, effect, data) {\r\n    return this.items.filter(i => i.system.skillTraits).flatMap(i => JSON.parse(i.system.skillTraits)).some(t => t.feature === feature && t.subFeature === subFeature && t.effect === effect && t.data === data) ?? false;\r\n  }\r\n\r\n  async acceptWound(type, value) {\r\n    const updates = { \"system.wounds\": mergeActorWounds(this, [{ type, value }]) };\r\n    await this.update(updates);\r\n    return this;\r\n  }\r\n\r\n  async acceptBackground(background) {\r\n    const name = background.name;\r\n    const image = background.img;\r\n    const description = background.system.description;\r\n    const attributeIncreases = Object.entries(background.system.attributes).filter(atr => atr[1].value > 0).reduce((result, attribute) => result.concat(Array(attribute[1].value).fill(attribute[0])), []);\r\n    for (const index in attributeIncreases) {\r\n      const system = {\r\n        description,\r\n        attributeIncrease: attributeIncreases[index],\r\n        skillType: \"background\"\r\n      };\r\n      const itemData = {\r\n        name,\r\n        img: image,\r\n        type: 'skill',\r\n        system\r\n      };\r\n      await Item.create(itemData, { parent: this });\r\n    }\r\n  }\r\n\r\n  async acceptCreatureForm(creatureForm) {\r\n    const anatomy = creatureForm.system.anatomy.map(a => game.items.get(a.id));\r\n    for (const index in anatomy) {\r\n      await Item.create(anatomy[index], { parent: this });\r\n\r\n      const weapons = anatomy[index].system.naturalWeapons.map(w => game.items.get(w.id));\r\n      for (const weaponIndex in weapons) {\r\n        await Item.create(weapons[weaponIndex], { parent: this });\r\n      }\r\n    }\r\n  }\r\n\r\n  async acceptSkillDeck(skillDeck) {\r\n    const skills = await Promise.all(skillDeck.system.skills.map(async s => await this.getGameItem(s)));\r\n    for (const index in skills) {\r\n      await Item.create(skills[index], { parent: this })\r\n    }\r\n  }\r\n\r\n  async getGameItem(skill) {\r\n    const itemId = skill.id;\r\n    const sourceId = skill.sourceId;\r\n    if (itemId && !sourceId) {\r\n      const item = game.items.find(i => i._id === itemId);\r\n      if (item) {\r\n        return item;\r\n      }\r\n    } else if (sourceId) {\r\n      const source = fromUuidSync(sourceId);\r\n      const compendiumPackName = source.pack;\r\n      const id = source._id;\r\n      if (!compendiumPackName && source && id) {\r\n        return source;\r\n      } else {\r\n        const pack = game.packs.get(compendiumPackName);\r\n        await pack.getIndex();\r\n        const item = await pack.getDocument(id);\r\n        return item;\r\n      }\r\n    }\r\n  }\r\n\r\n  async acceptAnatomy(anatomy) {\r\n    const naturalWeapons = anatomy.system.naturalWeapons.map(w => game.items.get(w.id));\r\n    for (const index in naturalWeapons) {\r\n      await Item.create(naturalWeapons[index], { parent: this })\r\n    }\r\n  }\r\n\r\n  async canActorUseActions(actions) {\r\n    if (!game.combat && actions <= 5) {\r\n      return true;\r\n    }\r\n\r\n    let remainingActions = this.system.actions;\r\n    if (actions > remainingActions) {\r\n      ui.notifications.info(\"You do not have enough actions to do that.\");\r\n      return false;\r\n    }\r\n\r\n    await this.update({ \"system.actions\": remainingActions -= actions });\r\n    return true;\r\n  }\r\n\r\n  async handleDeleteActiveEffect(effect) {\r\n    const itemId = effect?.flags?.abbrew?.skill?.trackDuration;\r\n    if (itemId) {\r\n      const item = this.items.find(i => i._id === itemId)\r\n      await item.update({ \"system.action.charges.value\": 0 })\r\n      if (item.system.skillType === \"temporary\") {\r\n        await item.delete();\r\n      }\r\n    }\r\n    const activeSkillsWithDuration = this.effects.toObject().filter(e => e.flags?.abbrew?.skill?.type === \"standalone\").map(e => e.flags.abbrew.skill.trackDuration);\r\n    const queuedSkillsWithDuration = this.effects.toObject().filter(e => e.flags?.abbrew?.skill?.type === \"synergy\").map(e => e.flags.abbrew.skill.trackDuration);\r\n    await this.update({ \"system.activeSkills\": activeSkillsWithDuration, \"system.queuedSkills\": queuedSkillsWithDuration });\r\n  }\r\n\r\n  doesActorHaveSkillDiscord(skillName) {\r\n    const skill = this.items.find(i => i.name === skillName);\r\n    if (skill) {\r\n      return isSkillBlocked(this, skill);\r\n    }\r\n\r\n    return false;\r\n  }\r\n}","import { getAttackSkillWithActions, getModifiedSkillActionCost, getParrySkillWithActions, handleSkillActivate } from '../helpers/skill.mjs';\r\nimport { doesNestedFieldExist, arrayDifference, getNumericParts, getSafeJson } from '../helpers/utils.mjs';\r\n/**\r\n * Extend the basic Item with some very simple modifications.\r\n * @extends {Item}\r\n */\r\nexport default class AbbrewItem extends Item {\r\n  /**\r\n   * Augment the basic Item data model with additional dynamic data.\r\n   */\r\n  prepareData() {\r\n    // As with the actor class, items are documents that can have their data\r\n    // preparation methods overridden (such as prepareBaseData()).\r\n    super.prepareData();\r\n  }\r\n\r\n  _preUpdate(changed, options, userId) {\r\n    if (doesNestedFieldExist(changed, \"system.equipState\") && changed.system.equipState === 'worn' && this.type === 'armour') {\r\n      if (!this.isWornEquipStateChangePossible()) {\r\n        ui.notifications.info(\"You are already wearing too many items, try stowing some\");\r\n        this.actor.sheet.render();\r\n        return false;\r\n      }\r\n    }\r\n\r\n\r\n    if (doesNestedFieldExist(changed, \"system.equipState\") && changed.system.equipState.startsWith('held')) {\r\n      if (!this.isHeldEquipStateChangePossible(changed.system.equipState)) {\r\n        ui.notifications.info(\"You are already holding too many items, try stowing some\");\r\n        this.actor.sheet.render();\r\n        return false;\r\n      }\r\n    }\r\n\r\n    super._preUpdate(changed, options, userId);\r\n  }\r\n\r\n  // TODO: Drop items when not enough hands\r\n  isWornEquipStateChangePossible() {\r\n    const armourPoints = JSON.parse(this.system.armourPoints).map(ap => ap.value);\r\n    const usedArmourPoints = this.actor.getActorWornArmour().flatMap(a => JSON.parse(a.system.armourPoints).map(ap => ap.value));\r\n    const actorArmourPoints = this.actor.getActorAnatomy().flatMap(a => JSON.parse(a.system.parts).map(ap => ap.value));\r\n    const availableArmourPoints = arrayDifference(actorArmourPoints, usedArmourPoints);\r\n    if (!armourPoints.every(ap => availableArmourPoints.includes(ap))) {\r\n      return false;\r\n    }\r\n    let requiredArmourPoints = availableArmourPoints.filter(ap => armourPoints.includes(ap));\r\n    const allRequiredAvailable = armourPoints.reduce((result, a) => {\r\n      if (requiredArmourPoints.length > 0 && requiredArmourPoints.includes(a)) {\r\n        const index = requiredArmourPoints.indexOf(a);\r\n        if (index > -1) { // only splice array when item is found\r\n          requiredArmourPoints.splice(index, 1); // 2nd parameter means remove one item only\r\n        } else {\r\n          return false;\r\n        }\r\n      } else {\r\n        result = false;\r\n      }\r\n\r\n      return result;\r\n    }, true);\r\n\r\n    return allRequiredAvailable;\r\n  }\r\n\r\n  isHeldEquipStateChangePossible(equipState) {\r\n    const actorHands = this.actor.getActorAnatomy().reduce((result, a) => result += a.system.hands, 0);\r\n    const equippedHeldItemHands = this.actor.getActorHeldItems().filter(i => i._id !== this._id).reduce((result, a) => result += getNumericParts(a.system.equipState), 0);\r\n    const requiredHands = equippedHeldItemHands + getNumericParts(equipState);\r\n    return actorHands >= requiredHands;\r\n  }\r\n\r\n  /**\r\n   * Prepare a data object which defines the data schema used by dice roll commands against this Item\r\n   * @override\r\n   */\r\n  getRollData() {\r\n    // Starts off by populating the roll data with `this.system`\r\n    const rollData = { ...super.getRollData() };\r\n\r\n    // Quit early if there's no parent actor\r\n    if (!this.actor) return rollData;\r\n\r\n    // If present, add the actor's roll data\r\n    rollData.actor = this.actor.getRollData();\r\n\r\n    return rollData;\r\n  }\r\n\r\n  static chatListeners(html) {\r\n    html.on('click', '.card-buttons button[data-action]', this._onChatCardAction.bind(this));\r\n  }\r\n\r\n  static async _onChatCardAction(event) {\r\n    // event.preventDefault();\r\n\r\n    console.log('chat');\r\n\r\n    // Extract card data\r\n    const button = event.currentTarget;\r\n    // TODO: Might want to do this for targeted effects?\r\n    // button.disabled = true;\r\n    const card = button.closest(\".chat-card\");\r\n    const messageId = card.closest(\".message\").dataset.messageId;\r\n    const message = game.messages.get(messageId);\r\n    const action = button.dataset.action;\r\n    const actor = game.actors.get(card.dataset.actorId);\r\n    const item = game.items.get(card.dataset.itemId);\r\n\r\n    switch (action) {\r\n      case 'damage': await this._onAcceptDamageAction(message.rolls, message.flags.data, action); break;\r\n      case 'overpower': await this._onAcceptDamageAction(message.rolls, message.flags.data, action); break;\r\n      case 'parry': await this._onAcceptDamageAction(message.rolls, message.flags.data, action); break;\r\n      case 'finisher': await this._onAcceptFinisherAction(message.rolls, message.flags.data, action); break;\r\n    }\r\n  }\r\n\r\n  static async _onAcceptDamageAction(rolls, data, action) {\r\n    const tokens = canvas.tokens.controlled.filter((token) => token.actor);\r\n    if (tokens.length === 0) {\r\n      ui.notifications.info(\"Please select a token to accept the effect.\");\r\n      return;\r\n    }\r\n\r\n    const actor = tokens[0].actor;\r\n\r\n    if (action === \"parry\" && !actor.doesActorHaveSkillTrait(\"skillTraining\", \"defensiveSkills\", \"base\", \"parry\")) {\r\n      ui.notifications.info(\"Please ensure you have the parry skill.\");\r\n      return;\r\n    }\r\n\r\n    if (action === \"parry\" && actor.doesActorHaveSkillDiscord(\"Parry\")) {\r\n      ui.notifications.info(\"You are prevented from parrying.\");\r\n      return;\r\n    }\r\n\r\n    if (action === \"parry\") {\r\n      const actions = this.getActionCostForAccept(data, action);\r\n      if (actions > 0 && !await actor.canActorUseActions(getModifiedSkillActionCost(actor, getParrySkillWithActions(actor, actions)))) {\r\n        return;\r\n      }\r\n    }\r\n    await actor.takeDamage(rolls, data, action);\r\n  }\r\n\r\n  static getActionCostForAccept(data, action) {\r\n    return action === \"parry\" ? data.actionCost : 0;\r\n  }\r\n\r\n  static async _onAcceptFinisherAction(rolls, data, action) {\r\n    const tokens = canvas.tokens.controlled.filter((token) => token.actor);\r\n    if (tokens.length === 0) {\r\n      return;\r\n    }\r\n\r\n    await tokens[0].actor.takeFinisher(rolls, data);\r\n  }\r\n\r\n  async _onCreate(data, options, userId) {\r\n    if (data.type === \"skill\") {\r\n      const synergies = getSafeJson(data.system.skillModifiers.synergy, []).map(s => ({ value: s.value, id: this.actor.items.find(i => i.name === s.value)?._id, sourceId: s.sourceId })).filter(s => s.id);\r\n      const discord = getSafeJson(data.system.skillModifiers.discord, []).map(s => ({ value: s.value, id: this.actor.items.find(i => i.name === s.value)?._id, sourceId: s.sourceId })).filter(s => s.id);\r\n      const update = {};\r\n      if (synergies.length > 0) {\r\n        update[\"system.skillModifiers.synergy\"] = JSON.stringify(synergies);\r\n      }\r\n      if (discord.length > 0) {\r\n        update[\"system.skillModifiers.discord\"] = JSON.stringify(discord);\r\n      }\r\n\r\n      if (Object.keys(update).length > 0) {\r\n        await this.update(update);\r\n      }\r\n\r\n      await this.actor?.acceptSkillDeck(data);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle clickable rolls.\r\n   * @param {Event} event   The originating click event\r\n   * @private\r\n   */\r\n  async roll() {\r\n    const item = this;\r\n\r\n    // Initialize chat data.\r\n    const speaker = ChatMessage.getSpeaker({ actor: this.actor });\r\n    const rollMode = game.settings.get('core', 'rollMode');\r\n    const label = `[${item.type}] ${item.name}`;\r\n\r\n    // If there's no roll data, send a chat message.\r\n    if (!this.system.formula) {\r\n      ChatMessage.create({\r\n        speaker: speaker,\r\n        rollMode: rollMode,\r\n        flavor: label,\r\n        content: item.system.description ?? '',\r\n      });\r\n    }\r\n    // Otherwise, create a roll and send a chat message from it.\r\n    else {\r\n      // TODO: Replace with old\r\n      console.log('general roll');\r\n    }\r\n  }\r\n\r\n  async handleAttackDamageAction(actor, attackProfileId, attackMode) {\r\n    const attackProfile = this.system.attackProfiles[attackProfileId];\r\n    const actionCost = attackMode === \"overpower\" ? this.system.exertActionCost : this.system.actionCost;\r\n\r\n    const id = actor.system.proxiedSkills[attackMode];\r\n\r\n    const attackSkill = getAttackSkillWithActions(id, this.name, actionCost, this.img, attackProfile, attackMode, this.system.handsSupplied);\r\n\r\n    await handleSkillActivate(actor, attackSkill);\r\n  }\r\n}\r\n","export function registerSystemSettings() {\r\n    game.settings.register(\"abbrew\", \"announceTurnStart\", {\r\n        name: \"SETTINGS.AnnounceTurnStart.Name\",\r\n        hint: \"SETTINGS.AnnounceTurnStart.Hint\",\r\n        scope: \"world\",\r\n        config: true,\r\n        default: false,\r\n        type: Boolean\r\n    });\r\n}","import {\r\n    onManageActiveEffect,\r\n    prepareActiveEffectCategories,\r\n} from '../../helpers/effects.mjs';\r\n\r\n/**\r\n * Extend the basic ItemSheet with some very simple modifications\r\n * @extends {ItemSheet}\r\n */\r\nexport class AbbrewCreatureFormSheet extends ItemSheet {\r\n    /** @override */\r\n    static get defaultOptions() {\r\n        return foundry.utils.mergeObject(super.defaultOptions, {\r\n            classes: ['abbrew', 'sheet', 'item'],\r\n            width: 520,\r\n            height: 480,\r\n            tabs: [\r\n                {\r\n                    navSelector: '.sheet-tabs',\r\n                    contentSelector: '.sheet-body',\r\n                    initial: 'description',\r\n                },\r\n            ],\r\n        });\r\n    }\r\n\r\n    /** @override */\r\n    get template() {\r\n        const path = 'systems/abbrew/templates/item';\r\n        // Return a single sheet for all item types.\r\n        // return `${path}/item-sheet.hbs`;\r\n\r\n        // Alternatively, you could use the following return statement to do a\r\n        // unique item sheet by type, like `weapon-sheet.hbs`.\r\n        return `${path}/item-${this.item.type}-sheet.hbs`;\r\n    }\r\n\r\n    /* -------------------------------------------- */\r\n\r\n    /** @override */\r\n    async getData() {\r\n        // Retrieve base data structure.\r\n        const context = super.getData();\r\n\r\n        // Use a safe clone of the item data for further operations.\r\n        const itemData = context.data;\r\n\r\n        // Retrieve the roll data for TinyMCE editors.\r\n        context.rollData = this.item.getRollData();\r\n\r\n        // Add the item's data to context.data for easier access, as well as flags.\r\n        context.system = itemData.system;\r\n        context.flags = itemData.flags;\r\n\r\n        // Enrich description info for display\r\n        // Enrichment turns text like `[[/r 1d20]]` into buttons\r\n        context.enrichedDescription = await TextEditor.enrichHTML(\r\n            this.item.system.description,\r\n            {\r\n                // Whether to show secret blocks in the finished html\r\n                secrets: this.document.isOwner,\r\n                // Necessary in v11, can be removed in v12\r\n                async: true,\r\n                // Data to fill in for inline rolls\r\n                rollData: this.item.getRollData(),\r\n                // Relative UUID resolution\r\n                relativeTo: this.item,\r\n            }\r\n        );\r\n\r\n        // Prepare active effects for easier access\r\n        context.effects = prepareActiveEffectCategories(this.item.effects);\r\n\r\n        context.config = CONFIG.ABBREW;\r\n\r\n        return context;\r\n    }\r\n\r\n    /* -------------------------------------------- */\r\n\r\n    /** @override */\r\n    activateListeners(html) {\r\n        super.activateListeners(html);\r\n\r\n        // Everything below here is only needed if the sheet is editable\r\n        if (!this.isEditable) return;\r\n\r\n        // Roll handlers, click handlers, etc. would go here.\r\n\r\n        // Active Effect management\r\n        html.on('click', '.effect-control', (event) =>\r\n            onManageActiveEffect(event, this.item)\r\n        );\r\n\r\n        html.on('dragover', (event) => {\r\n            event.preventDefault();\r\n        });\r\n\r\n        // Delete Anatomy Summary\r\n        html.on('click', '.anatomy-delete', async (ev) => {\r\n            const li = $(ev.currentTarget).parents('.creature-form-anatomy');\r\n            if (li.data('id') || li.data('id') === 0) {\r\n                const anatomy = this.item.system.anatomy;\r\n                anatomy.splice(li.data('id'), 1);\r\n                await this.item.update({ \"system.anatomy\": anatomy });\r\n            }\r\n        });\r\n\r\n        html.on('drop', async (event) => {\r\n            if (!this.item.testUserPermission(game.user, 'OWNER')) {\r\n                return;\r\n            }\r\n\r\n            const droppedData = event.originalEvent.dataTransfer.getData(\"text\")\r\n            const eventJson = JSON.parse(droppedData);\r\n            if (eventJson && eventJson.type === \"Item\") {\r\n                const itemId = eventJson.uuid.split(\".\").pop()\r\n                const item = game.items.get(itemId);\r\n                if (item.type === \"anatomy\") {\r\n                    const storedAnatomy = this.item.system.anatomy;\r\n                    const newAnatomy = [...storedAnatomy, { name: item.name, id: itemId, image: item.img }];\r\n                    await this.item.update({ \"system.anatomy\": newAnatomy });\r\n                }\r\n            }\r\n        })\r\n    }\r\n}\r\n","import {\r\n    onManageActiveEffect,\r\n    prepareActiveEffectCategories,\r\n} from '../../helpers/effects.mjs';\r\nimport { renderSheetForStoredItem } from '../../helpers/utils.mjs';\r\n\r\n/**\r\n * Extend the basic ItemSheet with some very simple modifications\r\n * @extends {ItemSheet}\r\n */\r\nexport class AbbrewSkillDeckSheet extends ItemSheet {\r\n    /** @override */\r\n    static get defaultOptions() {\r\n        return foundry.utils.mergeObject(super.defaultOptions, {\r\n            classes: ['abbrew', 'sheet', 'item'],\r\n            width: 520,\r\n            height: 480,\r\n            tabs: [\r\n                {\r\n                    navSelector: '.sheet-tabs',\r\n                    contentSelector: '.sheet-body',\r\n                    initial: 'description',\r\n                },\r\n            ],\r\n        });\r\n    }\r\n\r\n    /** @override */\r\n    get template() {\r\n        const path = 'systems/abbrew/templates/item';\r\n        // Return a single sheet for all item types.\r\n        // return `${path}/item-sheet.hbs`;\r\n\r\n        // Alternatively, you could use the following return statement to do a\r\n        // unique item sheet by type, like `weapon-sheet.hbs`.\r\n        return `${path}/item-${this.item.type}-sheet.hbs`;\r\n    }\r\n\r\n    /* -------------------------------------------- */\r\n\r\n    /** @override */\r\n    async getData() {\r\n        // Retrieve base data structure.\r\n        const context = super.getData();\r\n\r\n        // Use a safe clone of the item data for further operations.\r\n        const itemData = context.data;\r\n\r\n        // Retrieve the roll data for TinyMCE editors.\r\n        context.rollData = this.item.getRollData();\r\n\r\n        // Add the item's data to context.data for easier access, as well as flags.\r\n        context.system = itemData.system;\r\n        context.flags = itemData.flags;\r\n\r\n        // Enrich description info for display\r\n        // Enrichment turns text like `[[/r 1d20]]` into buttons\r\n        context.enrichedDescription = await TextEditor.enrichHTML(\r\n            this.item.system.description,\r\n            {\r\n                // Whether to show secret blocks in the finished html\r\n                secrets: this.document.isOwner,\r\n                // Necessary in v11, can be removed in v12\r\n                async: true,\r\n                // Data to fill in for inline rolls\r\n                rollData: this.item.getRollData(),\r\n                // Relative UUID resolution\r\n                relativeTo: this.item,\r\n            }\r\n        );\r\n\r\n        // Prepare active effects for easier access\r\n        context.effects = prepareActiveEffectCategories(this.item.effects);\r\n\r\n        context.config = CONFIG.ABBREW;\r\n\r\n        return context;\r\n    }\r\n\r\n    /* -------------------------------------------- */\r\n\r\n    /** @override */\r\n    activateListeners(html) {\r\n        super.activateListeners(html);\r\n\r\n        // Everything below here is only needed if the sheet is editable\r\n        if (!this.isEditable) return;\r\n\r\n        // Roll handlers, click handlers, etc. would go here.\r\n\r\n        // Active Effect management\r\n        html.on('click', '.effect-control', (event) =>\r\n            onManageActiveEffect(event, this.item)\r\n        );\r\n\r\n        html.on('dragover', (event) => {\r\n            event.preventDefault();\r\n        });\r\n\r\n        // Delete Skill Summary\r\n        html.on('click', '.skill-delete', async (ev) => {\r\n            const li = $(ev.currentTarget).parents('.skill-deck-skill');\r\n            if (li.data('id') || li.data('id') === 0) {\r\n                const skills = this.item.system.skills;\r\n                skills.splice(li.data('id'), 1);\r\n                await this.item.update({ \"system.skills\": skills });\r\n            }\r\n        });\r\n\r\n        // Delete Creature Form\r\n        html.on('click', '.creature-form-delete', async (ev) => {\r\n            await this.item.update({ \"system.creatureForm\": { name: \"\", id: \"\", image: \"\" } });\r\n        });\r\n\r\n        html.on('click', '.skill-deck-skill .skill-deck-summary .image-container, .skill-deck-skill .skill-deck-summary .name', async (event) => {\r\n            await renderSheetForStoredItem(event, this.actor);\r\n        });\r\n\r\n        html.on('drop', async (event) => {\r\n            if (!this.item.testUserPermission(game.user, 'OWNER')) {\r\n                return;\r\n            }\r\n\r\n            const droppedData = event.originalEvent.dataTransfer.getData(\"text\")\r\n            const eventJson = JSON.parse(droppedData);\r\n            if (eventJson && eventJson.type === \"Item\") {\r\n                const item = fromUuidSync(eventJson.uuid);\r\n                if (item.type === \"skill\") {\r\n                    const storedSkills = this.item.system.skills;\r\n                    const updateSkills = [...storedSkills, { name: item.name, id: item._id, image: item.img, sourceId: item.uuid }];\r\n                    await this.item.update({ \"system.skills\": updateSkills });\r\n                } else if (item.type === \"creatureForm\") {\r\n                    await this.item.update({ \"system.creatureForm\": { name: item.name, id: item._id, image: item.img, sourceId: item.uuid } });\r\n                }\r\n            }\r\n        })\r\n    }\r\n}\r\n","import {\r\n  onManageActiveEffect,\r\n  prepareActiveEffectCategories,\r\n} from '../../helpers/effects.mjs';\r\nimport Tagify from '@yaireo/tagify'\r\n\r\n/**\r\n * Extend the basic ItemSheet with some very simple modifications\r\n * @extends {ItemSheet}\r\n */\r\nexport class AbbrewAnatomySheet extends ItemSheet {\r\n  /** @override */\r\n  static get defaultOptions() {\r\n    return foundry.utils.mergeObject(super.defaultOptions, {\r\n      classes: ['abbrew', 'sheet', 'item'],\r\n      width: 520,\r\n      height: 480,\r\n      tabs: [\r\n        {\r\n          navSelector: '.sheet-tabs',\r\n          contentSelector: '.sheet-body',\r\n          initial: 'description',\r\n        },\r\n      ],\r\n    });\r\n  }\r\n\r\n  /** @override */\r\n  get template() {\r\n    const path = 'systems/abbrew/templates/item';\r\n    // Return a single sheet for all item types.\r\n    // return `${path}/item-sheet.hbs`;\r\n\r\n    // Alternatively, you could use the following return statement to do a\r\n    // unique item sheet by type, like `weapon-sheet.hbs`.\r\n    return `${path}/item-${this.item.type}-sheet.hbs`;\r\n  }\r\n\r\n  /* -------------------------------------------- */\r\n\r\n  /** @override */\r\n  async getData() {\r\n    // Retrieve base data structure.\r\n    const context = super.getData();\r\n\r\n    // Use a safe clone of the item data for further operations.\r\n    const itemData = context.data;\r\n\r\n    // Retrieve the roll data for TinyMCE editors.\r\n    context.rollData = this.item.getRollData();\r\n\r\n    // Add the item's data to context.data for easier access, as well as flags.\r\n    context.system = itemData.system;\r\n    context.flags = itemData.flags;\r\n\r\n    // Enrich description info for display\r\n    // Enrichment turns text like `[[/r 1d20]]` into buttons\r\n    context.enrichedDescription = await TextEditor.enrichHTML(\r\n      this.item.system.description,\r\n      {\r\n        // Whether to show secret blocks in the finished html\r\n        secrets: this.document.isOwner,\r\n        // Necessary in v11, can be removed in v12\r\n        async: true,\r\n        // Data to fill in for inline rolls\r\n        rollData: this.item.getRollData(),\r\n        // Relative UUID resolution\r\n        relativeTo: this.item,\r\n      }\r\n    );\r\n\r\n    // Prepare active effects for easier access\r\n    context.effects = prepareActiveEffectCategories(this.item.effects);\r\n\r\n    context.config = CONFIG.ABBREW;\r\n\r\n    return context;\r\n  }\r\n\r\n  /* -------------------------------------------- */\r\n\r\n  _activateAnatomyParts(html) {\r\n    const anatomyParts = html[0].querySelector('input[name=\"system.parts\"]');\r\n    const anatomyPartsSettings = {\r\n      dropdown: {\r\n        maxItems: 20,               // <- mixumum allowed rendered suggestions\r\n        classname: \"tags-look\",     // <- custom classname for this dropdown, so it could be targeted\r\n        enabled: 0,                 // <- show suggestions on focus\r\n        closeOnSelect: false,       // <- do not hide the suggestions dropdown once an item has been selected\r\n        includeSelectedTags: true   // <- Should the suggestions list Include already-selected tags (after filtering)\r\n      },\r\n      userInput: false,             // <- Disable manually typing/pasting/editing tags (tags may only be added from the whitelist). Can also use the disabled attribute on the original input element. To update this after initialization use the setter tagify.userInput\r\n      duplicates: true,             // <- Should duplicate tags be allowed or not\r\n      whitelist: [...Object.values(CONFIG.ABBREW.armourPoints.points).map(key => game.i18n.localize(key))]\r\n    };\r\n    if (anatomyParts) {\r\n      var taggedAnatomyParts = new Tagify(anatomyParts, anatomyPartsSettings);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle one of the add or remove damage reduction buttons.\r\n   * @param {Element} target  Button or context menu entry that triggered this action.\r\n   * @param {string} action   Action being triggered.\r\n   * @returns {Promise|void}\r\n   */\r\n  _onDamageReductionAction(target, action) {\r\n    switch (action) {\r\n      case 'add-damage-reduction':\r\n        return this.addDamageReduction();\r\n      case 'remove-damage-reduction':\r\n        return this.removeDamageReduction(target);\r\n        break;\r\n    }\r\n  }\r\n\r\n  addDamageReduction() {\r\n    const protection = this.item.system.defense.protection;\r\n    return this.item.update({ \"system.defense.protection\": [...protection, {}] });\r\n  }\r\n\r\n  removeDamageReduction(target) {\r\n    const id = target.closest(\"li\").dataset.id;\r\n    const defense = foundry.utils.deepClone(this.item.system.defense);\r\n    defense.protection.splice(Number(id), 1);\r\n    return this.item.update({ \"system.defense.protection\": defense.protection });\r\n  }\r\n\r\n  /* -------------------------------------------- */\r\n\r\n  /** @override */\r\n  activateListeners(html) {\r\n    super.activateListeners(html);\r\n\r\n    // Everything below here is only needed if the sheet is editable\r\n    if (!this.isEditable) return;\r\n\r\n    // Roll handlers, click handlers, etc. would go here.\r\n\r\n    // Active Effect management\r\n    html.on('click', '.effect-control', (ev) =>\r\n      onManageActiveEffect(ev, this.item)\r\n    );\r\n\r\n    html.find(\".damage-reduction-control\").click(event => {\r\n      const t = event.currentTarget;\r\n      if (t.dataset.action) this._onDamageReductionAction(t, t.dataset.action);\r\n    });\r\n\r\n    this._activateAnatomyParts(html);\r\n\r\n    html.on('dragover', (event) => {\r\n      event.preventDefault();\r\n    });\r\n\r\n    html.on('drop', async (event) => {\r\n      if (!this.item.testUserPermission(game.user, 'OWNER')) {\r\n        return;\r\n      }\r\n\r\n      const droppedData = event.originalEvent.dataTransfer.getData(\"text\")\r\n      const eventJson = JSON.parse(droppedData);\r\n      if (eventJson && eventJson.type === \"Item\") {\r\n        const itemId = eventJson.uuid.split(\".\").pop()\r\n        const item = game.items.get(itemId);\r\n        if (item.type === \"weapon\") {\r\n          const storedWeapons = this.item.system.naturalWeapons;\r\n          const updateWeapons = [...storedWeapons, { name: item.name, id: itemId, image: item.img }];\r\n          await this.item.update({ \"system.naturalWeapons\": updateWeapons });\r\n        }\r\n      }\r\n    })\r\n  }\r\n}\r\n","import {\r\n    onManageActiveEffect,\r\n    prepareActiveEffectCategories,\r\n} from '../../helpers/effects.mjs';\r\nimport Tagify from '@yaireo/tagify'\r\nimport { getObjectValueByStringPath, getSafeJson, renderSheetForStoredItem, renderSheetForTaggedData } from '../../helpers/utils.mjs';\r\n\r\n/**\r\n * Extend the basic ItemSheet with some very simple modifications\r\n * @extends {ItemSheet}\r\n */\r\nexport class AbbrewSkillSheet extends ItemSheet {\r\n    /** @override */\r\n    static get defaultOptions() {\r\n        return foundry.utils.mergeObject(super.defaultOptions, {\r\n            classes: ['abbrew', 'sheet', 'item'],\r\n            width: 520,\r\n            height: 480,\r\n            tabs: [\r\n                {\r\n                    navSelector: '.sheet-tabs',\r\n                    contentSelector: '.sheet-body',\r\n                    initial: 'description',\r\n                },\r\n            ],\r\n        });\r\n    }\r\n\r\n    /** @override */\r\n    get template() {\r\n        const path = 'systems/abbrew/templates/item';\r\n        // Return a single sheet for all item types.\r\n        // return `${path}/item-sheet.hbs`;\r\n\r\n        // Alternatively, you could use the following return statement to do a\r\n        // unique item sheet by type, like `weapon-sheet.hbs`.\r\n        return `${path}/item-${this.item.type}-sheet.hbs`;\r\n    }\r\n\r\n    /* -------------------------------------------- */\r\n\r\n    /** @override */\r\n    async getData() {\r\n        // Retrieve base data structure.\r\n        const context = super.getData();\r\n\r\n        // Use a safe clone of the item data for further operations.\r\n        const itemData = context.data;\r\n\r\n        // Retrieve the roll data for TinyMCE editors.\r\n        context.rollData = this.item.getRollData();\r\n\r\n        // Add the item's data to context.data for easier access, as well as flags.\r\n        context.system = itemData.system;\r\n        context.flags = itemData.flags;\r\n\r\n        // Enrich description info for display\r\n        // Enrichment turns text like `[[/r 1d20]]` into buttons\r\n        context.enrichedDescription = await TextEditor.enrichHTML(\r\n            this.item.system.description,\r\n            {\r\n                // Whether to show secret blocks in the finished html\r\n                secrets: this.document.isOwner,\r\n                // Necessary in v11, can be removed in v12\r\n                async: true,\r\n                // Data to fill in for inline rolls\r\n                rollData: this.item.getRollData(),\r\n                // Relative UUID resolution\r\n                relativeTo: this.item,\r\n            }\r\n        );\r\n\r\n        // Prepare active effects for easier access\r\n        context.effects = prepareActiveEffectCategories(this.item.effects);\r\n\r\n        context.config = CONFIG.ABBREW;\r\n\r\n        return context;\r\n    }\r\n\r\n    /* -------------------------------------------- */\r\n\r\n    /** @override */\r\n    activateListeners(html) {\r\n        super.activateListeners(html);\r\n\r\n        // Everything below here is only needed if the sheet is editable\r\n        if (!this.isEditable) return;\r\n\r\n        // Roll handlers, click handlers, etc. would go here.\r\n\r\n        // Active Effect management\r\n        html.on('click', '.effect-control', (event) =>\r\n            onManageActiveEffect(event, this.item)\r\n        );\r\n\r\n        html.find(\".skill-action-resource-control\").click(event => {\r\n            const t = event.currentTarget;\r\n            if (t.dataset.action) this._onSkillActionResourceRequirementAction(t, t.dataset.action);\r\n        });\r\n\r\n        html.find(\".skill-action-modifier-wound-control\").click(event => {\r\n            const t = event.currentTarget;\r\n            if (t.dataset.action) this._onSkillActionModifierWoundAction(t, t.dataset.action);\r\n        });\r\n\r\n        html.find(\".skill-action-modifier-damage-control\").click(event => {\r\n            const t = event.currentTarget;\r\n            if (t.dataset.action) this._onSkillActionModifierDamageAction(t, t.dataset.action);\r\n        });\r\n\r\n        html.find(\".damage-control\").click(event => {\r\n            const t = event.currentTarget;\r\n            if (t.dataset.action) this._onDamageAction(t, t.dataset.action);\r\n        });\r\n\r\n        html.find(\".attack-profile-control\").click(event => {\r\n            const t = event.currentTarget;\r\n            if (t.dataset.action) this._onAttackProfileAction(t, t.dataset.action);\r\n        });\r\n\r\n        html.find(\".skill-configuration-section :input\").prop(\"disabled\", !this.item.system.configurable);\r\n\r\n        html.on(\"click\", \".tagify__tag div\", async (event) => {\r\n            await renderSheetForTaggedData(event, this.actor);\r\n        })\r\n\r\n        html.on('dragover', (event) => {\r\n            event.preventDefault();\r\n        });\r\n\r\n        html.on('drop', 'ol.skill-deck-skills', async (event) => {\r\n            if (!this.item.testUserPermission(game.user, 'OWNER')) {\r\n                return;\r\n            }\r\n\r\n            const droppedData = event.originalEvent.dataTransfer.getData(\"text\")\r\n            const eventJson = JSON.parse(droppedData);\r\n            if (eventJson && eventJson.type === \"Item\") {\r\n                const item = fromUuidSync(eventJson.uuid);\r\n                if (item.type === \"skill\") {\r\n                    const storedSkills = this.item.system.skills;\r\n                    const updateSkills = [...storedSkills, { name: item.name, id: item._id, image: item.img, sourceId: item.uuid }];\r\n                    await this.item.update({ \"system.skills\": updateSkills });\r\n                }\r\n            }\r\n        });\r\n\r\n        html.on('click', '.skill-deck-skill .skill-deck-summary .image-container, .skill-deck-skill .skill-deck-summary .name', async (event) => {\r\n            await renderSheetForStoredItem(event, this.actor);\r\n        });\r\n\r\n        html.on('click', '.skill-delete', async (ev) => {\r\n            const li = $(ev.currentTarget).parents('.skill-deck-skill');\r\n            if (li.data('id') || li.data('id') === 0) {\r\n                const skills = this.item.system.skills;\r\n                skills.splice(li.data('id'), 1);\r\n                await this.item.update({ \"system.skills\": skills });\r\n            }\r\n        });\r\n\r\n        html.on('drop', 'tags.tagify', async (event) => {\r\n            if (!this.item.testUserPermission(game.user, 'OWNER')) {\r\n                return;\r\n            }\r\n\r\n            const target = event.target;\r\n            let inputElement = null;\r\n            if (Object.values(target.classList).includes(\"tagify__input\")) {\r\n                inputElement = target.parentElement.nextElementSibling;\r\n            } else if (Object.values(target.classList).includes(\"tagify\")) {\r\n                inputElement = target.nextElementSibling;\r\n            } else {\r\n                return;\r\n            }\r\n\r\n            if (inputElement.readOnly) {\r\n                return;\r\n            }\r\n\r\n            const droppedData = event.originalEvent.dataTransfer.getData(\"text\")\r\n            const eventJson = JSON.parse(droppedData);\r\n            if (eventJson && eventJson.type === \"Item\") {\r\n                const item = fromUuidSync(eventJson.uuid);\r\n                if (inputElement.dataset.droptype !== item.type) {\r\n                    return;\r\n                }\r\n                const value = item.name;\r\n                const path = inputElement.name;\r\n                const inputValue = getSafeJson(getObjectValueByStringPath(this.item, path), []);\r\n                const updateValue = [...inputValue, { value: value, id: \"\", sourceId: eventJson.uuid }];\r\n                const update = {};\r\n                update[path] = JSON.stringify(updateValue);\r\n                await this.item.update(update);\r\n            }\r\n        })\r\n\r\n        this._activateSkillTraits(html);\r\n        this._activateSkillModifiers(html);\r\n    }\r\n\r\n    _activateSkillTraits(html) {\r\n        const skillTraits = html[0].querySelector('input[name=\"system.skillTraits\"]');\r\n        const skillTraitSettings = {\r\n            dropdown: {\r\n                maxItems: 20,               // <- mixumum allowed rendered suggestions\r\n                classname: \"tags-look\",     // <- custom classname for this dropdown, so it could be targeted\r\n                enabled: 0,                 // <- show suggestions on focus\r\n                closeOnSelect: false,       // <- do not hide the suggestions dropdown once an item has been selected\r\n                includeSelectedTags: false   // <- Should the suggestions list Include already-selected tags (after filtering)\r\n            },\r\n            userInput: true,             // <- Disable manually typing/pasting/editing tags (tags may only be added from the whitelist). Can also use the disabled attribute on the original input element. To update this after initialization use the setter tagify.userInput\r\n            duplicates: true,             // <- Should duplicate tags be allowed or not\r\n            whitelist: [.../* Object.values( */CONFIG.ABBREW.traits/* ) */.map(trait => ({\r\n                ...trait,\r\n                value: game.i18n.localize(trait.value)\r\n            }))],\r\n        };\r\n        if (skillTraits) {\r\n            var taggedSkillTraits = new Tagify(skillTraits, skillTraitSettings);\r\n        }\r\n    }\r\n\r\n\r\n    _activateSkillModifiers(html) {\r\n        const skillSynergy = html[0].querySelector('input[name=\"system.skillModifiers.synergy\"]');\r\n        const skillDiscord = html[0].querySelector('input[name=\"system.skillModifiers.discord\"]');\r\n        // TODO: Could add the baseline skills here to make sure they exist\r\n        // const proxiedSkills = Object.entries(this.item?.actor?.system.proxiedSkills).filter(ps => ps[1]).map(ps => ({ value: CONFIG.ABBREW.proxiedSkills[ps[0]], id: ps[1] }));\r\n        const settings = {\r\n            dropdown: {\r\n                maxItems: 20,               // <- mixumum allowed rendered suggestions\r\n                classname: \"tags-look\",     // <- custom classname for this dropdown, so it could be targeted\r\n                enabled: 0,                 // <- show suggestions on focus\r\n                closeOnSelect: false,       // <- do not hide the suggestions dropdown once an item has been selected\r\n                includeSelectedTags: false   // <- Should the suggestions list Include already-selected tags (after filtering)\r\n            },\r\n            userInput: false,             // <- Disable manually typing/pasting/editing tags (tags may only be added from the whitelist). Can also use the disabled attribute on the original input element. To update this after initialization use the setter tagify.userInput\r\n            duplicates: false,             // <- Should duplicate tags be allowed or not\r\n        };\r\n        if (skillSynergy) {\r\n            var taggedSkillSynergy = new Tagify(skillSynergy, settings);\r\n        }\r\n        if (skillDiscord) {\r\n            var taggedSkillDiscord = new Tagify(skillDiscord, settings);\r\n        }\r\n    }\r\n\r\n    /**\r\n      * Handle one of the add or remove wound reduction buttons.\r\n      * @param {Element} target  Button or context menu entry that triggered this action.\r\n      * @param {string} action   Action being triggered.\r\n      * @returns {Promise|void}\r\n      */\r\n    _onSkillActionModifierWoundAction(target, action) {\r\n        if (this.item.system.configurable) {\r\n            switch (action) {\r\n                case 'add-skill-action-modifier-wound':\r\n                    return this.addSkillActionModifierWound(target);\r\n                case 'remove-skill-action-modifier-wound':\r\n                    return this.removeSkillActionModifierWound(target);\r\n            }\r\n        }\r\n    }\r\n\r\n    addSkillActionModifierWound(target) {\r\n        let action = foundry.utils.deepClone(this.item.system.action);\r\n        action.modifiers.wounds.self = [...action.modifiers.wounds.self, {}];\r\n        return this.item.update({ \"system.action\": action });\r\n\r\n    }\r\n\r\n    removeSkillActionModifierWound(target) {\r\n        const id = target.closest(\"li\").dataset.id;\r\n        const action = foundry.utils.deepClone(this.item.system.action);\r\n        action.modifiers.wounds.self.splice(Number(id), 1);\r\n        return this.item.update({ \"system.action\": action });\r\n    }\r\n\r\n    _onDamageAction(target, action) {\r\n        switch (action) {\r\n            case 'add-damage':\r\n                return this.addDamage(target);\r\n            case 'remove-damage':\r\n                return this.removeDamage(target);\r\n                break;\r\n        }\r\n    }\r\n\r\n    addDamage(target) {\r\n        const damage = this.item.system.action.modifiers.attackProfile.damage;\r\n        const update = [...damage, {}];\r\n        return this.item.update({ \"system.action.modifiers.attackProfile.damage\": update });\r\n    }\r\n\r\n    removeDamage(target) {\r\n        const damageId = target.closest(\"li\").dataset.id;\r\n        const damage = this.item.system.action.modifiers.attackProfile.damage;\r\n        damage.splice(Number(damageId), 1);\r\n        return this.item.update({ \"system.action.modifiers.attackProfile.damage\": damage });\r\n    }\r\n\r\n    tagify\r\n}\r\n","// Import sheet classes.\r\nimport { AbbrewActorSheet } from './sheets/actor-sheet.mjs';\r\nimport { AbbrewItemSheet } from './sheets/item-sheet.mjs';\r\n// Import helper/utility classes and constants.\r\nimport { preloadHandlebarsTemplates } from './helpers/templates.mjs';\r\nimport { ABBREW } from './helpers/config.mjs';\r\n// Import DataModel classes\r\nimport * as models from './data/_module.mjs';\r\n// Import Documents Classes\r\nimport * as documents from './documents/_module.mjs';\r\nimport { handleTurnChange, handleActorWoundConditions, handleActorGuardConditions, handleCombatStart } from './helpers/combat.mjs';\r\nimport { staticID, doesNestedFieldExist } from './helpers/utils.mjs';\r\nimport { registerSystemSettings } from './settings.mjs';\r\nimport { AbbrewCreatureFormSheet } from './sheets/items/item-creature-form-sheet.mjs';\r\nimport { AbbrewSkillDeckSheet } from './sheets/items/item-skill-deck-sheet.mjs';\r\nimport { AbbrewAnatomySheet } from './sheets/items/item-anatomy-sheet.mjs';\r\nimport { AbbrewSkillSheet } from './sheets/items/item-skill-sheet.mjs';\r\nimport { handleSkillActivate } from './helpers/skill.mjs';\r\n\r\n/* -------------------------------------------- */\r\n/*  Init Hook                                   */\r\n/* -------------------------------------------- */\r\n\r\nHooks.once('init', function () {\r\n  // Add utility classes to the global game object so that they're more easily\r\n  // accessible in global contexts.\r\n  game.abbrew = {\r\n    AbbrewActor: documents.AbbrewActor,\r\n    AbbrewItem: documents.AbbrewItem,\r\n    useSkillMacro,\r\n    rollItemMacro,\r\n  };\r\n\r\n  // Add custom constants for configuration.\r\n  CONFIG.ABBREW = ABBREW;\r\n\r\n  addWoundUtilities();\r\n\r\n  /**\r\n   * Set an initiative formula for the system\r\n   * @type {String}\r\n   */\r\n  CONFIG.Combat.initiative = {\r\n    formula: '1d10 + @attributes.agi.value + @attributes.wit.value',\r\n    decimals: 2,\r\n  };\r\n\r\n  // Define custom Document and DataModel classes\r\n  CONFIG.Actor.documentClass = documents.AbbrewActor;\r\n\r\n  // Note that you don't need to declare a DataModel\r\n  // for the base actor/item classes - they are included\r\n  // with the Character/NPC as part of super.defineSchema()\r\n  CONFIG.Actor.dataModels = {\r\n    character: models.AbbrewCharacter,\r\n    npc: models.AbbrewNPC\r\n  }\r\n  CONFIG.Item.documentClass = documents.AbbrewItem;\r\n  CONFIG.Item.dataModels = {\r\n    item: models.AbbrewItem,\r\n    feature: models.AbbrewFeature,\r\n    spell: models.AbbrewSpell,\r\n    skill: models.AbbrewSkill,\r\n    anatomy: models.AbbrewAnatomy,\r\n    armour: models.AbbrewArmour,\r\n    weapon: models.AbbrewWeapon,\r\n    wound: models.AbbrewWound,\r\n    background: models.AbbrewBackground,\r\n    skillDeck: models.AbbrewSkillDeck,\r\n    creatureForm: models.AbbrewCreatureForm\r\n  }\r\n\r\n  // Register System Settings  \r\n  registerSystemSettings();\r\n\r\n  // Active Effects are never copied to the Actor,\r\n  // but will still apply to the Actor from within the Item\r\n  // if the transfer property on the Active Effect is true.\r\n  CONFIG.ActiveEffect.legacyTransferral = false;\r\n\r\n  // Register sheet application classes\r\n  Actors.unregisterSheet('core', ActorSheet);\r\n  Actors.registerSheet('abbrew', AbbrewActorSheet, {\r\n    makeDefault: true,\r\n    label: 'ABBREW.SheetLabels.Actor',\r\n  });\r\n  Items.unregisterSheet('core', ItemSheet);\r\n  Items.registerSheet('abbrew', AbbrewItemSheet, {\r\n    types: [\"item\", \"feature\", \"spell\", \"armour\", \"weapon\", \"wound\"],\r\n    makeDefault: true,\r\n    label: 'ABBREW.SheetLabels.Item',\r\n  });\r\n  Items.registerSheet('abbrew', AbbrewCreatureFormSheet, {\r\n    types: [\"creatureForm\"],\r\n    makeDefault: true,\r\n    label: \"ABBREW.SheetLabels.CreatureForm\"\r\n  });\r\n  Items.registerSheet('abbrew', AbbrewSkillDeckSheet, {\r\n    types: [\"skillDeck\", \"background\"],\r\n    makeDefault: true,\r\n    label: \"ABBREW.SheetLabels.SkillDeck\"\r\n  });\r\n  Items.registerSheet('abbrew', AbbrewAnatomySheet, {\r\n    types: [\"anatomy\"],\r\n    makeDefault: true,\r\n    label: \"ABBREW.SheetLabels.Anatomy\"\r\n  });\r\n  Items.registerSheet('abbrew', AbbrewSkillSheet, {\r\n    types: [\"skill\"],\r\n    makeDefault: true,\r\n    label: \"ABBREW.SheetLabels.Skill\"\r\n  });\r\n\r\n  _configureStatusEffects();\r\n\r\n  // Preload Handlebars templates.\r\n  return preloadHandlebarsTemplates();\r\n});\r\n\r\n/* -------------------------------------------- */\r\n\r\n/**\r\n * Configure system status effects.\r\n */\r\nfunction _configureStatusEffects() {\r\n  const addEffect = (effects, { special, ...data }) => {\r\n    data = foundry.utils.deepClone(data);\r\n    data._id = staticID(`abbrew${data.id}`);\r\n    data.img = data.icon ?? data.img;\r\n    delete data.icon;\r\n    effects.push(data);\r\n    if (special) CONFIG.specialStatusEffects[special] = data.id;\r\n  };\r\n  CONFIG.statusEffects = Object.entries(CONFIG.ABBREW.statusEffects).reduce((arr, [id, data]) => {\r\n    const original = CONFIG.statusEffects.find(s => s.id === id);\r\n    data.name = game.i18n.localize(data.name) ?? data.name;\r\n    data.description = game.i18n.localize(data.description) ?? data.description;\r\n    addEffect(arr, foundry.utils.mergeObject(original ?? {}, { id, ...data }, { inplace: false }));\r\n    return arr;\r\n  }, []);\r\n  // for ( const [id, {label: name, ...data}] of Object.entries(CONFIG.DND5E.conditionTypes) ) {\r\n  //   addEffect(CONFIG.statusEffects, { id, name, ...data });\r\n  // }\r\n  // for ( const [id, data] of Object.entries(CONFIG.DND5E.encumbrance.effects) ) {\r\n  //   addEffect(CONFIG.statusEffects, { id, ...data, hud: false });\r\n  // }\r\n}\r\n\r\n/*--------------------------------------------*/\r\n\r\nfunction addWoundUtilities() {\r\n  const wounds = foundry.utils.deepClone(CONFIG.ABBREW.wounds);\r\n  CONFIG.ABBREW.lingeringWoundTypes = Object.entries(wounds).filter(w => w[1].lingeringWounds.length > 0).map(w => w[0]);\r\n  CONFIG.ABBREW.woundToLingeringWounds = Object.entries(wounds).filter(w => w[1].lingeringWounds.length > 0).reduce((result, wound) => { result[wound[0]] = wound[1].lingeringWounds; return result; }, {});\r\n};\r\n\r\n/* -------------------------------------------- */\r\n/*  Handlebars Helpers                          */\r\n/* -------------------------------------------- */\r\n\r\n// Another useful helper is log {{log obj}} will log to console\r\n\r\n// If you need to add Handlebars helpers, here is a useful example:\r\nHandlebars.registerHelper('toLowerCase', function (str) {\r\n  return str.toLowerCase();\r\n});\r\n\r\nHandlebars.registerHelper('eq', function (arg1, arg2) {\r\n  return (arg1 === arg2);\r\n});\r\n\r\nHandlebars.registerHelper('pos', function (arg1) {\r\n  return (arg1 > 0);\r\n});\r\n\r\nHandlebars.registerHelper('getProperty', function (parent, child) {\r\n  const preparedChild = child.replace(/(?:^\\w|[A-Z]|\\b\\w|\\s+)/g, function (match, index) {\r\n    if (+match === 0) return \"\";\r\n    return index === 0 ? match.toLowerCase() : match.toUpperCase();\r\n  });\r\n  return parent[preparedChild];\r\n});\r\n\r\nHandlebars.registerHelper('empty', function (collection) {\r\n  if (!collection) {\r\n    return false;\r\n  }\r\n\r\n  return collection.length === 0;\r\n});\r\n\r\nHandlebars.registerHelper('json', function (context) {\r\n  return JSON.stringify(context, undefined, 2);\r\n});\r\n\r\nHandlebars.registerHelper('gm', function (opts) {\r\n  if (game.user.isGM) {\r\n    return opts.fn(this);\r\n  } else {\r\n    return opts.inverse(this);\r\n  }\r\n});\r\n\r\nHandlebars.registerHelper('isGM', function () {\r\n  return game.user.isGM;\r\n})\r\n\r\n/* -------------------------------------------- */\r\n/*  Ready Hook                                  */\r\n/* -------------------------------------------- */\r\n\r\nHooks.once('ready', function () {\r\n  // Wait to register hotbar drop hook on ready so that modules could register earlier if they want to\r\n  Hooks.on('hotbarDrop', (bar, data, slot) => { createItemMacro(data, slot); return false; });\r\n});\r\n\r\n/* -------------------------------------------- */\r\n/*  Combat Hooks                                 */\r\n/* -------------------------------------------- */\r\n\r\nHooks.on(\"combatStart\", async (combat, updateData, updateOptions) => {\r\n  const actors = combat.combatants.toObject().map(c => canvas.tokens.get(c.tokenId).actor);\r\n  await handleCombatStart(actors);\r\n});\r\n\r\nHooks.on(\"combatRound\", async (combat, updateData, updateOptions) => {\r\n  game.time.advance(CONFIG.ABBREW.durations.round.value);\r\n})\r\n\r\nHooks.on(\"combatTurn\", async (combat, updateData, updateOptions) => {\r\n})\r\n\r\nHooks.on(\"combatTurnChange\", async (combat, prior, current) => {\r\n  if (canvas.tokens.get(current.tokenId).actor.isOwner) {\r\n    await handleTurnChange(prior, current, canvas.tokens.get(prior.tokenId)?.actor, canvas.tokens.get(current.tokenId).actor);\r\n  }\r\n})\r\n\r\nHooks.on(\"updateToken\", (document, changed, options, userId) => {\r\n  // const combatId = game.combat._id;\r\n  // document.flags.elevationruler.movementHistory.combatMoveData[combatId]lastMoveDistance;\r\n  // use the selectedMovementType to determine?\r\n  // stepping is 1 action, less than or equal to speed is 2 actions, over that is 4, then should show red or no ruler?\r\n  // Once another action has been taken, reset for next movement?\r\n  // console.log(\"Somewhere to hit\");\r\n});\r\n\r\n/* -------------------------------------------- */\r\n/*  Other Hooks                                 */\r\n/* -------------------------------------------- */\r\nHooks.on(\"applyActiveEffect\", applyCustomEffects);\r\n\r\nHooks.on(\"renderChatLog\", (app, html, data) => {\r\n  documents.AbbrewItem.chatListeners(html);\r\n});\r\n\r\nHooks.on(\"updateActor\", async (actor, updates, options, userId) => {\r\n\r\n  if (userId != game.user.id) { return; }\r\n\r\n  if (doesNestedFieldExist(updates, \"system.defense.guard.value\")) {\r\n\r\n    await handleActorGuardConditions(actor);\r\n\r\n  }\r\n\r\n  if (doesNestedFieldExist(updates, \"system.wounds\") || doesNestedFieldExist(updates, \"system.defense.resolve\")) {\r\n\r\n    await handleActorWoundConditions(actor);\r\n\r\n  }\r\n\r\n});\r\n\r\nHooks.on(\"updateItem\", (document, options, userId) => { });\r\n\r\nHooks.on(\"preUpdateItem\", () => { })\r\n\r\nHooks.on(\"deleteActiveEffect\", async (effect, options, userId) => {\r\n  console.log(\"deleted\");\r\n  const actor = effect.parent;\r\n  await actor.handleDeleteActiveEffect(effect);\r\n});\r\n\r\nHooks.on(\"updateActiveEffect\", () => { })\r\n\r\nHooks.on(\"preUpdateActiveEffect\", (effect, update, options, user) => { });\r\n\r\nHooks.on(\"preDeleteActiveEffect\", async (effect, options, userId) => { });\r\n\r\nHooks.on(\"dropActorSheetData\", async (actor, sheet, data) => {\r\n  console.log(data);\r\n  if (data.type === \"Item\") {\r\n    const id = data.uuid.split(\".\").pop();\r\n    const item = game.items.get(id);\r\n    if (item) {\r\n      switch (item.type) {\r\n        case \"wound\":\r\n          await handleActorWoundDrop(actor, item);\r\n          break;\r\n        case \"background\":\r\n          await handleActorBackgroundDrop(actor, item);\r\n          break;\r\n        case \"skillDeck\":\r\n          await handleActorSkillDeckDrop(actor, item);\r\n          break;\r\n        case \"creatureForm\":\r\n          await handleActorCreatureFormDrop(actor, item);\r\n          break;\r\n        case \"anatomy\":\r\n          await handleActorAnatomyDrop(actor, item);\r\n          break;\r\n      }\r\n    }\r\n  }\r\n});\r\n\r\nasync function handleActorWoundDrop(actor, item) {\r\n  const wound = item.system.wound;\r\n  await actor.acceptWound(wound.type, wound.value);\r\n}\r\n\r\nasync function handleActorBackgroundDrop(actor, background) {\r\n  await actor.acceptBackground(background);\r\n  await actor.acceptSkillDeck(background);\r\n  if (background.system.creatureForm.id) {\r\n    const creatureForm = game.items.get(background.system.creatureForm.id);\r\n    await actor.acceptCreatureForm(creatureForm);\r\n  }\r\n}\r\n\r\nasync function handleActorSkillDeckDrop(actor, skillDeck) {\r\n  await actor.acceptSkillDeck(skillDeck)\r\n}\r\n\r\nasync function handleActorCreatureFormDrop(actor, creatureform) {\r\n  await actor.acceptCreatureForm(creatureform);\r\n}\r\n\r\nasync function handleActorAnatomyDrop(actor, anatomy) {\r\n  await actor.acceptAnatomy(anatomy);\r\n}\r\n\r\n/* -------------------------------------------- */\r\n/*  Hotbar Macros                               */\r\n/* -------------------------------------------- */\r\n\r\n/**\r\n * Create a Macro from an Item drop.\r\n * Get an existing item macro if one exists, otherwise create a new one.\r\n * @param {Object} data     The dropped data\r\n * @param {number} slot     The hotbar slot to use\r\n * @returns {Promise}\r\n */\r\nasync function createItemMacro(data, slot) {\r\n  if (data.type === 'Macro') {\r\n    const macro = game.macros.find(m => m._id === foundry.utils.parseUuid(data.uuid).id);\r\n    game.user.assignHotbarMacro(macro, slot);\r\n    return false;\r\n  }\r\n  // First, determine if this is a valid owned item.\r\n  if (data.type !== 'Item') return;\r\n  if (!data.uuid.includes('Actor.') && !data.uuid.includes('Token.')) {\r\n    return ui.notifications.warn(\r\n      'You can only create macro buttons for owned Items'\r\n    );\r\n  }\r\n  // If it is, retrieve it based on the uuid.\r\n  const item = await Item.fromDropData(data);\r\n\r\n  let command = \"\";\r\n  if (item.type === \"skill\") {\r\n    await createSkillMacro(item, slot);\r\n    return false;\r\n\r\n  } else {\r\n    await createRollMacro(data, item, slot);\r\n    return false;\r\n  }\r\n}\r\n\r\nasync function createRollMacro(data, item, slot) {\r\n  const command = `game.abbrew.rollItemMacro(\"${data.uuid}\");`;\r\n\r\n  // Create the macro command using the uuid.\r\n  let macro = game.macros.find(\r\n    (m) => m.name === item.name && m.command === command\r\n  );\r\n  if (!macro) {\r\n    macro = await Macro.create({\r\n      name: item.name,\r\n      type: 'script',\r\n      img: item.img,\r\n      command: command,\r\n      flags: { 'abbrew.itemMacro': true },\r\n    });\r\n  }\r\n  game.user.assignHotbarMacro(macro, slot);\r\n  return false;\r\n}\r\n\r\nasync function createSkillMacro(skill, slot) {\r\n  let command = \"await game.abbrew.useSkillMacro(this);\";\r\n  let macro = game.macros.find(\r\n    (m) => m.name === skill.name && skill.command === command\r\n  );\r\n  if (!macro) {\r\n    const skillId = skill._id;\r\n    macro = await Macro.create({\r\n      name: skill.name,\r\n      type: 'script',\r\n      scope: 'actor',\r\n      img: skill.img,\r\n      command: command,\r\n      flags: { 'abbrew.itemMacro': true, 'abbrew.skillMacro.skillId': skillId },\r\n    });\r\n  }\r\n  game.user.assignHotbarMacro(macro, slot);\r\n}\r\n\r\n/**\r\n * Create a Macro from an Item drop.\r\n * Get an existing item macro if one exists, otherwise create a new one.\r\n * @param {string} itemUuid\r\n */\r\nfunction rollItemMacro(itemUuid) {\r\n  // Reconstruct the drop data so that we can load the item.\r\n  const dropData = {\r\n    type: 'Item',\r\n    uuid: itemUuid,\r\n  };\r\n  // Load the item from the uuid.\r\n  Item.fromDropData(dropData).then((item) => {\r\n    // Determine if the item loaded and if it's an owned item.\r\n    if (!item || !item.parent) {\r\n      const itemName = item?.name ?? itemUuid;\r\n      return ui.notifications.warn(\r\n        `Could not find item ${itemName}. You may need to delete and recreate this macro.`\r\n      );\r\n    }\r\n\r\n    // Trigger the item roll\r\n    item.roll();\r\n  });\r\n}\r\n\r\nasync function useSkillMacro(macroData) {\r\n  const skillId = macroData.flags.abbrew.skillMacro.skillId;\r\n\r\n  const actor = game.user.character ?? getControlledActor();\r\n  if (!actor) {\r\n    ui.warn(`You must select a token.`);\r\n  }\r\n\r\n  const skill = actor.items.find(i => i._id === skillId);\r\n  if (skill?.type !== \"skill\") {\r\n    ui.warn(`${skill.name} is not a skill.`);\r\n    return;\r\n  }\r\n\r\n  await handleSkillActivate(actor, skill);\r\n}\r\n\r\nfunction getControlledActor() {\r\n  const tokens = canvas.tokens.controlled.filter((token) => token.actor);\r\n  if (tokens.length === 0) {\r\n    return null;\r\n  }\r\n  return tokens[0].actor;\r\n}\r\n\r\nfunction applyCustomEffects(actor, change) {\r\n  console.log(\"CUSTOM\");\r\n}"],"names":["s","skill","lingeringWoundImmunities","appliedLingeringWounds","this","t","e","i","n","a","o","r","l","d","c","g","h","p","u","m","y","v","w","b","f","T","O","$","document","key","skillTraining","_a","_b","_c","AbbrewItem","documents.AbbrewItem","documents.AbbrewActor","models.AbbrewCharacter","models.AbbrewNPC","models.AbbrewItem","models.AbbrewFeature","models.AbbrewSpell","models.AbbrewSkill","models.AbbrewAnatomy","models.AbbrewArmour","models.AbbrewWeapon","models.AbbrewWound","models.AbbrewBackground","models.AbbrewSkillDeck","models.AbbrewCreatureForm"],"mappings":"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","x_google_ignoreList":[5]}